/**
 * MultiMarker for Google Maps.
 *
 * @name multimarker.js
 * @fileOverview Group Google Maps Markers together.
 * @version 0.1.0
 * @author Luiz Armesto
 * @copyright (c) 2012 it3s
 */

/**
 * MultiPolyline for Google Maps.
 *
 * @name multipolyline.js
 * @fileOverview Group Google Maps Polylines together.
 * @version 0.1.0
 * @author Luiz Armesto
 * @copyright (c) 2012 it3s
 */

(function(){}).call(this),define("app",function(){}),function(){define("map/core",["jquery","underscore","backbone"],function(e,t,n){var r,i;return r=function(){function r(){this._components={},this._pubQueue=[],this._pubsub={},t.extend(this._pubsub,n.Events)}return r.prototype.loading=0,r.prototype.data={deferred:e.Deferred,when:e.when},r.prototype._getComponent=function(e,t){var n,r;n=(r=this._components[e])!=null?r:{};if(n[t]==null)throw new Error("Could not be found a component '"+e+"' with id '"+t+"'");return n[t]},r.prototype._removeComponent=function(e,t){var n;return(n=this._components[e])!=null?delete n[t]:void 0},r.prototype.load=function(e,t,n){var r,i,s,o,u,a=this;return u=t,s=e.split("::"),r=s[0],i=s[1],o=this.data.deferred(),require([r],function(r){var s,f;s=r[i];try{f=new s(a,t)}catch(l){typeof console!="undefined"&&console!==null&&console.error(l.message),typeof console!="undefined"&&console!==null&&console.warn("Could not initialize component '"+e+"'"),o.resolve();return}return a.data.when(f.init(n)).done(function(){return a._components[e][u].instance=f,typeof console!="undefined"&&console!==null&&console.log("Component '"+e+"' initialized"),a.publish(""+i+":started",u),o.resolve(f)}).fail(function(){return typeof console!="undefined"&&console!==null&&console.warn("Could not initialize component '"+e+"'"),o.resolve(f)})},function(t){var n;return t.requireType==="timeout"?typeof console!="undefined"&&console!==null&&console.warn("Could not load module '"+t.requireModules+"'"):(n=t.requireModules&&t.requireModules[0],require.undef(n),typeof console!="undefined"&&console!==null&&console.error(t.message),typeof console!="undefined"&&console!==null&&console.warn("Could not initialize component '"+e+"'")),o.resolve()}),o.promise()},r.prototype.unload=function(e){},r.prototype.start=function(n,r,i){var s,o,u,a,f,l,c,h,p,d,v,m=this;i==null&&(i={}),t.isString(n)?o=[{component:n,el:r,opts:i}]:t.isArray(n)?o=n:o=[n];if(!t.isArray(o))throw new Error("componentList must be defined as an array");c=[];for(d=0,v=o.length;d<v;d++)l=o[d],s=l.component,r=l.el,i=l.opts,this.loading++,f=r,(p=this._components)[s]==null&&(p[s]={}),u=this._components[s],u[f]!=null&&typeof console!="undefined"&&console!==null&&console.error("Conflict: already exists one component '"+s+"' with id '"+f+"' "),this._components[s][f]={type:s,el:r,opts:i},a=this.data.deferred(),c.push(this.load(s,r,i));return h=this.data.when.apply(e,c),h.done(function(){return m.loading-=arguments.length,m._processPublishQueue()}),h},r.prototype.stop=function(n,r){var i,s,o,u,a,f,l,c,h;a=r,f=t.isArray(a)?a:[a],o=this.data.deferred(),l=f.length,u=0;for(c=0,h=f.length;c<h;c++)i=f[c],s=this._getComponent(n,i),s.instance.destroy().done(function(){e(s.el).children().remove(),this._removeComponent(n,i),u++;if(u===l)return o.resolve()});return o.promise()},r.prototype.publish=function(e){return this._addToPublishQueue.apply(this,arguments),this._processPublishQueue()},r.prototype.subscribe=function(e,t,n){return this._pubsub.on(e,t,n)},r.prototype._addToPublishQueue=function(e){return this._pubQueue.push(arguments)},r.prototype._processPublishQueue=function(){var e;if(this.loading>0)return!1;e=this._pubQueue.shift();if(e!=null)return this._pubsub.trigger.apply(this._pubsub,e),this._processPublishQueue()},r}(),i={Mediator:r},i})}.call(this),function(){var e=Object.prototype.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("map/collections",[],function(){var e,n,r,i,s;return window.komoo==null&&(window.komoo={}),(s=window.komoo).event==null&&(s.event=google.maps.event),r=function(){function e(e){this.options=e!=null?e:{},this.elements=[],this.length=0}return e.prototype.updateLength=function(){return this.length=this.elements.length},e.prototype.clear=function(){return this.elements=[],this.updateLength()},e.prototype.getAt=function(e){return this.elements[e]},e.prototype.push=function(e){return this.elements.push(e),this.updateLength()},e.prototype.pop=function(){var e;return e=this.elements.pop(),this.updateLength(),e},e.prototype.forEach=function(e,t){return this.elements.forEach(e,t)},e.prototype.getArray=function(){return this.elements},e.prototype.slice=function(e,t){return this.elements.slice(e,t)},e}(),e=function(e){function n(e){var t,r=this;e==null&&(e={}),n.__super__.constructor.call(this,e),e.map&&this.setMap(e.map),(t=e.features)!=null&&t.forEach(function(e){return r.push(e)})}return t(n,e),n.prototype.push=function(e){if(e==null)return;return n.__super__.push.call(this,e),e.setMap(this.map)},n.prototype.getBounds=function(){var e,t,n,r=this;return e=this.getAt(0),e&&e.getGeometryType()!=="Empty"&&(t=e.getGeometry(),n=t.getLatLngFromArray(t.getCenter()),this.bounds=new google.maps.LatLngBounds(n,n),this.forEach(function(e){var t;return(t=r.bounds)!=null?t.union(e.getBounds()):void 0})),this.bounds},n.prototype.setMap=function(e,t){var n,r=this;return this.map=e,n=null,this.forEach(function(e){return t!=null&&(n={geometry:t!=null?t.geometry:void 0,point:t!=null?t.icon:void 0,icon:t!=null?t.icon:void 0}),e.getType()==="Community"&&n!=null&&(n.point=!1),e!=null?e.setMap(r.map,n):void 0}),this.handleMapEvents()},n.prototype.show=function(){return this.setMap(this.map,{geometry:!0}),this.setVisible(!0)},n.prototype.hide=function(){return this.setVisible(!1)},n.prototype.getGeoJson=function(e){var t;return e.geometryCollection==null&&(e.geometryCollection=!1),e.geometryCollection?(t={type:"GeometryCollection",geometries:[]},this.forEach(function(e){return t.geometries.push(e.getGeometryGeoJson())})):(t={type:"FeatureCollection",features:[]},this.forEach(function(e){return t.features.push(e.getGeoJson())})),t},n.prototype.removeAllFromMap=function(){return this.forEach(function(e){return e.removeFromMap()})},n.prototype.setVisible=function(e){return this.forEach(function(t){return t.setVisible(e)})},n.prototype.updateFeaturesVisibility=function(){return this.forEach(function(e){return e.seMap(e.getMap())})},n.prototype.handleMapEvents=function(){var e=this;return komoo.event.addListener(this.map,"zoom_changed",function(){})},n}(r),n=function(n){function r(e){e==null&&(e={}),r.__super__.constructor.call(this,e),this.featuresByType={}}return t(r,n),r.prototype.push=function(t){var n,i,s,o,u,a,f,l=this;return r.__super__.push.call(this,t),n=t.getType(),(i=this.featuresByType)[n]==null&&(i[n]={}),(s=this.featuresByType[n])["categories"]==null&&(s.categories={}),(o=this.featuresByType[n]["categories"])["all"]==null&&(o.all=new e({map:this.map})),(u=this.featuresByType[n]["categories"])["uncategorized"]==null&&(u.uncategorized=new e({map:this.map})),(f=t.getCategories())!=null&&f.forEach(function(r){var i,s;return(i=l.featuresByType[n]["categories"])[s=r.name]==null&&(i[s]=new e({map:l.map})),l.featuresByType[n].categories[r.name].push(t)}),(t.getCategories()==null||t.getCategories().length===0)&&this.featuresByType[n].categories.uncategorized.push(t),this.featuresByType[n].categories.all.push(t),(a=this.featuresByType[n])["ids"]==null&&(a.ids={}),this.featuresByType[n].ids[t.getProperty("id")]=t},r.prototype.pop=function(){return r.__super__.pop.call(this)},r.prototype.clear=function(){return this.featuresByType={},r.__super__.clear.call(this)},r.prototype.getByType=function(t,n,r){var i,s=this;return r==null&&(r=!1),this.featuresByType[t]?n?n.length===0?this.featuresByType[t].categories.uncategorized:(i=new e({map:this.map}),n.forEach(function(e){if(s.featuresByType[t].categories[e])return s.featuresByType[t].categories[e].forEach(function(e){if(!r||!e.getCategories()||e.getCategories().length===1)return i.push(e)})}),i):this.featuresByType[t].categories.all:!1},r.prototype.getById=function(e,t){var n;return(n=this.featuresByType[e])!=null?n.ids[t]:void 0},r.prototype.highlightFeature=function(e,t){var n,r;n=typeof e=="string"?this.getById(e,t):e;if(n.isHighlighted())return;return(r=this.highlighted)!=null&&r.setHighlight(!1),n.highlight(),this.highlighted=n},r}(e),i=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n}(e),window.komoo.collections={GenericCollection:r,FeatureCollection:e,FeatureCollectionPlus:n,makeFeatureCollection:function(t){return t==null&&(t={}),new e(t)},makeFeatureCollectionPlus:function(e){return e==null&&(e={}),new n(e)}},window.komoo.collections})}.call(this),function(){define("map/common",[],function(){return{geometries:{types:{EMPTY:"Empty",POINT:"Point",MULTIPOINT:"MultiPoint",POLYGON:"Polygon",POLYLINE:"LineString",LINESTRING:"LineString",MULTIPOLYLINE:"MultiLineString",MULTILINESTRING:"MultiLineString"}}}})}.call(this),MultiMarker=function(e){e=e||{},this.markers_=new google.maps.MVCArray(e.markers||[]),this.positions_=new google.maps.MVCArray(e.positions||[]),this.map_=e.map,this.visible_=e.visible,this.clickable_=e.clickable,this.draggable_=e.draggable,this.icon_=e.icon,this.zIndex=e.zIndex||0},MultiMarker.prototype.getPosition=function(){return this.markers_.getAt(0).getPosition()},MultiMarker.prototype.getPositions=function(){this.positions_.clear();for(var e=0;e<this.markers_.getLength();e++)this.positions_.push(this.markers_.getAt(e).getPosition());return this.positions_},MultiMarker.prototype.setPositions=function(e){if(e.length!=this.markers_.getLength())throw"Invalid length.";this.positions_.clear();for(var t=0;t<this.markers_.getLength();t++)this.markers_.getAt(t).setPosition(e[t]),this.positions_.push(e[t])},MultiMarker.prototype.addMarker=function(e,t){var n=this;this.markers_.push(e),t||this.icon_&&e.setIcon(this.icon_),google.maps.event.addListener(e,"click",function(t){google.maps.event.trigger(n,"click",t,e)}),google.maps.event.addListener(e,"mouseover",function(t){google.maps.event.trigger(n,"mouseover",t,e)}),google.maps.event.addListener(e,"mouseout",function(t){google.maps.event.trigger(n,"mouseout",t,e)}),google.maps.event.addListener(e,"mousemove",function(t){google.maps.event.trigger(n,"mousemove",t,e)})},MultiMarker.prototype.addMarkers=function(e,t){for(var n=0;n<e.length;n++)this.addMarker(e[n],t)},MultiMarker.prototype.getMarkers=function(){return this.markers_},MultiMarker.prototype.setDraggable=function(e){for(var t=0;t<this.markers_.getLength();t++)this.markers_.getAt(t).setDraggable(e);this.draggable_=e},MultiMarker.prototype.getDraggable=function(){return this.draggable_},MultiMarker.prototype.setMap=function(e){for(var t=0;t<this.markers_.getLength();t++)this.markers_.getAt(t).setMap(e);this.map_=e},MultiMarker.prototype.getMap=function(){return this.map_},MultiMarker.prototype.setIcon=function(e){for(var t=0;t<this.markers_.getLength();t++)this.markers_.getAt(t).setIcon(e);this.icon_=e},MultiMarker.prototype.getIcon=function(){return this.icon_},MultiMarker.prototype.setVisible=function(e){for(var t=0;t<this.markers_.getLength();t++)this.markers_.getAt(t).setVisible(e);this.visible_=e},MultiMarker.prototype.getVisible=function(){return this.visible_},define("map/multimarker",function(){}),MultiPolyline=function(e){e=e||{},this.polylines_=new google.maps.MVCArray(e.polylines||[]),this.paths_=new google.maps.MVCArray(e.paths||[]),this.map_=e.map,this.visible_=e.visible,this.clickable_=e.clickable,this.zIndex=e.zIndex||0,this.strokeColor_=e.strokeColor||"black",this.strokOpacity_=e.strokeOpacity||1,this.strokeWeight_=e.strokeWeight||3},MultiPolyline.prototype.getPaths=function(){this.paths_.clear();for(var e=0;e<this.polylines_.getLength();e++)this.paths_.push(this.polylines_.getAt(e).getPath());return this.paths_},MultiPolyline.prototype.setPaths=function(e){if(e.length!=this.polylines_.getLength())throw"Invalid length.";this.paths_.clear();for(var t=0;t<this.polylines_.getLength();t++)this.polylines_.getAt(t).setPath(e[t]),this.paths_.push(e[t])},MultiPolyline.prototype.addPolyline=function(e,t){var n=this;this.polylines_.push(e),t!=1&&e.setOptions({clickable:this.clickable_,zIndex:this.zIndex,strokeColor:this.strokeColor_,strokeOpacity:this.strokOpacity_,strokeWeight:this.strokeWeight_}),google.maps.event.addListener(e,"click",function(t){google.maps.event.trigger(n,"click",t,e)}),google.maps.event.addListener(e,"mouseover",function(t){google.maps.event.trigger(n,"mouseover",t,e)}),google.maps.event.addListener(e,"mouseout",function(t){google.maps.event.trigger(n,"mouseout",t,e)}),google.maps.event.addListener(e,"mousemove",function(t){google.maps.event.trigger(n,"mousemove",t,e)})},MultiPolyline.prototype.addPolylines=function(e,t){for(var n=0;n<e.length;n++)this.addPolyline(e[n],t)},MultiPolyline.prototype.getPolylines=function(){return this.polylines_},MultiPolyline.prototype.setMap=function(e){for(var t=0;t<this.polylines_.getLength();t++)this.polylines_.getAt(t).setMap(e);this.map_=e},MultiPolyline.prototype.getMap=function(){return this.map_},MultiPolyline.prototype.setVisible=function(e){for(var t=0;t<this.polylines_.getLength();t++)this.polylines_.getAt(t).setVisible(e);this.visible_=e},MultiPolyline.prototype.setEditable=function(e){for(var t=0;t<this.polylines_.getLength();t++)this.polylines_.getAt(t).setEditable(e);this.visible_=e},MultiPolyline.prototype.setOptions=function(e){for(var t=0;t<this.polylines_.getLength();t++)this.polylines_.getAt(t).setOptions(e);this.options_=e},MultiPolyline.prototype.getVisible=function(){return this.visible_},define("map/multipolyline",function(){}),function(){var e=Object.prototype.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("map/geometries",["map/common","map/multimarker","map/multipolyline"],function(e){var n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b;return window.komoo==null&&(window.komoo={}),(b=window.komoo).event==null&&(b.event=google.maps.event),n=e.geometries.types.EMPTY,h=e.geometries.types.POINT,a=e.geometries.types.MULTIPOINT,p=e.geometries.types.POLYGON,d=e.geometries.types.LINESTRING,s=e.geometries.types.LINESTRING,f=e.geometries.types.MULTILINESTRING,u=e.geometries.types.MULTILINESTRING,y={BACKGROUND_COLOR:"#000",BACKGROUND_OPACITY:.6,BORDER_COLOR:"#000",BORDER_OPACITY:.6,BORDER_SIZE:1.5,BORDER_SIZE_HOVER:2.5,ZINDEX:1},i=function(){function e(e){this.options=e!=null?e:{},this.setFeature(this.options.feature),this.initOverlay(this.options)}return e.prototype.initOverlay=function(e){throw"Not Implemented"},e.prototype.getCoordinates=function(){throw"Not Implemented"},e.prototype.setCoordinates=function(e){return komoo.event.trigger(this,"coordinates_changed")},e.prototype.setEditable=function(e){throw"Not Implemented"},e.prototype.initEvents=function(e){var t,n=this;e==null&&(e=this.overlay);if(!e)return;return t=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"],t.forEach(function(t){return komoo.event.addListener(e,t,function(e,r){return komoo.event.trigger(n,t,e,r)})})},e.prototype.calculateBounds=function(){var e,t,n,r,i,s,o,u,a,l,c,h,d,v;s=a=l=n=null,i=function(e){return s==null&&(s=a!=null?a:a=e[0]),l==null&&(l=n!=null?n:n=e[1]),s=Math.max(e[0],s),a=Math.min(e[0],a),l=Math.min(e[1],l),n=Math.max(e[1],n),[[a,l],[s,n]]},t=this.getCoordinates(),r=this.getGeometryType(),r!==p&&r!==f&&(t=[t]);for(c=0,d=t.length;c<d;c++){o=t[c];for(h=0,v=o.length;h<v;h++)u=o[h],e=i(u)}return e!=null&&(this.bounds=new google.maps.LatLngBounds(this.getLatLngFromArray(e[0]),this.getLatLngFromArray(e[1]))),this.bounds},e.prototype.getBounds=function(){return this.bounds!=null?this.bounds:this.calculateBounds()},e.prototype.getCenter=function(){var e,t,n;return this.overlay?this.getArrayFromLatLng((typeof (e=this.overlay).getCenter=="function"?e.getCenter():void 0)||((n=this.getBounds())!=null?n.getCenter():void 0)||(typeof (t=this.overlay).getPosition=="function"?t.getPosition():void 0)):[]},e.prototype.getOverlay=function(){return this.overlay},e.prototype.setOverlay=function(e){return this.overlay=e,this.initEvents()},e.prototype.getFeature=function(){return this.feature},e.prototype.setFeature=function(e){this.feature=e},e.prototype.getGeometryType=function(){return this.geometryType},e.prototype.getDefaultZIndex=function(){var e;return((e=this.feature)!=null?e.getDefaultZIndex():void 0)||y.ZINDEX},e.prototype.getLatLngFromArray=function(e){return e!=null?new google.maps.LatLng(e[0],e[1]):null},e.prototype.getArrayFromLatLng=function(e){return e?[e.lat(),e.lng()]:[]},e.prototype.getLatLngArrayFromArray=function(e){var t,n,r,i;i=[];for(n=0,r=e.length;n<r;n++)t=e[n],i.push(this.getLatLngFromArray(t));return i},e.prototype.getArrayFromLatLngArray=function(e){var t,n,r,i;if(e){i=[];for(n=0,r=e.length;n<r;n++)t=e[n],i.push(this.getArrayFromLatLng(t));return i}return[]},e.prototype.getMap=function(){return this.map},e.prototype.setMap=function(e){var t;return this.map=e,(t=this.overlay)!=null?t.setMap(this.map&&this.map.googleMap?this.map.googleMap:this.map):void 0},e.prototype.getVisible=function(){var e;return(e=this.overlay)!=null?e.getVisible():void 0},e.prototype.setVisible=function(e){var t;return(t=this.overlay)!=null?t.setVisible(e):void 0},e.prototype.setOptions=function(e){var t;return this.options=e,(t=this.overlay)!=null?t.setOptions(this.options):void 0},e.prototype.getIcon=function(){var e;return(e=this.overlay)!=null?typeof e.getIcon=="function"?e.getIcon():void 0:void 0},e.prototype.setIcon=function(e){var t;return(t=this.overlay)!=null?typeof t.setIcon=="function"?t.setIcon(e):void 0:void 0},e.prototype.getIconUrl=function(e){var t;return(t=this.feature)!=null?t.getIconUrl(e):void 0},e.prototype.getGeoJson=function(){return{type:this.getGeometryType(),coordinates:this.getCoordinates()}},e}(),r=function(e){function r(){r.__super__.constructor.apply(this,arguments)}return t(r,e),r.prototype.geometryType=n,r.prototype.getOverlayOptions=function(e){return{}},r.prototype.initOverlay=function(e){return this.options=e!=null?e:{},!0},r.prototype.getCoordinates=function(){return[]},r.prototype.setEditable=function(e){return!0},r.prototype.getGeoJson=function(){return null},r}(i),v=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.geometryType=h,n.prototype.getOverlayOptions=function(e){var t,n,r;return e==null&&(e={}),{clickable:(t=e.clickable)!=null?t:!0,zIndex:(n=e.zIndex)!=null?n:this.getDefaultZIndex(),icon:(r=e.icon)!=null?r:this.getIconUrl(e.zoom)}},n.prototype.initOverlay=function(e){return this.setOverlay(new google.maps.Marker(this.getOverlayOptions(e)))},n.prototype.initEvents=function(e){var t,r=this;return e==null&&(e=this.overlay),n.__super__.initEvents.call(this,e),t=["animation_changed","clickable_changed","cursor_changed","drag","dragend","daggable_changed","dragstart","flat_changed","icon_changed","position_changed","shadow_changed","shape_changed","title_changed","visible_changed","zindex_changed"],t.forEach(function(t){return komoo.event.addListener(e,t,function(e,n){return komoo.event.trigger(r,t,e,n)})})},n.prototype.getCoordinates=function(){return this.getArrayFromLatLng(this.overlay.getPosition())},n.prototype.setCoordinates=function(e){return this.bounds=null,this.overlay.setPosition(this.getLatLngFromArray(e)),n.__super__.setCoordinates.call(this,e)},n.prototype.setEditable=function(e){return this.overlay.setDraggable(e)},n.prototype.getPosition=function(){return this.overlay.getPosition()},n.prototype.setPosition=function(e){return this.overlay.setPosition(e instanceof Array?this.getLatLngFromArray(e):e)},n.prototype.addMarker=function(e){return this.setOverlay(e)},n}(i),c=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.geometryType=a,n.prototype.getOverlayOptions=function(e){var t,n,r;return e==null&&(e={}),{clickable:(t=e.clickable)!=null?t:!0,zIndex:(n=e.zIndex)!=null?n:this.getDefaultZIndex(),icon:(r=e.icon)!=null?r:this.getIconUrl(e.zoom)}},n.prototype.initOverlay=function(e){return this.setOverlay(new MultiMarker(this.getOverlayOptions(e)))},n.prototype.getPoints=function(){return this.overlay.getMarkers().getArray()},n.prototype.setPoints=function(e){return this.overlay.addMarkers(e)},n.prototype.guaranteePoints=function(e){var t,n,r,i,s,o;n=this.overlay.getMarkers();if(n.length>=e){s=[];for(t=0,r=n.length-e-1;0<=r?t<=r:t>=r;0<=r?t++:t--)s.push(n.pop());return s}o=[];for(t=0,i=e-n.length-1;0<=i?t<=i:t>=i;0<=i?t++:t--)o.push(this.overlay.addMarker(new google.maps.Marker(this.options)));return o},n.prototype.getCoordinates=function(){var e,t,n,r,i;r=this.getPoints(),i=[];for(t=0,n=r.length;t<n;t++)e=r[t],i.push(this.getArrayFromLatLng(e.getPosition()));return i},n.prototype.setCoordinates=function(e){var t,r,i,s;e[0]instanceof Array||(e=[e]),this.guaranteePoints(e.length),this.bounds=null,s=this.getPoints();for(t=0,i=s.length;t<i;t++)r=s[t],r.setPosition(this.getLatLngFromArray(e[t]));return n.__super__.setCoordinates.call(this,e)},n.prototype.setEditable=function(e){return this.overlay.setDraggable(e)},n.prototype.getPositions=function(){var e,t,n,r,i;r=this.getPoints(),i=[];for(t=0,n=r.length;t<n;t++)e=r[t],i.push(e.getPosition());return i},n.prototype.setPositions=function(e){return this.overlay.setPositions(e)},n.prototype.getMarkers=function(){return this.overlay.getMarkers()},n.prototype.addMarkers=function(e){return this.overlay.addMarkers(e)},n.prototype.addMarker=function(e){return this.overlay.addMarker(e)},n}(i),g=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.geometryType=h,n.prototype.getGeoJson=function(){return{type:a,coordinates:this.getCoordinates()}},n}(c),o=function(e){function n(e){n.__super__.constructor.call(this,e),this.handleEvents()}return t(n,e),n.prototype.geometryType=s,n.prototype.getOverlayOptions=function(e){var t,n,r,i,s;return e==null&&(e={}),{clickable:(t=e.clickable)!=null?t:!0,zIndex:(n=e.zIndex)!=null?n:this.getDefaultZIndex(),strokeColor:(r=e.strokeColor)!=null?r:this.getBorderColor(),strokOpacity:(i=e.strokeOpacity)!=null?i:this.getBorderOpacity(),strokeWeight:(s=e.strokeWeight)!=null?s:this.getBorderSize()}},n.prototype.initOverlay=function(e){return this.setOverlay(new google.maps.Polyline(this.getOverlayOptions(e)))},n.prototype.handleEvents=function(){var e=this;return komoo.event.addListener(this,"mousemove",function(t){return e.setOptions({strokeWeight:e.getBorderSizeHover()})}),komoo.event.addListener(this,"mouseout",function(t){return e.setOptions({strokeWeight:e.getBorderSize()})})},n.prototype.getCoordinates=function(){var e,t,n,r,i;r=this.overlay.getPath().getArray(),i=[];for(t=0,n=r.length;t<n;t++)e=r[t],i.push(this.getArrayFromLatLng(e));return i},n.prototype.setCoordinates=function(e){var t;return this.overlay.setPath(function(){var n,r,i;i=[];for(n=0,r=e.length;n<r;n++)t=e[n],i.push(this.getLatLngFromArray(t));return i}.call(this))},n.prototype.setEditable=function(e){return this.overlay.setEditable(e)},n.prototype.getBorderColor=function(){var e;return((e=this.feature)!=null?e.getBorderColor():void 0)||y.BORDER_COLOR},n.prototype.getBorderOpacity=function(){var e;return((e=this.feature)!=null?e.getBorderOpacity():void 0)||y.BORDER_OPACITY},n.prototype.getBorderSize=function(){var e;return((e=this.feature)!=null?e.getBorderSize():void 0)||y.BORDER_SIZE},n.prototype.getBorderSizeHover=function(){var e;return((e=this.feature)!=null?e.getBorderSizeHover():void 0)||y.BORDER_SIZE_HOVER},n.prototype.getPath=function(){return this.overlay.getPath()},n.prototype.setPath=function(e){return this.overlay.setPath(e)},n}(i),l=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.geometryType=f,n.prototype.initOverlay=function(e){return this.setOverlay(new MultiPolyline(this.getOverlayOptions(e)))},n.prototype.guaranteeLines=function(e){var t,n,r,i,s,o;n=this.overlay.getPolylines();if(n.length>=e){s=[];for(t=0,r=n.length-e-1;0<=r?t<=r:t>=r;0<=r?t++:t--)s.push(n.pop());return s}o=[];for(t=0,i=e-n.length-1;0<=i?t<=i:t>=i;0<=i?t++:t--)o.push(this.overlay.addPolyline(new google.maps.Polyline(this.options)));return o},n.prototype.getCoordinates=function(){var e,t,n,r,i;r=this.overlay.getPolylines().getArray(),i=[];for(t=0,n=r.length;t<n;t++)e=r[t],i.push(this.getArrayFromLatLngArray(e.getPath().getArray()));return i},n.prototype.setCoordinates=function(e){var t,n,r,i,s;e[0][0]instanceof Array||(e=[e]),this.guaranteeLines(e.length),this.bounds=null,i=this.getLines(),s=[];for(t=0,r=i.length;t<r;t++)n=i[t],s.push(n.setPath(this.getLatLngArrayFromArray(e[t])));return s},n.prototype.getBorderSize=function(){return n.__super__.getBorderSize.call(this)+1},n.prototype.getBorderSizeHover=function(){return n.__super__.getBorderSizeHover.call(this)+1},n.prototype.getPath=function(){return this.getPaths().getAt(0)},n.prototype.getPaths=function(){return this.overlay.getPaths()},n.prototype.setPaths=function(e){return this.overlay.setPaths(e)},n.prototype.getLines=function(){return this.overlay.getPolylines().getArray()},n.prototype.setLines=function(e){return this.overlay.addPolylines(e)},n.prototype.addPolyline=function(e,t){return this.overlay.addPolyline(e,t)},n.prototype.getPolylines=function(){return this.overlay.getPolylines()},n}(o),m=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.geometryType=p,n.prototype.getOverlayOptions=function(e){var t,n,r,i,s,o,u;return e==null&&(e={}),{clickable:(t=e.clickable)!=null?t:!0,zIndex:(n=e.zIndex)!=null?n:this.getDefaultZIndex(),fillColor:(r=e.fillColor)!=null?r:this.getBackgroundColor(),fillOpacity:(i=e.fillOpacity)!=null?i:this.getBackgroundOpacity(),strokeColor:(s=e.strokeColor)!=null?s:this.getBorderColor(),strokeOpacity:(o=e.strokeOpacity)!=null?o:this.getBorderOpacity(),strokeWeight:(u=e.strokeWeight)!=null?u:this.getBorderSize()}},n.prototype.initOverlay=function(e){return this.setOverlay(new google.maps.Polygon(this.getOverlayOptions(e)))},n.prototype.getBackgroundColor=function(){var e;return((e=this.feature)!=null?e.getBackgroundColor():void 0)||y.BACKGROUND_COLOR},n.prototype.getBackgroundOpacity=function(){var e;return((e=this.feature)!=null?e.getBackgroundOpacity():void 0)||y.BACKGROUND_OPACITY},n.prototype.getCoordinates=function(){var e,t,n,r,i,s;e=[],s=this.overlay.getPaths().getArray();for(r=0,i=s.length;r<i;r++)t=s[r],n=this.getArrayFromLatLngArray(t.getArray()),n.length&&n.push(n[0]),n.length>0&&e.push(n);return e},n.prototype.setCoordinates=function(e){var t,n,r,i,s;n=[],this.bounds=null;for(i=0,s=e.length;i<s;i++)r=e[i],t=this.getLatLngArrayFromArray(r),t.pop(),n.push(t);return this.setPaths(n)},n.prototype.getPath=function(){return this.getPaths().getAt(0)},n.prototype.getPaths=function(){return this.overlay.getPaths()},n.prototype.setPaths=function(e){return this.overlay.setPaths(e)},n}(o),window.komoo.geometries={types:{EMPTY:n,POINT:h,MULTIPOINT:a,POLYGON:p,POLYLINE:d,LINESTRING:s,MULTIPOLYLINE:f,MULTILINESTRING:u},MultiMarker:MultiMarker,Geometry:i,Empty:r,Point:g,MultiPoint:c,LineString:o,MultiLineString:l,Polygon:m,defaults:y,makeGeometry:function(e,t){var n,i,s,o;s={feature:t};if(e.geometry==null)return new r(s);o=e.geometry.type,n=e.geometry.coordinates;if(o==="Point")i=new g(s);else if(o==="MultiPoint"||o==="marker")i=new c(s);else if(o==="LineString"||o==="polyline")n&&(n=[n]),i=new l(s);else if(o==="MultiLineString")i=new l(s);else if(o==="Polygon"||o==="polygon")i=new m(s);return n&&i!=null&&i.setCoordinates(n),i}},window.komoo.geometries})}.call(this),function(){define("map/features",["map/geometries"],function(e){var t,n;return window.komoo==null&&(window.komoo={}),(n=window.komoo).event==null&&(n.event=google.maps.event),t=function(){function t(t){var n;this.options=t!=null?t:{},n=this.options.geometry,this.setFeatureType(this.options.featureType),this.options.geojson&&(this.options.geojson.properties&&this.setProperties(this.options.geojson.properties),n==null&&(n=e.makeGeometry(this.options.geojson,this))),n!=null&&(this.setGeometry(n),this.createMarker())}return t.prototype.displayTooltip=!0,t.prototype.displayInfoWindow=!0,t.prototype.createMarker=function(){var t;return t=new e.Point({visible:!0,clickable:!0}),t.setCoordinates(this.getCenter()),this.setMarker(t)},t.prototype.initEvents=function(e){var t,n;return e==null&&(e=this.geometry),n=this,t=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick","drag","dragend","draggable_changed","dragstart","coordinates_changed"],t.forEach(function(t){return komoo.event.addListener(e,t,function(e,r){return komoo.event.trigger(n,t,e,r)})})},t.prototype.getGeometry=function(){return this.geometry},t.prototype.setGeometry=function(e){return this.geometry=e,this.geometry.feature=this,this.initEvents()},t.prototype.getGeometryType=function(){return this.geometry.getGeometryType()},t.prototype.getFeatureType=function(){return this.featureType},t.prototype.setFeatureType=function(e){this.featureType=e!=null?e:{minZoomPoint:0,maxZoomPoint:10,minZoomIcon:10,maxZoomIcon:100,minZoomGeometry:0,maxZoomGeometry:100}},t.prototype.getMarker=function(){return this.marker},t.prototype.setMarker=function(e){return this.marker=e,this.marker.getOverlay().feature=this,this.initEvents(this.marker),this.marker},t.prototype.handleGeometryEvents=function(){var e=this;return komoo.event.addListener(this.geometry,"coordinates_changed",function(t){return e.updateIcon(),komoo.event.trigger(e,"coordinates_changed",t)})},t.prototype.getUrl=function(){var e;return this.properties.type==="OrganizationBranch"?e="view_organization":e="view_"+this.properties.type.toLowerCase(),dutils.urls.resolve(e,{id:this.properties.id}).replace("//","/")},t.prototype.isHighlighted=function(){return this.highlighted},t.prototype.highlight=function(){return this.setHighlight(!0)},t.prototype.setHighlight=function(e,t){t==null&&(t=!1);if(this.highlighted===e)return;this.highlighted=e,this.updateIcon();if(!t)return komoo.event.trigger(this,"highlight_changed",this.highlighted)},t.prototype.isNew=function(){return!this.getProperty("id")},t.prototype.getIconUrl=function(e){var t,n,r;return this.getProperty("image")?this.getProperty("image"):(e==null&&(e=this.map?this.map.getZoom():10),r=e>=this.featureType.minZoomIcon?"near":"far",n=this.isHighlighted()?"highlighted/":"",this.properties.categories&&this.properties.categories[0]&&this.properties.categories[0].name&&e>=this.featureType.minZoomIcon?t=this.properties.categories[0].name.toLowerCase()+(this.properties.categories.length>1?"-plus":""):t=this.properties.type.toLowerCase(),("/static/img/"+r+"/"+n+t+".png").replace(" ","-"))},t.prototype.updateIcon=function(e){return this.setIcon(this.getIconUrl(e))},t.prototype.getCategoriesIcons=function(){var e,t,n,r,i;r=this.properties.categories,i=[];for(t=0,n=r.length;t<n;t++)e=r[t],i.push("/static/need_categories/"+category.name.toLowerCase()+".png");return i},t.prototype.getProperties=function(){return this.properties},t.prototype.setProperties=function(e){this.properties=e},t.prototype.getProperty=function(e){return this.properties[e]},t.prototype.setProperty=function(e,t){return this.properties[e]=t},t.prototype.getType=function(){return this.getProperty("type")},t.prototype.getCategories=function(){var e;return(e=this.getProperty("categories"))!=null?e:[]},t.prototype.getGeometryGeoJson=function(){return this.geometry.getGeoJson()},t.prototype.getGeometryCollectionGeoJson=function(){return{type:"GeometryCollection",geometries:[this.getGeometryGeoJson()]}},t.prototype.getGeoJsonGeometry=function(){return this.getGeometryGeoJson()},t.prototype.getGeoJson=function(){return{type:"Feature",geometry:this.getGeometryGeoJson(),properties:this.getProperties()}},t.prototype.getGeoJsonFeature=function(){return this.getGeoJson()},t.prototype.setEditable=function(e){return this.editable=e,this.geometry.setEditable(this.editable)},t.prototype.showGeometry=function(){return this.geometry.setMap(this.map)},t.prototype.hideGeometry=function(){return this.geometry.setMap(null)},t.prototype.showMarker=function(){var e;return(e=this.marker)!=null?e.setMap(this.map):void 0},t.prototype.hideMarker=function(){var e;return(e=this.marker)!=null?e.setMap(this.map):void 0},t.prototype.getMap=function(){return this.map},t.prototype.setMap=function(e,t){var n,r;t==null&&(t={geometry:!1,point:!1,icon:!1}),this.oldMap=this.map,this.map=e;if(this.properties.alwaysVisible===!0||this.editable)t={geometry:!0,point:!1,icon:!1};n=this.map!=null?this.map.getZoom():0,(r=this.marker)!=null&&r.setMap(t.point||t.icon||this.featureType.minZoomPoint<=n&&n<=this.featureType.maxZoomPoint||this.featureType.minZoomIcon<=n&&n<=this.featureType.maxZoomIcon?this.map:null),this.geometry.setMap(t.geometry||n<=this.featureType.maxZoomGeometry&&n>=this.featureType.minZoomGeometry?this.map:null),this.updateIcon();if(this.oldMap===void 0)return this.handleMapEvents()},t.prototype.handleMapEvents=function(){var e=this;return this.map.subscribe("feature_highlight_changed",function(t,n){if(n===e)return;if(e.isHighlighted())return e.setHighlight(!1,!0)})},t.prototype.getBounds=function(){return this.geometry.getBounds()},t.prototype.removeFromMap=function(){var e;return(e=this.marker)!=null&&e.setMap(null),this.setMap(null)},t.prototype.setVisible=function(e){var t;return this.visible=e,(t=this.marker)!=null&&t.setVisible(this.visible),this.geometry.setVisible(this.visible)},t.prototype.getCenter=function(){return this.geometry.getCenter()},t.prototype.setOptions=function(e){return this.geometry.setOptions(e)},t.prototype.getIcon=function(){return this.geometry.getIcon()},t.prototype.setIcon=function(e){var t;return(t=this.marker)!=null&&t.setIcon(e),this.geometry.setIcon(e)},t.prototype.getBorderSize=function(){return this.featureType.border_size},t.prototype.getBorderSizeHover=function(){return this.featureType.borderSizeHover},t.prototype.getBorderColor=function(){return this.featureType.borderColor},t.prototype.getBorderOpacity=function(){return this.featureType.borderOpacity},t.prototype.getBackgroundColor=function(){return this.featureType.backgroundColor},t.prototype.getBackgroundOpacity=function(){return this.featureType.backgroundOpacity},t.prototype.getDefaultZIndex=function(){return this.featureType.zIndex},t}(),window.komoo.features={Feature:t,makeFeature:function(e,t){var n;return new komoo.features.Feature({geojson:e,featureType:t!=null?t[e!=null?(n=e.properties)!=null?n.type:void 0:void 0]:void 0})}},window.komoo.features})}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=Object.prototype.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},r=Array.prototype.indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("map/maps",["underscore","map/core","map/collections","map/features","map/geometries"],function(t,i,s,o,u){var a,f,l,c,h,p,d,v;return window.komoo==null&&(window.komoo={}),(v=window.komoo).event==null&&(v.event=google.maps.event),c=function(i){function a(t){var n;this.options=t!=null?t:{},this.addFeature=e(this.addFeature,this),a.__super__.constructor.call(this),this.element=(n=this.options.element)!=null?n:document.getElementById(this.options.elementId),this.features=s.makeFeatureCollectionPlus({map:this}),this.components={},this.addComponent("map/controls::Location"),this.initGoogleMap(this.options.googleMapOptions),this.initFeatureTypes(),this.handleEvents()}return n(a,i),a.prototype.featureTypesUrl="/map_info/feature_types/",a.prototype.googleMapDefaultOptions={zoom:12,center:new google.maps.LatLng(-23.55,-46.65),disableDefaultUI:!1,streetViewControl:!0,scaleControl:!0,panControlOptions:{position:google.maps.ControlPosition.RIGHT_TOP},zoomControlOptions:{position:google.maps.ControlPosition.RIGHT_TOP},scaleControlOptions:{position:google.maps.ControlPosition.RIGHT_BOTTOM,style:google.maps.ScaleControlStyle.DEFAULT},mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.ROADMAP,google.maps.MapTypeId.HYBRID]},mapTypeId:google.maps.MapTypeId.HYBRID},a.prototype.addControl=function(e,t){return this.googleMap.controls[e].push(t)},a.prototype.loadGeoJsonFromOptons=function(){var e,t;if(this.options.geojson)return t=this.loadGeoJSON(this.options.geojson,this.options.zoom==null),e=t.getBounds(),e!=null&&this.fitBounds(e),t!=null&&t.setMap(this,{geometry:!0,icon:!0}),this.publish("set_zoom",this.options.zoom)},a.prototype.initGoogleMap=function(e){return e==null&&(e=this.googleMapDefaultOptions),this.googleMap=new google.maps.Map(this.element,e),this.handleGoogleMapEvents(),$(this.element).trigger("initialized",this)},a.prototype.handleGoogleMapEvents=function(){var e,t=this;return e=["click","idle"],e.forEach(function(e){return komoo.event.addListener(t.googleMap,e,function(n){return t.publish(e,n)})})},a.prototype.initFeatureTypes=function(){var e,t=this;return this.featureTypes==null&&(this.featureTypes={}),this.options.featureTypes!=null?((e=this.options.featureTypes)!=null&&e.forEach(function(e){return t.featureTypes[e.type]=e}),this.loadGeoJsonFromOptons()):$.ajax({url:this.featureTypesUrl,dataType:"json",success:function(e){return e.forEach(function(e){return t.featureTypes[e.type]=e}),t.loadGeoJsonFromOptons()}})},a.prototype.handleEvents=function(){var e=this;return this.subscribe("features_loaded",function(t){return komoo.event.trigger(e,"features_loaded",t)}),this.subscribe("close_clicked",function(){return komoo.event.trigger(e,"close_click")}),this.subscribe("drawing_finished",function(t,n){komoo.event.trigger(e,"drawing_finished",t,n);if(n===!1)return e.revertFeature(t);if(t.getProperty("id")==null)return e.addFeature(t)}),this.subscribe("set_location",function(t){var n;return t=t.split(","),n=new google.maps.LatLng(t[0],t[1]),e.googleMap.setCenter(n)}),this.subscribe("set_zoom",function(t){return e.setZoom(t)})},a.prototype.addComponent=function(e,n,r){var i=this;return n==null&&(n="generic"),r==null&&(r={}),t.isString(e)?e=this.start(e,"",r):e=this.start(e),this.data.when(e).done(function(){var e,t,r,s,o;o=[];for(r=0,s=arguments.length;r<s;r++)e=arguments[r],e.setMap(i),(t=i.components)[n]==null&&(t[n]=[]),i.components[n].push(e),o.push(typeof e.enable=="function"?e.enable():void 0);return o})},a.prototype.enableComponents=function(e){var t,n=this;return(t=this.components[e])!=null?t.forEach(function(e){return typeof e.enable=="function"?e.enable():void 0}):void 0},a.prototype.disableComponents=function(e){var t,n=this;return(t=this.components[e])!=null?t.forEach(function(e){return typeof e.disable=="function"?e.disable():void 0}):void 0},a.prototype.getComponentsStatus=function(e){var t,n,i=this;return t=[],(n=this.components[e])!=null&&n.forEach(function(e){if(e.enabled===!0)return t.push("enabled")}),r.call(t,"enabled")>=0?"enabled":"disabled"},a.prototype.clear=function(){return this.features.removeAllFromMap(),this.features.clear()},a.prototype.refresh=function(){return google.maps.event.trigger(this.googleMap,"resize")},a.prototype.saveLocation=function(e,t){return e==null&&(e=this.googleMap.getCenter()),t==null&&(t=this.getZoom()),this.publish("save_location",e,t)},a.prototype.goToSavedLocation=function(){return this.publish("goto_saved_location"),!0},a.prototype.goToUserLocation=function(){return this.publish("goto_user_location")},a.prototype.handleFeatureEvents=function(e){var t,n=this;return t=["mouseover","mouseout","mousemove","click","dblclick","rightclick","highlight_changed"],t.forEach(function(t){return komoo.event.addListener(e,t,function(r){return n.publish("feature_"+t,r,e)})})},a.prototype.goTo=function(e,t){return t==null&&(t=!0),this.publish("goto",e,t)},a.prototype.panTo=function(e,t){return t==null&&(t=!1),this.goTo(e,t)},a.prototype.makeFeature=function(e,t){var n;return t==null&&(t=!0),n=o.makeFeature(e,this.featureTypes),t&&this.addFeature(n),this.publish("feature_created",n),n},a.prototype.addFeature=function(e){return this.handleFeatureEvents(e),this.features.push(e)},a.prototype.revertFeature=function(e){if(e.getProperty("id")==null)return e.setMap(null)},a.prototype.getFeatures=function(){return this.features},a.prototype.getFeaturesByType=function(e,t,n){return this.features.getByType(e,t,n)},a.prototype.showFeaturesByType=function(e,t,n){var r;return(r=this.getFeaturesByType(e,t,n))!=null?r.show():void 0},a.prototype.hideFeaturesByType=function(e,t,n){var r;return(r=this.getFeaturesByType(e,t,n))!=null?r.hide():void 0},a.prototype.showFeatures=function(e){return e==null&&(e=this.features),e.show()},a.prototype.hideFeatures=function(e){return e==null&&(e=this.features),e.hide()},a.prototype.centerFeature=function(e,t){var n;return n=e instanceof o.Feature?e:this.features.getById(e,t),this.panTo(n!=null?n.getCenter():void 0,!1)},a.prototype.loadGeoJson=function(e,t,n){var r,i,o,u=this;return t==null&&(t=!1),n==null&&(n=!0),r=s.makeFeatureCollection({map:this}),(e!=null?e.type:void 0)==null||!e.type==="FeatureCollection"?r:((i=e.features)!=null&&i.forEach(function(e){var t;return t=u.features.getById(e.properties.type,e.properties.id),t==null&&(t=u.makeFeature(e,n)),r.push(t)}),t&&((o=r.getAt(0))!=null?o.getBounds():void 0)&&this.googleMap.fitBounds(r.getAt(0).getBounds()),this.publish("features_loaded",r),r)},a.prototype.loadGeoJSON=function(e,t,n){return this.loadGeoJson(e,t,n)},a.prototype.getGeoJson=function(e){var t;return e==null&&(e={}),e.newOnly==null&&(e.newOnly=!1),e.currentOnly==null&&(e.currentOnly=!1),e.geometryCollection==null&&(e.geometryCollection=!1),t=e.newOnly?this.newFeatures:e.currentOnly?s.makeFeatureCollection({map:this.map,features:[this.currentFeature]}):this.features,t.getGeoJson({geometryCollection:e.geometryCollection})},a.prototype.getGeoJSON=function(e){return this.getGeoJson(e)},a.prototype.drawNewFeature=function(e,t){var n;return n=this.makeFeature({type:"Feature",geometry:{type:e},properties:{name:"New "+t,type:t}}),this.publish("draw_feature",e,n)},a.prototype.editFeature=function(e,t){return e==null&&(e=this.features.getAt(0)),t!=null&&e.getGeometryType()===u.types.EMPTY?(e.setGeometry(u.makeGeometry({geometry:{type:t}})),this.publish("draw_feature",t,e)):this.publish("edit_feature",e)},a.prototype.setMode=function(e){return this.mode=e,this.publish("mode_changed",this.mode)},a.prototype.selectCenter=function(e,t){return this.selectPerimeter(e,t)},a.prototype.selectPerimeter=function(e,t){return this.publish("select_perimeter",e,t)},a.prototype.highlightFeature=function(){return this.centerFeature.apply(this,arguments),this.features.highlightFeature.apply(this.features,arguments)},a.prototype.getBounds=function(){return this.googleMap.getBounds()},a.prototype.setZoom=function(e){if(e!=null)return this.googleMap.setZoom(e)},a.prototype.getZoom=function(){return this.googleMap.getZoom()},a.prototype.fitBounds=function(e){return e==null&&(e=this.features.getBounds()),this.googleMap.fitBounds(e)},a}(i.Mediator),d=function(e){function t(e){t.__super__.constructor.call(this,e),this.addComponent("map/maptypes::CleanMapType","mapType"),this.addComponent("map/controls::DrawingManager","drawing")}return n(t,e),t}(c),l=function(e){function t(e){t.__super__.constructor.call(this,e),this.addComponent("map/maptypes::CleanMapType"),this.addComponent("map/controls::SaveLocation"),this.addComponent("map/controls::StreetView"),this.addComponent("map/controls::DrawingManager"),this.addComponent("map/controls::DrawingControl"),this.addComponent("map/controls::GeometrySelector"),this.addComponent("map/controls::SupporterBox"),this.addComponent("map/controls::PerimeterSelector")}return n(t,e),t}(c),h=function(e){function t(){t.__super__.constructor.apply(this,arguments)}return n(t,e),t.prototype.googleMapDefaultOptions={zoom:12,center:new google.maps.LatLng(-23.55,-46.65),disableDefaultUI:!0,streetViewControl:!1,scaleControl:!0,scaleControlOptions:{position:google.maps.ControlPosition.RIGHT_BOTTOM,style:google.maps.ScaleControlStyle.DEFAULT},mapTypeId:google.maps.MapTypeId.HYBRID},t}(c),p=function(e){function t(e){t.__super__.constructor.call(this,e),this.addComponent("map/maptypes::CleanMapType","mapType"),this.addComponent("map/controls::AutosaveLocation"),this.addComponent("map/controls::StreetView"),this.addComponent("map/controls::Tooltip","tooltip"),this.addComponent("map/controls::InfoWindow","infoWindow"),this.addComponent("map/controls::SupporterBox"),this.addComponent("map/controls::LicenseBox")}return n(t,e),t.prototype.loadGeoJson=function(e,n,r){var i,s=this;return n==null&&(n=!1),r==null&&(r=!0),i=t.__super__.loadGeoJson.call(this,e,n,r),i.forEach(function(e){return e.setMap(s,{geometry:!0})}),i},t}(c),f=function(e){function t(e){t.__super__.constructor.call(this,e),this.addComponent("map/providers::FeatureProvider","provider"),this.addComponent("map/controls::FeatureClusterer","clusterer",{featureType:"Community",map:this})}return n(t,e),t}(p),a=function(e){function t(e){t.__super__.constructor.call(this,e),this.addComponent("map/controls::DrawingManager"),this.addComponent("map/controls::DrawingControl"),this.addComponent("map/controls::GeometrySelector"),this.addComponent("map/controls::PerimeterSelector"),this.goToSavedLocation()||this.goToUserLocation()}return n(t,e),t}(f),window.komoo.maps={Map:c,Preview:h,AjaxMap:f,makeMap:function(e){var t,n;e==null&&(e={}),t=(n=e.type)!=null?n:"map";if(t==="main")return new a(e);if(t==="editor")return new l(e);if(t==="view")return new f(e);if(t==="static")return new p(e);if(t==="preview"||t==="tooltip")return new h(e);if(t==="userEditor")return new d(e)}},window.komoo.maps})}.call(this)