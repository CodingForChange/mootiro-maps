/*! jQuery v1.9.0 | (c) 2005, 2012 jQuery Foundation, Inc. | jquery.org/license */

// (c) 2010-2012 Jeremy Ashkenas, DocumentCloud Inc.
// Backbone may be freely distributed under the MIT license.
// For all details and documentation:
// http://backbonejs.org

/**
 * @license RequireJS text 2.0.3 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

/*! backbone.paginator - v0.5.1-dev - 1/17/2013
* http://github.com/addyosmani/backbone.paginator
* Copyright (c) 2013 Addy Osmani; Licensed MIT */

/** @license
 * RequireJS plugin for async dependency load like JSONP and Google Maps
 * Author: Miller Medeiros
 * Version: 0.1.1 (2011/11/17)
 * Released under the MIT license
 */

/**
 * Basic parser for URL properties
 * @author Miller Medeiros
 * @version 0.1.0 (2011/12/06)
 * MIT license
 */

/** @license
 * RequireJS plugin for loading Google Ajax API modules thru `google.load`
 * Author: Miller Medeiros
 * Version: 0.2.0 (2011/12/06)
 * Released under the MIT license
 */

/**
 * MultiMarker for Google Maps.
 *
 * @name multimarker.js
 * @fileOverview Group Google Maps Markers together.
 * @version 0.1.0
 * @author Luiz Armesto
 * @copyright (c) 2012 it3s
 */

/**
 * MultiPolyline for Google Maps.
 *
 * @name multipolyline.js
 * @fileOverview Group Google Maps Polylines together.
 * @version 0.1.0
 * @author Luiz Armesto
 * @copyright (c) 2012 it3s
 */

(function(){define("common",["require"],function(e){return null})}).call(this),function(){var e;e={send:{"pt-br":"enviar"},Login:{"pt-br":"Entrar"},Logout:{"pt-br":"Sair"},Help:{"pt-br":"Ajuda"},Email:{"pt-br":"E-mail"},Password:{"pt-br":"Senha"},Name:{"pt-br":"Nome"},"Password Confirmation":{"pt-br":"Confirmação da Senha"},"Log In with Google":{"pt-br":"Entre com o Google"},"Log In with Facebook":{"pt-br":"Entre com o Facebook"},Register:{"pt-br":"Registrar"},Verification:{"pt-br":"Verificação"},"Your email was successfully verified.":{"pt-br":"Seu email foi verificado com sucesso."},"Please login.":{"pt-br":"Por favor, faça login ao lado."},'I\'ve read and accept the <a href="http://mootiro.org/terms">License Terms.</a>':{"pt-br":'Eu li e aceito os <a href="http://mootiro.org/terms">Termos de Uso</a>.'},"Already has an account? <strong>Sign In</strong>":{"pt-br":"Já possui uma conta? <strong>Entre</strong>"},"Don't have an account? <strong>Sign Up</strong>":{"pt-br":"Não possui uma conta? <strong>Registre-se</strong>"},or:{"pt-br":"ou"},"Your account was created!":{"pt-br":"Sua conta foi criada!"},"But before using, you have to confirm your email":{"pt-br":"Mas antes de começar a usar, você precisa confirmar seu e-mail"},"Please go check your mail box":{"pt-br":"Por favor, vá checar sua caixa postal"},Search:{"pt-br":"Procurar"},"See results":{"pt-br":"Ver resultados"},"More about":{"pt-br":"Saiba mais"},"About MootiroMaps":{"pt-br":"Sobre o MootiroMaps"},"About Us":{"pt-br":"Quem somos"},"Get involved":{"pt-br":"Se envolva"},Supporters:{"pt-br":"Apoio institucional"},"See on map":{"pt-br":"Ver no mapa"},Description:{"pt-br":"Descrição"},"About me":{"pt-br":"Sobre mim"},"Recent contributions":{"pt-br":"Contribuições recentes"},"User has not wrote about oneself":{"pt-br":"Usuário ainda não escreveu sobre si"},"previous %n":{"pt-br":"%n anteriores"},"next %n":{"pt-br":"próximos %n"},page:{"pt-br":"página"},of:{"pt-br":"de"},Contact:{"pt-br":"Contato"},Address:{"pt-br":"Endereço"},Phone:{"pt-br":"Telefone"},Email:{"pt-br":"E-mail"},Website:{"pt-br":"Website"},Skype:{"pt-br":"Skype"},Facebook:{"pt-br":"Facebook"},"Google Plus":{"pt-br":"Google Plus"},Twitter:{"pt-br":"Twitter"},"+ Add another one":{"pt-br":"+ Adicionar outro"},Remove:{"pt-br":"Remover"},Save:{"pt-br":"Salvar"},Cancel:{"pt-br":"Cancelar"},Go:{"pt-br":"Ir"},Clean:{"pt-br":"Limpo"},Coordinate:{"pt-br":"Coordenada"},Latitude:{"pt-br":"Latitude"},Longitude:{"pt-br":"Longitude"}},window.i18n=function(t){var n,r;return n=KomooNS.lang,((r=e[t])!=null?r[n]:void 0)?e[t][n]:t}}.call(this),define("i18n",function(){}),function(e,t){function n(e){var t=e.length,n=ut.type(e);return ut.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===n||"function"!==n&&(0===t||"number"==typeof t&&t>0&&t-1 in e)}function r(e){var t=Et[e]={};return ut.each(e.match(ft)||[],function(e,n){t[n]=!0}),t}function i(e,n,r,i){if(ut.acceptData(e)){var s,o,u=ut.expando,a="string"==typeof n,f=e.nodeType,l=f?ut.cache:e,c=f?e[u]:e[u]&&u;if(c&&l[c]&&(i||l[c].data)||!a||r!==t)return c||(f?e[u]=c=Y.pop()||ut.guid++:c=u),l[c]||(l[c]={},f||(l[c].toJSON=ut.noop)),("object"==typeof n||"function"==typeof n)&&(i?l[c]=ut.extend(l[c],n):l[c].data=ut.extend(l[c].data,n)),s=l[c],i||(s.data||(s.data={}),s=s.data),r!==t&&(s[ut.camelCase(n)]=r),a?(o=s[n],null==o&&(o=s[ut.camelCase(n)])):o=s,o}}function s(e,t,n){if(ut.acceptData(e)){var r,i,s,o=e.nodeType,a=o?ut.cache:e,f=o?e[ut.expando]:ut.expando;if(a[f]){if(t&&(r=n?a[f]:a[f].data)){ut.isArray(t)?t=t.concat(ut.map(t,ut.camelCase)):t in r?t=[t]:(t=ut.camelCase(t),t=t in r?[t]:t.split(" "));for(i=0,s=t.length;s>i;i++)delete r[t[i]];if(!(n?u:ut.isEmptyObject)(r))return}(n||(delete a[f].data,u(a[f])))&&(o?ut.cleanData([e],!0):ut.support.deleteExpando||a!=a.window?delete a[f]:a[f]=null)}}}function o(e,n,r){if(r===t&&1===e.nodeType){var i="data-"+n.replace(xt,"-$1").toLowerCase();if(r=e.getAttribute(i),"string"==typeof r){try{r="true"===r?!0:"false"===r?!1:"null"===r?null:+r+""===r?+r:St.test(r)?ut.parseJSON(r):r}catch(s){}ut.data(e,n,r)}else r=t}return r}function u(e){var t;for(t in e)if(("data"!==t||!ut.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function a(){return!0}function f(){return!1}function l(e,t){do e=e[t];while(e&&1!==e.nodeType);return e}function c(e,t,n){if(t=t||0,ut.isFunction(t))return ut.grep(e,function(e,r){var i=!!t.call(e,r,e);return i===n});if(t.nodeType)return ut.grep(e,function(e){return e===t===n});if("string"==typeof t){var r=ut.grep(e,function(e){return 1===e.nodeType});if(Rt.test(t))return ut.filter(t,r,!n);t=ut.filter(t,r)}return ut.grep(e,function(e){return ut.inArray(e,t)>=0===n})}function h(e){var t=Wt.split("|"),n=e.createDocumentFragment();if(n.createElement)for(;t.length;)n.createElement(t.pop());return n}function p(e,t){return e.getElementsByTagName(t)[0]||e.appendChild(e.ownerDocument.createElement(t))}function d(e){var t=e.getAttributeNode("type");return e.type=(t&&t.specified)+"/"+e.type,e}function v(e){var t=nn.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function m(e,t){for(var n,r=0;null!=(n=e[r]);r++)ut._data(n,"globalEval",!t||ut._data(t[r],"globalEval"))}function g(e,t){if(1===t.nodeType&&ut.hasData(e)){var n,r,i,s=ut._data(e),o=ut._data(t,s),u=s.events;if(u){delete o.handle,o.events={};for(n in u)for(r=0,i=u[n].length;i>r;r++)ut.event.add(t,n,u[n][r])}o.data&&(o.data=ut.extend({},o.data))}}function y(e,t){var n,r,i;if(1===t.nodeType){if(n=t.nodeName.toLowerCase(),!ut.support.noCloneEvent&&t[ut.expando]){r=ut._data(t);for(i in r.events)ut.removeEvent(t,i,r.handle);t.removeAttribute(ut.expando)}"script"===n&&t.text!==e.text?(d(t).text=e.text,v(t)):"object"===n?(t.parentNode&&(t.outerHTML=e.outerHTML),ut.support.html5Clone&&e.innerHTML&&!ut.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===n&&Zt.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===n?t.defaultSelected=t.selected=e.defaultSelected:("input"===n||"textarea"===n)&&(t.defaultValue=e.defaultValue)}}function b(e,n){var r,i,s=0,o=e.getElementsByTagName!==t?e.getElementsByTagName(n||"*"):e.querySelectorAll!==t?e.querySelectorAll(n||"*"):t;if(!o)for(o=[],r=e.childNodes||e;null!=(i=r[s]);s++)!n||ut.nodeName(i,n)?o.push(i):ut.merge(o,b(i,n));return n===t||n&&ut.nodeName(e,n)?ut.merge([e],o):o}function w(e){Zt.test(e.type)&&(e.defaultChecked=e.checked)}function E(e,t){if(t in e)return t;for(var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=xn.length;i--;)if(t=xn[i]+n,t in e)return t;return r}function S(e,t){return e=t||e,"none"===ut.css(e,"display")||!ut.contains(e.ownerDocument,e)}function x(e,t){for(var n,r=[],i=0,s=e.length;s>i;i++)n=e[i],n.style&&(r[i]=ut._data(n,"olddisplay"),t?(r[i]||"none"!==n.style.display||(n.style.display=""),""===n.style.display&&S(n)&&(r[i]=ut._data(n,"olddisplay",k(n.nodeName)))):r[i]||S(n)||ut._data(n,"olddisplay",ut.css(n,"display")));for(i=0;s>i;i++)n=e[i],n.style&&(t&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=t?r[i]||"":"none"));return e}function T(e,t,n){var r=mn.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function N(e,t,n,r,i){for(var s=n===(r?"border":"content")?4:"width"===t?1:0,o=0;4>s;s+=2)"margin"===n&&(o+=ut.css(e,n+Sn[s],!0,i)),r?("content"===n&&(o-=ut.css(e,"padding"+Sn[s],!0,i)),"margin"!==n&&(o-=ut.css(e,"border"+Sn[s]+"Width",!0,i))):(o+=ut.css(e,"padding"+Sn[s],!0,i),"padding"!==n&&(o+=ut.css(e,"border"+Sn[s]+"Width",!0,i)));return o}function C(e,t,n){var r=!0,i="width"===t?e.offsetWidth:e.offsetHeight,s=fn(e),o=ut.support.boxSizing&&"border-box"===ut.css(e,"boxSizing",!1,s);if(0>=i||null==i){if(i=an(e,t,s),(0>i||null==i)&&(i=e.style[t]),gn.test(i))return i;r=o&&(ut.support.boxSizingReliable||i===e.style[t]),i=parseFloat(i)||0}return i+N(e,t,n||(o?"border":"content"),r,s)+"px"}function k(e){var t=$,n=bn[e];return n||(n=L(e,t),"none"!==n&&n||(ln=(ln||ut("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(ln[0].contentWindow||ln[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),n=L(e,t),ln.detach()),bn[e]=n),n}function L(e,t){var n=ut(t.createElement(e)).appendTo(t.body),r=ut.css(n[0],"display");return n.remove(),r}function A(e,t,n,r){var i;if(ut.isArray(t))ut.each(t,function(t,i){n||Nn.test(e)?r(e,i):A(e+"["+("object"==typeof i?t:"")+"]",i,n,r)});else if(n||"object"!==ut.type(t))r(e,t);else for(i in t)A(e+"["+i+"]",t[i],n,r)}function O(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,s=t.toLowerCase().match(ft)||[];if(ut.isFunction(n))for(;r=s[i++];)"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function M(e,n,r,i){function s(a){var f;return o[a]=!0,ut.each(e[a]||[],function(e,a){var l=a(n,r,i);return"string"!=typeof l||u||o[l]?u?!(f=l):t:(n.dataTypes.unshift(l),s(l),!1)}),f}var o={},u=e===Un;return s(n.dataTypes[0])||!o["*"]&&s("*")}function _(e,n){var r,i,s=ut.ajaxSettings.flatOptions||{};for(r in n)n[r]!==t&&((s[r]?e:i||(i={}))[r]=n[r]);return i&&ut.extend(!0,e,i),e}function D(e,n,r){var i,s,o,u,a=e.contents,f=e.dataTypes,l=e.responseFields;for(s in l)s in r&&(n[l[s]]=r[s]);for(;"*"===f[0];)f.shift(),i===t&&(i=e.mimeType||n.getResponseHeader("Content-Type"));if(i)for(s in a)if(a[s]&&a[s].test(i)){f.unshift(s);break}if(f[0]in r)o=f[0];else{for(s in r){if(!f[0]||e.converters[s+" "+f[0]]){o=s;break}u||(u=s)}o=o||u}return o?(o!==f[0]&&f.unshift(o),r[o]):t}function P(e,t){var n,r,i,s,o={},u=0,a=e.dataTypes.slice(),f=a[0];if(e.dataFilter&&(t=e.dataFilter(t,e.dataType)),a[1])for(n in e.converters)o[n.toLowerCase()]=e.converters[n];for(;i=a[++u];)if("*"!==i){if("*"!==f&&f!==i){if(n=o[f+" "+i]||o["* "+i],!n)for(r in o)if(s=r.split(" "),s[1]===i&&(n=o[f+" "+s[0]]||o["* "+s[0]])){n===!0?n=o[r]:o[r]!==!0&&(i=s[0],a.splice(u--,0,i));break}if(n!==!0)if(n&&e["throws"])t=n(t);else try{t=n(t)}catch(l){return{state:"parsererror",error:n?l:"No conversion from "+f+" to "+i}}}f=i}return{state:"success",data:t}}function H(){try{return new e.XMLHttpRequest}catch(t){}}function B(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function j(){return setTimeout(function(){Gn=t}),Gn=ut.now()}function F(e,t){ut.each(t,function(t,n){for(var r=(rr[t]||[]).concat(rr["*"]),i=0,s=r.length;s>i;i++)if(r[i].call(e,t,n))return})}function I(e,t,n){var r,i,s=0,o=nr.length,u=ut.Deferred().always(function(){delete a.elem}),a=function(){if(i)return!1;for(var t=Gn||j(),n=Math.max(0,f.startTime+f.duration-t),r=n/f.duration||0,s=1-r,o=0,a=f.tweens.length;a>o;o++)f.tweens[o].run(s);return u.notifyWith(e,[f,s,n]),1>s&&a?n:(u.resolveWith(e,[f]),!1)},f=u.promise({elem:e,props:ut.extend({},t),opts:ut.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:Gn||j(),duration:n.duration,tweens:[],createTween:function(t,n){var r=ut.Tween(e,f.opts,t,n,f.opts.specialEasing[t]||f.opts.easing);return f.tweens.push(r),r},stop:function(t){var n=0,r=t?f.tweens.length:0;if(i)return this;for(i=!0;r>n;n++)f.tweens[n].run(1);return t?u.resolveWith(e,[f,t]):u.rejectWith(e,[f,t]),this}}),l=f.props;for(q(l,f.opts.specialEasing);o>s;s++)if(r=nr[s].call(f,e,l,f.opts))return r;return F(f,l),ut.isFunction(f.opts.start)&&f.opts.start.call(e,f),ut.fx.timer(ut.extend(a,{elem:e,anim:f,queue:f.opts.queue})),f.progress(f.opts.progress).done(f.opts.done,f.opts.complete).fail(f.opts.fail).always(f.opts.always)}function q(e,t){var n,r,i,s,o;for(n in e)if(r=ut.camelCase(n),i=t[r],s=e[n],ut.isArray(s)&&(i=s[1],s=e[n]=s[0]),n!==r&&(e[r]=s,delete e[n]),o=ut.cssHooks[r],o&&"expand"in o){s=o.expand(s),delete e[r];for(n in s)n in e||(e[n]=s[n],t[n]=i)}else t[r]=i}function R(e,t,n){var r,i,s,o,u,a,f,l,c,h=this,p=e.style,d={},v=[],m=e.nodeType&&S(e);n.queue||(l=ut._queueHooks(e,"fx"),null==l.unqueued&&(l.unqueued=0,c=l.empty.fire,l.empty.fire=function(){l.unqueued||c()}),l.unqueued++,h.always(function(){h.always(function(){l.unqueued--,ut.queue(e,"fx").length||l.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],"inline"===ut.css(e,"display")&&"none"===ut.css(e,"float")&&(ut.support.inlineBlockNeedsLayout&&"inline"!==k(e.nodeName)?p.zoom=1:p.display="inline-block")),n.overflow&&(p.overflow="hidden",ut.support.shrinkWrapBlocks||h.done(function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]}));for(r in t)if(s=t[r],Zn.exec(s)){if(delete t[r],a=a||"toggle"===s,s===(m?"hide":"show"))continue;v.push(r)}if(o=v.length){u=ut._data(e,"fxshow")||ut._data(e,"fxshow",{}),"hidden"in u&&(m=u.hidden),a&&(u.hidden=!m),m?ut(e).show():h.done(function(){ut(e).hide()}),h.done(function(){var t;ut._removeData(e,"fxshow");for(t in d)ut.style(e,t,d[t])});for(r=0;o>r;r++)i=v[r],f=h.createTween(i,m?u[i]:0),d[i]=u[i]||ut.style(e,i),i in u||(u[i]=f.start,m&&(f.end=f.start,f.start="width"===i||"height"===i?1:0))}}function U(e,t,n,r,i){return new U.prototype.init(e,t,n,r,i)}function z(e,t){var n,r={height:e},i=0;for(t=t?1:0;4>i;i+=2-t)n=Sn[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function W(e){return ut.isWindow(e)?e:9===e.nodeType?e.defaultView||e.parentWindow:!1}var X,V,$=e.document,J=e.location,K=e.jQuery,Q=e.$,G={},Y=[],Z="1.9.0",et=Y.concat,tt=Y.push,nt=Y.slice,rt=Y.indexOf,it=G.toString,st=G.hasOwnProperty,ot=Z.trim,ut=function(e,t){return new ut.fn.init(e,t,X)},at=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ft=/\S+/g,lt=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,ct=/^(?:(<[\w\W]+>)[^>]*|#([\w-]*))$/,ht=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,pt=/^[\],:{}\s]*$/,dt=/(?:^|:|,)(?:\s*\[)+/g,vt=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,mt=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,gt=/^-ms-/,yt=/-([\da-z])/gi,bt=function(e,t){return t.toUpperCase()},wt=function(){$.addEventListener?($.removeEventListener("DOMContentLoaded",wt,!1),ut.ready()):"complete"===$.readyState&&($.detachEvent("onreadystatechange",wt),ut.ready())};ut.fn=ut.prototype={jquery:Z,constructor:ut,init:function(e,n,r){var i,s;if(!e)return this;if("string"==typeof e){if(i="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:ct.exec(e),!i||!i[1]&&n)return!n||n.jquery?(n||r).find(e):this.constructor(n).find(e);if(i[1]){if(n=n instanceof ut?n[0]:n,ut.merge(this,ut.parseHTML(i[1],n&&n.nodeType?n.ownerDocument||n:$,!0)),ht.test(i[1])&&ut.isPlainObject(n))for(i in n)ut.isFunction(this[i])?this[i](n[i]):this.attr(i,n[i]);return this}if(s=$.getElementById(i[2]),s&&s.parentNode){if(s.id!==i[2])return r.find(e);this.length=1,this[0]=s}return this.context=$,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):ut.isFunction(e)?r.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),ut.makeArray(e,this))},selector:"",length:0,size:function(){return this.length},toArray:function(){return nt.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e){var t=ut.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return ut.each(this,e,t)},ready:function(e){return ut.ready.promise().done(e),this},slice:function(){return this.pushStack(nt.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},map:function(e){return this.pushStack(ut.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:tt,sort:[].sort,splice:[].splice},ut.fn.init.prototype=ut.fn,ut.extend=ut.fn.extend=function(){var e,n,r,i,s,o,u=arguments[0]||{},a=1,f=arguments.length,l=!1;for("boolean"==typeof u&&(l=u,u=arguments[1]||{},a=2),"object"==typeof u||ut.isFunction(u)||(u={}),f===a&&(u=this,--a);f>a;a++)if(null!=(e=arguments[a]))for(n in e)r=u[n],i=e[n],u!==i&&(l&&i&&(ut.isPlainObject(i)||(s=ut.isArray(i)))?(s?(s=!1,o=r&&ut.isArray(r)?r:[]):o=r&&ut.isPlainObject(r)?r:{},u[n]=ut.extend(l,o,i)):i!==t&&(u[n]=i));return u},ut.extend({noConflict:function(t){return e.$===ut&&(e.$=Q),t&&e.jQuery===ut&&(e.jQuery=K),ut},isReady:!1,readyWait:1,holdReady:function(e){e?ut.readyWait++:ut.ready(!0)},ready:function(e){if(e===!0?!--ut.readyWait:!ut.isReady){if(!$.body)return setTimeout(ut.ready);ut.isReady=!0,e!==!0&&--ut.readyWait>0||(V.resolveWith($,[ut]),ut.fn.trigger&&ut($).trigger("ready").off("ready"))}},isFunction:function(e){return"function"===ut.type(e)},isArray:Array.isArray||function(e){return"array"===ut.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?G[it.call(e)]||"object":typeof e},isPlainObject:function(e){if(!e||"object"!==ut.type(e)||e.nodeType||ut.isWindow(e))return!1;try{if(e.constructor&&!st.call(e,"constructor")&&!st.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(n){return!1}var r;for(r in e);return r===t||st.call(e,r)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw Error(e)},parseHTML:function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||$;var r=ht.exec(e),i=!n&&[];return r?[t.createElement(r[1])]:(r=ut.buildFragment([e],t,i),i&&ut(i).remove(),ut.merge([],r.childNodes))},parseJSON:function(n){return e.JSON&&e.JSON.parse?e.JSON.parse(n):null===n?n:"string"==typeof n&&(n=ut.trim(n),n&&pt.test(n.replace(vt,"@").replace(mt,"]").replace(dt,"")))?Function("return "+n)():(ut.error("Invalid JSON: "+n),t)},parseXML:function(n){var r,i;if(!n||"string"!=typeof n)return null;try{e.DOMParser?(i=new DOMParser,r=i.parseFromString(n,"text/xml")):(r=new ActiveXObject("Microsoft.XMLDOM"),r.async="false",r.loadXML(n))}catch(s){r=t}return r&&r.documentElement&&!r.getElementsByTagName("parsererror").length||ut.error("Invalid XML: "+n),r},noop:function(){},globalEval:function(t){t&&ut.trim(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(gt,"ms-").replace(yt,bt)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,r){var i,s=0,o=e.length,u=n(e);if(r){if(u)for(;o>s&&(i=t.apply(e[s],r),i!==!1);s++);else for(s in e)if(i=t.apply(e[s],r),i===!1)break}else if(u)for(;o>s&&(i=t.call(e[s],s,e[s]),i!==!1);s++);else for(s in e)if(i=t.call(e[s],s,e[s]),i===!1)break;return e},trim:ot&&!ot.call("﻿ ")?function(e){return null==e?"":ot.call(e)}:function(e){return null==e?"":(e+"").replace(lt,"")},makeArray:function(e,t){var r=t||[];return null!=e&&(n(Object(e))?ut.merge(r,"string"==typeof e?[e]:e):tt.call(r,e)),r},inArray:function(e,t,n){var r;if(t){if(rt)return rt.call(t,e,n);for(r=t.length,n=n?0>n?Math.max(0,r+n):n:0;r>n;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,n){var r=n.length,i=e.length,s=0;if("number"==typeof r)for(;r>s;s++)e[i++]=n[s];else for(;n[s]!==t;)e[i++]=n[s++];return e.length=i,e},grep:function(e,t,n){var r,i=[],s=0,o=e.length;for(n=!!n;o>s;s++)r=!!t(e[s],s),n!==r&&i.push(e[s]);return i},map:function(e,t,r){var i,s=0,o=e.length,u=n(e),a=[];if(u)for(;o>s;s++)i=t(e[s],s,r),null!=i&&(a[a.length]=i);else for(s in e)i=t(e[s],s,r),null!=i&&(a[a.length]=i);return et.apply([],a)},guid:1,proxy:function(e,n){var r,i,s;return"string"==typeof n&&(r=e[n],n=e,e=r),ut.isFunction(e)?(i=nt.call(arguments,2),s=function(){return e.apply(n||this,i.concat(nt.call(arguments)))},s.guid=e.guid=e.guid||ut.guid++,s):t},access:function(e,n,r,i,s,o,u){var a=0,f=e.length,l=null==r;if("object"===ut.type(r)){s=!0;for(a in r)ut.access(e,n,a,r[a],!0,o,u)}else if(i!==t&&(s=!0,ut.isFunction(i)||(u=!0),l&&(u?(n.call(e,i),n=null):(l=n,n=function(e,t,n){return l.call(ut(e),n)})),n))for(;f>a;a++)n(e[a],r,u?i:i.call(e[a],a,n(e[a],r)));return s?e:l?n.call(e):f?n(e[0],r):o},now:function(){return(new Date).getTime()}}),ut.ready.promise=function(t){if(!V)if(V=ut.Deferred(),"complete"===$.readyState)setTimeout(ut.ready);else if($.addEventListener)$.addEventListener("DOMContentLoaded",wt,!1),e.addEventListener("load",ut.ready,!1);else{$.attachEvent("onreadystatechange",wt),e.attachEvent("onload",ut.ready);var n=!1;try{n=null==e.frameElement&&$.documentElement}catch(r){}n&&n.doScroll&&function i(){if(!ut.isReady){try{n.doScroll("left")}catch(e){return setTimeout(i,50)}ut.ready()}}()}return V.promise(t)},ut.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){G["[object "+t+"]"]=t.toLowerCase()}),X=ut($);var Et={};ut.Callbacks=function(e){e="string"==typeof e?Et[e]||r(e):ut.extend({},e);var n,i,s,o,u,a,f=[],l=!e.once&&[],c=function(t){for(n=e.memory&&t,i=!0,a=o||0,o=0,u=f.length,s=!0;f&&u>a;a++)if(f[a].apply(t[0],t[1])===!1&&e.stopOnFalse){n=!1;break}s=!1,f&&(l?l.length&&c(l.shift()):n?f=[]:h.disable())},h={add:function(){if(f){var t=f.length;(function r(t){ut.each(t,function(t,n){var i=ut.type(n);"function"===i?e.unique&&h.has(n)||f.push(n):n&&n.length&&"string"!==i&&r(n)})})(arguments),s?u=f.length:n&&(o=t,c(n))}return this},remove:function(){return f&&ut.each(arguments,function(e,t){for(var n;(n=ut.inArray(t,f,n))>-1;)f.splice(n,1),s&&(u>=n&&u--,a>=n&&a--)}),this},has:function(e){return ut.inArray(e,f)>-1},empty:function(){return f=[],this},disable:function(){return f=l=n=t,this},disabled:function(){return!f},lock:function(){return l=t,n||h.disable(),this},locked:function(){return!l},fireWith:function(e,t){return t=t||[],t=[e,t.slice?t.slice():t],!f||i&&!l||(s?l.push(t):c(t)),this},fire:function(){return h.fireWith(this,arguments),this},fired:function(){return!!i}};return h},ut.extend({Deferred:function(e){var t=[["resolve","done",ut.Callbacks("once memory"),"resolved"],["reject","fail",ut.Callbacks("once memory"),"rejected"],["notify","progress",ut.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return ut.Deferred(function(n){ut.each(t,function(t,s){var o=s[0],u=ut.isFunction(e[t])&&e[t];i[s[1]](function(){var e=u&&u.apply(this,arguments);e&&ut.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[o+"With"](this===r?n.promise():this,u?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?ut.extend(e,r):r}},i={};return r.pipe=r.then,ut.each(t,function(e,s){var o=s[2],u=s[3];r[s[1]]=o.add,u&&o.add(function(){n=u},t[1^e][2].disable,t[2][2].lock),i[s[0]]=function(){return i[s[0]+"With"](this===i?r:this,arguments),this},i[s[0]+"With"]=o.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t,n,r,i=0,s=nt.call(arguments),o=s.length,u=1!==o||e&&ut.isFunction(e.promise)?o:0,a=1===u?e:ut.Deferred(),f=function(e,n,r){return function(i){n[e]=this,r[e]=arguments.length>1?nt.call(arguments):i,r===t?a.notifyWith(n,r):--u||a.resolveWith(n,r)}};if(o>1)for(t=Array(o),n=Array(o),r=Array(o);o>i;i++)s[i]&&ut.isFunction(s[i].promise)?s[i].promise().done(f(i,r,s)).fail(a.reject).progress(f(i,n,t)):--u;return u||a.resolveWith(r,s),a.promise()}}),ut.support=function(){var n,r,i,s,o,u,a,f,l,c,h=$.createElement("div");if(h.setAttribute("className","t"),h.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",r=h.getElementsByTagName("*"),i=h.getElementsByTagName("a")[0],!r||!i||!r.length)return{};s=$.createElement("select"),o=s.appendChild($.createElement("option")),u=h.getElementsByTagName("input")[0],i.style.cssText="top:1px;float:left;opacity:.5",n={getSetAttribute:"t"!==h.className,leadingWhitespace:3===h.firstChild.nodeType,tbody:!h.getElementsByTagName("tbody").length,htmlSerialize:!!h.getElementsByTagName("link").length,style:/top/.test(i.getAttribute("style")),hrefNormalized:"/a"===i.getAttribute("href"),opacity:/^0.5/.test(i.style.opacity),cssFloat:!!i.style.cssFloat,checkOn:!!u.value,optSelected:o.selected,enctype:!!$.createElement("form").enctype,html5Clone:"<:nav></:nav>"!==$.createElement("nav").cloneNode(!0).outerHTML,boxModel:"CSS1Compat"===$.compatMode,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},u.checked=!0,n.noCloneChecked=u.cloneNode(!0).checked,s.disabled=!0,n.optDisabled=!o.disabled;try{delete h.test}catch(p){n.deleteExpando=!1}u=$.createElement("input"),u.setAttribute("value",""),n.input=""===u.getAttribute("value"),u.value="t",u.setAttribute("type","radio"),n.radioValue="t"===u.value,u.setAttribute("checked","t"),u.setAttribute("name","t"),a=$.createDocumentFragment(),a.appendChild(u),n.appendChecked=u.checked,n.checkClone=a.cloneNode(!0).cloneNode(!0).lastChild.checked,h.attachEvent&&(h.attachEvent("onclick",function(){n.noCloneEvent=!1}),h.cloneNode(!0).click());for(c in{submit:!0,change:!0,focusin:!0})h.setAttribute(f="on"+c,"t"),n[c+"Bubbles"]=f in e||h.attributes[f].expando===!1;return h.style.backgroundClip="content-box",h.cloneNode(!0).style.backgroundClip="",n.clearCloneStyle="content-box"===h.style.backgroundClip,ut(function(){var r,i,s,o="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",u=$.getElementsByTagName("body")[0];u&&(r=$.createElement("div"),r.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",u.appendChild(r).appendChild(h),h.innerHTML="<table><tr><td></td><td>t</td></tr></table>",s=h.getElementsByTagName("td"),s[0].style.cssText="padding:0;margin:0;border:0;display:none",l=0===s[0].offsetHeight,s[0].style.display="",s[1].style.display="none",n.reliableHiddenOffsets=l&&0===s[0].offsetHeight,h.innerHTML="",h.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",n.boxSizing=4===h.offsetWidth,n.doesNotIncludeMarginInBodyOffset=1!==u.offsetTop,e.getComputedStyle&&(n.pixelPosition="1%"!==(e.getComputedStyle(h,null)||{}).top,n.boxSizingReliable="4px"===(e.getComputedStyle(h,null)||{width:"4px"}).width,i=h.appendChild($.createElement("div")),i.style.cssText=h.style.cssText=o,i.style.marginRight=i.style.width="0",h.style.width="1px",n.reliableMarginRight=!parseFloat((e.getComputedStyle(i,null)||{}).marginRight)),h.style.zoom!==t&&(h.innerHTML="",h.style.cssText=o+"width:1px;padding:1px;display:inline;zoom:1",n.inlineBlockNeedsLayout=3===h.offsetWidth,h.style.display="block",h.innerHTML="<div></div>",h.firstChild.style.width="5px",n.shrinkWrapBlocks=3!==h.offsetWidth,u.style.zoom=1),u.removeChild(r),r=h=s=i=null)}),r=s=a=o=i=u=null,n}();var St=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,xt=/([A-Z])/g;ut.extend({cache:{},expando:"jQuery"+(Z+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(e){return e=e.nodeType?ut.cache[e[ut.expando]]:e[ut.expando],!!e&&!u(e)},data:function(e,t,n){return i(e,t,n,!1)},removeData:function(e,t){return s(e,t,!1)},_data:function(e,t,n){return i(e,t,n,!0)},_removeData:function(e,t){return s(e,t,!0)},acceptData:function(e){var t=e.nodeName&&ut.noData[e.nodeName.toLowerCase()];return!t||t!==!0&&e.getAttribute("classid")===t}}),ut.fn.extend({data:function(e,n){var r,i,s=this[0],u=0,a=null;if(e===t){if(this.length&&(a=ut.data(s),1===s.nodeType&&!ut._data(s,"parsedAttrs"))){for(r=s.attributes;r.length>u;u++)i=r[u].name,i.indexOf("data-")||(i=ut.camelCase(i.substring(5)),o(s,i,a[i]));ut._data(s,"parsedAttrs",!0)}return a}return"object"==typeof e?this.each(function(){ut.data(this,e)}):ut.access(this,function(n){return n===t?s?o(s,e,ut.data(s,e)):null:(this.each(function(){ut.data(this,e,n)}),t)},null,n,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){ut.removeData(this,e)})}}),ut.extend({queue:function(e,n,r){var i;return e?(n=(n||"fx")+"queue",i=ut._data(e,n),r&&(!i||ut.isArray(r)?i=ut._data(e,n,ut.makeArray(r)):i.push(r)),i||[]):t},dequeue:function(e,t){t=t||"fx";var n=ut.queue(e,t),r=n.length,i=n.shift(),s=ut._queueHooks(e,t),o=function(){ut.dequeue(e,t)};"inprogress"===i&&(i=n.shift(),r--),s.cur=i,i&&("fx"===t&&n.unshift("inprogress"),delete s.stop,i.call(e,o,s)),!r&&s&&s.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return ut._data(e,n)||ut._data(e,n,{empty:ut.Callbacks("once memory").add(function(){ut._removeData(e,t+"queue"),ut._removeData(e,n)})})}}),ut.fn.extend({queue:function(e,n){var r=2;return"string"!=typeof e&&(n=e,e="fx",r--),r>arguments.length?ut.queue(this[0],e):n===t?this:this.each(function(){var t=ut.queue(this,e,n);ut._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&ut.dequeue(this,e)})},dequeue:function(e){return this.each(function(){ut.dequeue(this,e)})},delay:function(e,t){return e=ut.fx?ut.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,n){var r,i=1,s=ut.Deferred(),o=this,u=this.length,a=function(){--i||s.resolveWith(o,[o])};for("string"!=typeof e&&(n=e,e=t),e=e||"fx";u--;)r=ut._data(o[u],e+"queueHooks"),r&&r.empty&&(i++,r.empty.add(a));return a(),s.promise(n)}});var Tt,Nt,Ct=/[\t\r\n]/g,kt=/\r/g,Lt=/^(?:input|select|textarea|button|object)$/i,At=/^(?:a|area)$/i,Ot=/^(?:checked|selected|autofocus|autoplay|async|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped)$/i,Mt=/^(?:checked|selected)$/i,_t=ut.support.getSetAttribute,Dt=ut.support.input;ut.fn.extend({attr:function(e,t){return ut.access(this,ut.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){ut.removeAttr(this,e)})},prop:function(e,t){return ut.access(this,ut.prop,e,t,arguments.length>1)},removeProp:function(e){return e=ut.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(n){}})},addClass:function(e){var t,n,r,i,s,o=0,u=this.length,a="string"==typeof e&&e;if(ut.isFunction(e))return this.each(function(t){ut(this).addClass(e.call(this,t,this.className))});if(a)for(t=(e||"").match(ft)||[];u>o;o++)if(n=this[o],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(Ct," "):" ")){for(s=0;i=t[s++];)0>r.indexOf(" "+i+" ")&&(r+=i+" ");n.className=ut.trim(r)}return this},removeClass:function(e){var t,n,r,i,s,o=0,u=this.length,a=0===arguments.length||"string"==typeof e&&e;if(ut.isFunction(e))return this.each(function(t){ut(this).removeClass(e.call(this,t,this.className))});if(a)for(t=(e||"").match(ft)||[];u>o;o++)if(n=this[o],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(Ct," "):"")){for(s=0;i=t[s++];)for(;r.indexOf(" "+i+" ")>=0;)r=r.replace(" "+i+" "," ");n.className=e?ut.trim(r):""}return this},toggleClass:function(e,t){var n=typeof e,r="boolean"==typeof t;return ut.isFunction(e)?this.each(function(n){ut(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if("string"===n)for(var i,s=0,o=ut(this),u=t,a=e.match(ft)||[];i=a[s++];)u=r?u:!o.hasClass(i),o[u?"addClass":"removeClass"](i);else("undefined"===n||"boolean"===n)&&(this.className&&ut._data(this,"__className__",this.className),this.className=this.className||e===!1?"":ut._data(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",n=0,r=this.length;r>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(Ct," ").indexOf(t)>=0)return!0;return!1},val:function(e){var n,r,i,s=this[0];if(arguments.length)return i=ut.isFunction(e),this.each(function(r){var s,o=ut(this);1===this.nodeType&&(s=i?e.call(this,r,o.val()):e,null==s?s="":"number"==typeof s?s+="":ut.isArray(s)&&(s=ut.map(s,function(e){return null==e?"":e+""})),n=ut.valHooks[this.type]||ut.valHooks[this.nodeName.toLowerCase()],n&&"set"in n&&n.set(this,s,"value")!==t||(this.value=s))});if(s)return n=ut.valHooks[s.type]||ut.valHooks[s.nodeName.toLowerCase()],n&&"get"in n&&(r=n.get(s,"value"))!==t?r:(r=s.value,"string"==typeof r?r.replace(kt,""):null==r?"":r)}}),ut.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){for(var t,n,r=e.options,i=e.selectedIndex,s="select-one"===e.type||0>i,o=s?null:[],u=s?i+1:r.length,a=0>i?u:s?i:0;u>a;a++)if(n=r[a],!(!n.selected&&a!==i||(ut.support.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&ut.nodeName(n.parentNode,"optgroup"))){if(t=ut(n).val(),s)return t;o.push(t)}return o},set:function(e,t){var n=ut.makeArray(t);return ut(e).find("option").each(function(){this.selected=ut.inArray(ut(this).val(),n)>=0}),n.length||(e.selectedIndex=-1),n}}},attr:function(e,n,r){var i,s,o,u=e.nodeType;if(e&&3!==u&&8!==u&&2!==u)return e.getAttribute===t?ut.prop(e,n,r):(o=1!==u||!ut.isXMLDoc(e),o&&(n=n.toLowerCase(),s=ut.attrHooks[n]||(Ot.test(n)?Nt:Tt)),r===t?s&&o&&"get"in s&&null!==(i=s.get(e,n))?i:(e.getAttribute!==t&&(i=e.getAttribute(n)),null==i?t:i):null!==r?s&&o&&"set"in s&&(i=s.set(e,r,n))!==t?i:(e.setAttribute(n,r+""),r):(ut.removeAttr(e,n),t))},removeAttr:function(e,t){var n,r,i=0,s=t&&t.match(ft);if(s&&1===e.nodeType)for(;n=s[i++];)r=ut.propFix[n]||n,Ot.test(n)?!_t&&Mt.test(n)?e[ut.camelCase("default-"+n)]=e[r]=!1:e[r]=!1:ut.attr(e,n,""),e.removeAttribute(_t?n:r)},attrHooks:{type:{set:function(e,t){if(!ut.support.radioValue&&"radio"===t&&ut.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(e,n,r){var i,s,o,u=e.nodeType;if(e&&3!==u&&8!==u&&2!==u)return o=1!==u||!ut.isXMLDoc(e),o&&(n=ut.propFix[n]||n,s=ut.propHooks[n]),r!==t?s&&"set"in s&&(i=s.set(e,r,n))!==t?i:e[n]=r:s&&"get"in s&&null!==(i=s.get(e,n))?i:e[n]},propHooks:{tabIndex:{get:function(e){var n=e.getAttributeNode("tabindex");return n&&n.specified?parseInt(n.value,10):Lt.test(e.nodeName)||At.test(e.nodeName)&&e.href?0:t}}}}),Nt={get:function(e,n){var r=ut.prop(e,n),i="boolean"==typeof r&&e.getAttribute(n),s="boolean"==typeof r?Dt&&_t?null!=i:Mt.test(n)?e[ut.camelCase("default-"+n)]:!!i:e.getAttributeNode(n);return s&&s.value!==!1?n.toLowerCase():t},set:function(e,t,n){return t===!1?ut.removeAttr(e,n):Dt&&_t||!Mt.test(n)?e.setAttribute(!_t&&ut.propFix[n]||n,n):e[ut.camelCase("default-"+n)]=e[n]=!0,n}},Dt&&_t||(ut.attrHooks.value={get:function(e,n){var r=e.getAttributeNode(n);return ut.nodeName(e,"input")?e.defaultValue:r&&r.specified?r.value:t},set:function(e,n,r){return ut.nodeName(e,"input")?(e.defaultValue=n,t):Tt&&Tt.set(e,n,r)}}),_t||(Tt=ut.valHooks.button={get:function(e,n){var r=e.getAttributeNode(n);return r&&("id"===n||"name"===n||"coords"===n?""!==r.value:r.specified)?r.value:t},set:function(e,n,r){var i=e.getAttributeNode(r);return i||e.setAttributeNode(i=e.ownerDocument.createAttribute(r)),i.value=n+="","value"===r||n===e.getAttribute(r)?n:t}},ut.attrHooks.contenteditable={get:Tt.get,set:function(e,t,n){Tt.set(e,""===t?!1:t,n)}},ut.each(["width","height"],function(e,n){ut.attrHooks[n]=ut.extend(ut.attrHooks[n],{set:function(e,r){return""===r?(e.setAttribute(n,"auto"),r):t}})})),ut.support.hrefNormalized||(ut.each(["href","src","width","height"],function(e,n){ut.attrHooks[n]=ut.extend(ut.attrHooks[n],{get:function(e){var r=e.getAttribute(n,2);return null==r?t:r}})}),ut.each(["href","src"],function(e,t){ut.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}})),ut.support.style||(ut.attrHooks.style={get:function(e){return e.style.cssText||t},set:function(e,t){return e.style.cssText=t+""}}),ut.support.optSelected||(ut.propHooks.selected=ut.extend(ut.propHooks.selected,{get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}})),ut.support.enctype||(ut.propFix.enctype="encoding"),ut.support.checkOn||ut.each(["radio","checkbox"],function(){ut.valHooks[this]={get:function(e){return null===e.getAttribute("value")?"on":e.value}}}),ut.each(["radio","checkbox"],function(){ut.valHooks[this]=ut.extend(ut.valHooks[this],{set:function(e,n){return ut.isArray(n)?e.checked=ut.inArray(ut(e).val(),n)>=0:t}})});var Pt=/^(?:input|select|textarea)$/i,Ht=/^key/,Bt=/^(?:mouse|contextmenu)|click/,jt=/^(?:focusinfocus|focusoutblur)$/,Ft=/^([^.]*)(?:\.(.+)|)$/;ut.event={global:{},add:function(e,n,r,i,s){var o,u,a,f,l,c,h,p,d,v,m,g=3!==e.nodeType&&8!==e.nodeType&&ut._data(e);if(g){for(r.handler&&(o=r,r=o.handler,s=o.selector),r.guid||(r.guid=ut.guid++),(f=g.events)||(f=g.events={}),(u=g.handle)||(u=g.handle=function(e){return ut===t||e&&ut.event.triggered===e.type?t:ut.event.dispatch.apply(u.elem,arguments)},u.elem=e),n=(n||"").match(ft)||[""],l=n.length;l--;)a=Ft.exec(n[l])||[],d=m=a[1],v=(a[2]||"").split(".").sort(),h=ut.event.special[d]||{},d=(s?h.delegateType:h.bindType)||d,h=ut.event.special[d]||{},c=ut.extend({type:d,origType:m,data:i,handler:r,guid:r.guid,selector:s,needsContext:s&&ut.expr.match.needsContext.test(s),namespace:v.join(".")},o),(p=f[d])||(p=f[d]=[],p.delegateCount=0,h.setup&&h.setup.call(e,i,v,u)!==!1||(e.addEventListener?e.addEventListener(d,u,!1):e.attachEvent&&e.attachEvent("on"+d,u))),h.add&&(h.add.call(e,c),c.handler.guid||(c.handler.guid=r.guid)),s?p.splice(p.delegateCount++,0,c):p.push(c),ut.event.global[d]=!0;e=null}},remove:function(e,t,n,r,i){var s,o,u,a,f,l,c,h,p,d,v,m=ut.hasData(e)&&ut._data(e);if(m&&(a=m.events)){for(t=(t||"").match(ft)||[""],f=t.length;f--;)if(u=Ft.exec(t[f])||[],p=v=u[1],d=(u[2]||"").split(".").sort(),p){for(c=ut.event.special[p]||{},p=(r?c.delegateType:c.bindType)||p,h=a[p]||[],u=u[2]&&RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"),o=s=h.length;s--;)l=h[s],!i&&v!==l.origType||n&&n.guid!==l.guid||u&&!u.test(l.namespace)||r&&r!==l.selector&&("**"!==r||!l.selector)||(h.splice(s,1),l.selector&&h.delegateCount--,c.remove&&c.remove.call(e,l));o&&!h.length&&(c.teardown&&c.teardown.call(e,d,m.handle)!==!1||ut.removeEvent(e,p,m.handle),delete a[p])}else for(p in a)ut.event.remove(e,p+t[f],n,r,!0);ut.isEmptyObject(a)&&(delete m.handle,ut._removeData(e,"events"))}},trigger:function(n,r,i,s){var o,u,a,f,l,c,h,p=[i||$],d=n.type||n,v=n.namespace?n.namespace.split("."):[];if(u=a=i=i||$,3!==i.nodeType&&8!==i.nodeType&&!jt.test(d+ut.event.triggered)&&(d.indexOf(".")>=0&&(v=d.split("."),d=v.shift(),v.sort()),l=0>d.indexOf(":")&&"on"+d,n=n[ut.expando]?n:new ut.Event(d,"object"==typeof n&&n),n.isTrigger=!0,n.namespace=v.join("."),n.namespace_re=n.namespace?RegExp("(^|\\.)"+v.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,n.result=t,n.target||(n.target=i),r=null==r?[n]:ut.makeArray(r,[n]),h=ut.event.special[d]||{},s||!h.trigger||h.trigger.apply(i,r)!==!1)){if(!s&&!h.noBubble&&!ut.isWindow(i)){for(f=h.delegateType||d,jt.test(f+d)||(u=u.parentNode);u;u=u.parentNode)p.push(u),a=u;a===(i.ownerDocument||$)&&p.push(a.defaultView||a.parentWindow||e)}for(o=0;(u=p[o++])&&!n.isPropagationStopped();)n.type=o>1?f:h.bindType||d,c=(ut._data(u,"events")||{})[n.type]&&ut._data(u,"handle"),c&&c.apply(u,r),c=l&&u[l],c&&ut.acceptData(u)&&c.apply&&c.apply(u,r)===!1&&n.preventDefault();if(n.type=d,!(s||n.isDefaultPrevented()||h._default&&h._default.apply(i.ownerDocument,r)!==!1||"click"===d&&ut.nodeName(i,"a")||!ut.acceptData(i)||!l||!i[d]||ut.isWindow(i))){a=i[l],a&&(i[l]=null),ut.event.triggered=d;try{i[d]()}catch(m){}ut.event.triggered=t,a&&(i[l]=a)}return n.result}},dispatch:function(e){e=ut.event.fix(e);var n,r,i,s,o,u=[],a=nt.call(arguments),f=(ut._data(this,"events")||{})[e.type]||[],l=ut.event.special[e.type]||{};if(a[0]=e,e.delegateTarget=this,!l.preDispatch||l.preDispatch.call(this,e)!==!1){for(u=ut.event.handlers.call(this,e,f),n=0;(s=u[n++])&&!e.isPropagationStopped();)for(e.currentTarget=s.elem,r=0;(o=s.handlers[r++])&&!e.isImmediatePropagationStopped();)(!e.namespace_re||e.namespace_re.test(o.namespace))&&(e.handleObj=o,e.data=o.data,i=((ut.event.special[o.origType]||{}).handle||o.handler).apply(s.elem,a),i!==t&&(e.result=i)===!1&&(e.preventDefault(),e.stopPropagation()));return l.postDispatch&&l.postDispatch.call(this,e),e.result}},handlers:function(e,n){var r,i,s,o,u=[],a=n.delegateCount,f=e.target;if(a&&f.nodeType&&(!e.button||"click"!==e.type))for(;f!=this;f=f.parentNode||this)if(f.disabled!==!0||"click"!==e.type){for(i=[],r=0;a>r;r++)o=n[r],s=o.selector+" ",i[s]===t&&(i[s]=o.needsContext?ut(s,this).index(f)>=0:ut.find(s,this,null,[f]).length),i[s]&&i.push(o);i.length&&u.push({elem:f,handlers:i})}return n.length>a&&u.push({elem:this,handlers:n.slice(a)}),u},fix:function(e){if(e[ut.expando])return e;var t,n,r=e,i=ut.event.fixHooks[e.type]||{},s=i.props?this.props.concat(i.props):this.props;for(e=new ut.Event(r),t=s.length;t--;)n=s[t],e[n]=r[n];return e.target||(e.target=r.srcElement||$),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,i.filter?i.filter(e,r):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,n){var r,i,s,o=n.button,u=n.fromElement;return null==e.pageX&&null!=n.clientX&&(r=e.target.ownerDocument||$,i=r.documentElement,s=r.body,e.pageX=n.clientX+(i&&i.scrollLeft||s&&s.scrollLeft||0)-(i&&i.clientLeft||s&&s.clientLeft||0),e.pageY=n.clientY+(i&&i.scrollTop||s&&s.scrollTop||0)-(i&&i.clientTop||s&&s.clientTop||0)),!e.relatedTarget&&u&&(e.relatedTarget=u===e.target?n.toElement:u),e.which||o===t||(e.which=1&o?1:2&o?3:4&o?2:0),e}},special:{load:{noBubble:!0},click:{trigger:function(){return ut.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):t}},focus:{trigger:function(){if(this!==$.activeElement&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){return this===$.activeElement&&this.blur?(this.blur(),!1):t},delegateType:"focusout"},beforeunload:{postDispatch:function(e){e.result!==t&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){var i=ut.extend(new ut.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?ut.event.trigger(i,null,t):ut.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},ut.removeEvent=$.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,n,r){var i="on"+n;e.detachEvent&&(e[i]===t&&(e[i]=null),e.detachEvent(i,r))},ut.Event=function(e,n){return this instanceof ut.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?a:f):this.type=e,n&&ut.extend(this,n),this.timeStamp=e&&e.timeStamp||ut.now(),this[ut.expando]=!0,t):new ut.Event(e,n)},ut.Event.prototype={isDefaultPrevented:f,isPropagationStopped:f,isImmediatePropagationStopped:f,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=a,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=a,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=a,this.stopPropagation()}},ut.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){ut.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,s=e.handleObj;return(!i||i!==r&&!ut.contains(r,i))&&(e.type=s.origType,n=s.handler.apply(this,arguments),e.type=t),n}}}),ut.support.submitBubbles||(ut.event.special.submit={setup:function(){return ut.nodeName(this,"form")?!1:(ut.event.add(this,"click._submit keypress._submit",function(e){var n=e.target,r=ut.nodeName(n,"input")||ut.nodeName(n,"button")?n.form:t;r&&!ut._data(r,"submitBubbles")&&(ut.event.add(r,"submit._submit",function(e){e._submit_bubble=!0}),ut._data(r,"submitBubbles",!0))}),t)},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&ut.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){return ut.nodeName(this,"form")?!1:(ut.event.remove(this,"._submit"),t)}}),ut.support.changeBubbles||(ut.event.special.change={setup:function(){return Pt.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(ut.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),ut.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),ut.event.simulate("change",this,e,!0)})),!1):(ut.event.add(this,"beforeactivate._change",function(e){var t=e.target;Pt.test(t.nodeName)&&!ut._data(t,"changeBubbles")&&(ut.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||ut.event.simulate("change",this.parentNode,e,!0)}),ut._data(t,"changeBubbles",!0))}),t)},handle:function(e){var n=e.target;return this!==n||e.isSimulated||e.isTrigger||"radio"!==n.type&&"checkbox"!==n.type?e.handleObj.handler.apply(this,arguments):t},teardown:function(){return ut.event.remove(this,"._change"),!Pt.test(this.nodeName)}}),ut.support.focusinBubbles||ut.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){ut.event.simulate(t,e.target,ut.event.fix(e),!0)};ut.event.special[t]={setup:function(){0===n++&&$.addEventListener(e,r,!0)},teardown:function(){0===--n&&$.removeEventListener(e,r,!0)}}}),ut.fn.extend({on:function(e,n,r,i,s){var o,u;if("object"==typeof e){"string"!=typeof n&&(r=r||n,n=t);for(u in e)this.on(u,n,r,e[u],s);return this}if(null==r&&null==i?(i=n,r=n=t):null==i&&("string"==typeof n?(i=r,r=t):(i=r,r=n,n=t)),i===!1)i=f;else if(!i)return this;return 1===s&&(o=i,i=function(e){return ut().off(e),o.apply(this,arguments)},i.guid=o.guid||(o.guid=ut.guid++)),this.each(function(){ut.event.add(this,e,i,r,n)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,n,r){var i,s;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,ut(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof e){for(s in e)this.off(s,n,e[s]);return this}return(n===!1||"function"==typeof n)&&(r=n,n=t),r===!1&&(r=f),this.each(function(){ut.event.remove(this,e,r,n)})},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},trigger:function(e,t){return this.each(function(){ut.event.trigger(e,t,this)})},triggerHandler:function(e,n){var r=this[0];return r?ut.event.trigger(e,n,r,!0):t},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),ut.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){ut.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)},Ht.test(t)&&(ut.event.fixHooks[t]=ut.event.keyHooks),Bt.test(t)&&(ut.event.fixHooks[t]=ut.event.mouseHooks)}),function(e,t){function n(e){return dt.test(e+"")}function r(){var e,t=[];return e=function(n,r){return t.push(n+=" ")>T.cacheLength&&delete e[t.shift()],e[n]=r}}function i(e){return e[I]=!0,e}function s(e){var t=M.createElement("div");try{return e(t)}catch(n){return!1}finally{t=null}}function o(e,t,n,r){var i,s,o,u,a,f,l,p,d,v;if((t?t.ownerDocument||t:q)!==M&&O(t),t=t||M,n=n||[],!e||"string"!=typeof e)return n;if(1!==(u=t.nodeType)&&9!==u)return[];if(!D&&!r){if(i=vt.exec(e))if(o=i[1]){if(9===u){if(s=t.getElementById(o),!s||!s.parentNode)return n;if(s.id===o)return n.push(s),n}else if(t.ownerDocument&&(s=t.ownerDocument.getElementById(o))&&j(t,s)&&s.id===o)return n.push(s),n}else{if(i[2])return G.apply(n,Y.call(t.getElementsByTagName(e),0)),n;if((o=i[3])&&R.getByClassName&&t.getElementsByClassName)return G.apply(n,Y.call(t.getElementsByClassName(o),0)),n}if(R.qsa&&!P.test(e)){if(l=!0,p=I,d=t,v=9===u&&e,1===u&&"object"!==t.nodeName.toLowerCase()){for(f=c(e),(l=t.getAttribute("id"))?p=l.replace(yt,"\\$&"):t.setAttribute("id",p),p="[id='"+p+"'] ",a=f.length;a--;)f[a]=p+h(f[a]);d=pt.test(e)&&t.parentNode||t,v=f.join(",")}if(v)try{return G.apply(n,Y.call(d.querySelectorAll(v),0)),n}catch(m){}finally{l||t.removeAttribute("id")}}}return w(e.replace(ot,"$1"),t,n,r)}function u(e,t){for(var n=e&&t&&e.nextSibling;n;n=n.nextSibling)if(n===t)return-1;return e?1:-1}function a(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function f(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function l(e){return i(function(t){return t=+t,i(function(n,r){for(var i,s=e([],n.length,t),o=s.length;o--;)n[i=s[o]]&&(n[i]=!(r[i]=n[i]))})})}function c(e,t){var n,r,i,s,u,a,f,l=X[e+" "];if(l)return t?0:l.slice(0);for(u=e,a=[],f=T.preFilter;u;){(!n||(r=at.exec(u)))&&(r&&(u=u.slice(r[0].length)||u),a.push(i=[])),n=!1,(r=ft.exec(u))&&(n=r.shift(),i.push({value:n,type:r[0].replace(ot," ")}),u=u.slice(n.length));for(s in T.filter)!(r=ht[s].exec(u))||f[s]&&!(r=f[s](r))||(n=r.shift(),i.push({value:n,type:s,matches:r}),u=u.slice(n.length));if(!n)break}return t?u.length:u?o.error(e):X(e,a).slice(0)}function h(e){for(var t=0,n=e.length,r="";n>t;t++)r+=e[t].value;return r}function p(e,t,n){var r=t.dir,i=n&&"parentNode"===t.dir,s=z++;return t.first?function(t,n,s){for(;t=t[r];)if(1===t.nodeType||i)return e(t,n,s)}:function(t,n,o){var u,a,f,l=U+" "+s;if(o){for(;t=t[r];)if((1===t.nodeType||i)&&e(t,n,o))return!0}else for(;t=t[r];)if(1===t.nodeType||i)if(f=t[I]||(t[I]={}),(a=f[r])&&a[0]===l){if((u=a[1])===!0||u===x)return u===!0}else if(a=f[r]=[l],a[1]=e(t,n,o)||x,a[1]===!0)return!0}}function d(e){return e.length>1?function(t,n,r){for(var i=e.length;i--;)if(!e[i](t,n,r))return!1;return!0}:e[0]}function v(e,t,n,r,i){for(var s,o=[],u=0,a=e.length,f=null!=t;a>u;u++)(s=e[u])&&(!n||n(s,r,i))&&(o.push(s),f&&t.push(u));return o}function m(e,t,n,r,s,o){return r&&!r[I]&&(r=m(r)),s&&!s[I]&&(s=m(s,o)),i(function(i,o,u,a){var f,l,c,h=[],p=[],d=o.length,m=i||b(t||"*",u.nodeType?[u]:u,[]),g=!e||!i&&t?m:v(m,h,e,u,a),y=n?s||(i?e:d||r)?[]:o:g;if(n&&n(g,y,u,a),r)for(f=v(y,p),r(f,[],u,a),l=f.length;l--;)(c=f[l])&&(y[p[l]]=!(g[p[l]]=c));if(i){if(s||e){if(s){for(f=[],l=y.length;l--;)(c=y[l])&&f.push(g[l]=c);s(null,y=[],f,a)}for(l=y.length;l--;)(c=y[l])&&(f=s?Z.call(i,c):h[l])>-1&&(i[f]=!(o[f]=c))}}else y=v(y===o?y.splice(d,y.length):y),s?s(null,o,y,a):G.apply(o,y)})}function g(e){for(var t,n,r,i=e.length,s=T.relative[e[0].type],o=s||T.relative[" "],u=s?1:0,a=p(function(e){return e===t},o,!0),f=p(function(e){return Z.call(t,e)>-1},o,!0),l=[function(e,n,r){return!s&&(r||n!==A)||((t=n).nodeType?a(e,n,r):f(e,n,r))}];i>u;u++)if(n=T.relative[e[u].type])l=[p(d(l),n)];else{if(n=T.filter[e[u].type].apply(null,e[u].matches),n[I]){for(r=++u;i>r&&!T.relative[e[r].type];r++);return m(u>1&&d(l),u>1&&h(e.slice(0,u-1)).replace(ot,"$1"),n,r>u&&g(e.slice(u,r)),i>r&&g(e=e.slice(r)),i>r&&h(e))}l.push(n)}return d(l)}function y(e,t){var n=0,r=t.length>0,s=e.length>0,u=function(i,u,a,f,l){var c,h,p,d=[],m=0,g="0",y=i&&[],b=null!=l,w=A,E=i||s&&T.find.TAG("*",l&&u.parentNode||u),S=U+=null==w?1:Math.E;for(b&&(A=u!==M&&u,x=n);null!=(c=E[g]);g++){if(s&&c){for(h=0;p=e[h];h++)if(p(c,u,a)){f.push(c);break}b&&(U=S,x=++n)}r&&((c=!p&&c)&&m--,i&&y.push(c))}if(m+=g,r&&g!==m){for(h=0;p=t[h];h++)p(y,d,u,a);if(i){if(m>0)for(;g--;)y[g]||d[g]||(d[g]=Q.call(f));d=v(d)}G.apply(f,d),b&&!i&&d.length>0&&m+t.length>1&&o.uniqueSort(f)}return b&&(U=S,A=w),y};return r?i(u):u}function b(e,t,n){for(var r=0,i=t.length;i>r;r++)o(e,t[r],n);return n}function w(e,t,n,r){var i,s,o,u,a,f=c(e);if(!r&&1===f.length){if(s=f[0]=f[0].slice(0),s.length>2&&"ID"===(o=s[0]).type&&9===t.nodeType&&!D&&T.relative[s[1].type]){if(t=T.find.ID(o.matches[0].replace(wt,Et),t)[0],!t)return n;e=e.slice(s.shift().value.length)}for(i=ht.needsContext.test(e)?-1:s.length-1;i>=0&&(o=s[i],!T.relative[u=o.type]);i--)if((a=T.find[u])&&(r=a(o.matches[0].replace(wt,Et),pt.test(s[0].type)&&t.parentNode||t))){if(s.splice(i,1),e=r.length&&h(s),!e)return G.apply(n,Y.call(r,0)),n;break}}return k(e,f)(r,t,D,n,pt.test(e)),n}function E(){}var S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I="sizzle"+ -(new Date),q=e.document,R={},U=0,z=0,W=r(),X=r(),V=r(),$=typeof t,J=1<<31,K=[],Q=K.pop,G=K.push,Y=K.slice,Z=K.indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(this[t]===e)return t;return-1},et="[\\x20\\t\\r\\n\\f]",tt="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",nt=tt.replace("w","w#"),rt="([*^$|!~]?=)",it="\\["+et+"*("+tt+")"+et+"*(?:"+rt+et+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+nt+")|)|)"+et+"*\\]",st=":("+tt+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+it.replace(3,8)+")*)|.*)\\)|)",ot=RegExp("^"+et+"+|((?:^|[^\\\\])(?:\\\\.)*)"+et+"+$","g"),at=RegExp("^"+et+"*,"+et+"*"),ft=RegExp("^"+et+"*([\\x20\\t\\r\\n\\f>+~])"+et+"*"),lt=RegExp(st),ct=RegExp("^"+nt+"$"),ht={ID:RegExp("^#("+tt+")"),CLASS:RegExp("^\\.("+tt+")"),NAME:RegExp("^\\[name=['\"]?("+tt+")['\"]?\\]"),TAG:RegExp("^("+tt.replace("w","w*")+")"),ATTR:RegExp("^"+it),PSEUDO:RegExp("^"+st),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+et+"*(even|odd|(([+-]|)(\\d*)n|)"+et+"*(?:([+-]|)"+et+"*(\\d+)|))"+et+"*\\)|)","i"),needsContext:RegExp("^"+et+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+et+"*((?:-\\d)?\\d*)"+et+"*\\)|)(?=[^-]|$)","i")},pt=/[\x20\t\r\n\f]*[+~]/,dt=/\{\s*\[native code\]\s*\}/,vt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,mt=/^(?:input|select|textarea|button)$/i,gt=/^h\d$/i,yt=/'|\\/g,bt=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,wt=/\\([\da-fA-F]{1,6}[\x20\t\r\n\f]?|.)/g,Et=function(e,t){var n="0x"+t-65536;return n!==n?t:0>n?String.fromCharCode(n+65536):String.fromCharCode(55296|n>>10,56320|1023&n)};try{Y.call(_.childNodes,0)[0].nodeType}catch(St){Y=function(e){for(var t,n=[];t=this[e];e++)n.push(t);return n}}C=o.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},O=o.setDocument=function(e){var r=e?e.ownerDocument||e:q;return r!==M&&9===r.nodeType&&r.documentElement?(M=r,_=r.documentElement,D=C(r),R.tagNameNoComments=s(function(e){return e.appendChild(r.createComment("")),!e.getElementsByTagName("*").length}),R.attributes=s(function(e){e.innerHTML="<select></select>";var t=typeof e.lastChild.getAttribute("multiple");return"boolean"!==t&&"string"!==t}),R.getByClassName=s(function(e){return e.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",e.getElementsByClassName&&e.getElementsByClassName("e").length?(e.lastChild.className="e",2===e.getElementsByClassName("e").length):!1}),R.getByName=s(function(e){e.id=I+0,e.innerHTML="<a name='"+I+"'></a><div name='"+I+"'></div>",_.insertBefore(e,_.firstChild);var t=r.getElementsByName&&r.getElementsByName(I).length===2+r.getElementsByName(I+0).length;return R.getIdNotName=!r.getElementById(I),_.removeChild(e),t}),T.attrHandle=s(function(e){return e.innerHTML="<a href='#'></a>",e.firstChild&&typeof e.firstChild.getAttribute!==$&&"#"===e.firstChild.getAttribute("href")})?{}:{href:function(e){return e.getAttribute("href",2)},type:function(e){return e.getAttribute("type")}},R.getIdNotName?(T.find.ID=function(e,t){if(typeof t.getElementById!==$&&!D){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},T.filter.ID=function(e){var t=e.replace(wt,Et);return function(e){return e.getAttribute("id")===t}}):(T.find.ID=function(e,n){if(typeof n.getElementById!==$&&!D){var r=n.getElementById(e);return r?r.id===e||typeof r.getAttributeNode!==$&&r.getAttributeNode("id").value===e?[r]:t:[]}},T.filter.ID=function(e){var t=e.replace(wt,Et);return function(e){var n=typeof e.getAttributeNode!==$&&e.getAttributeNode("id");return n&&n.value===t}}),T.find.TAG=R.tagNameNoComments?function(e,n){return typeof n.getElementsByTagName!==$?n.getElementsByTagName(e):t}:function(e,t){var n,r=[],i=0,s=t.getElementsByTagName(e);if("*"===e){for(;n=s[i];i++)1===n.nodeType&&r.push(n);return r}return s},T.find.NAME=R.getByName&&function(e,n){return typeof n.getElementsByName!==$?n.getElementsByName(name):t},T.find.CLASS=R.getByClassName&&function(e,n){return typeof n.getElementsByClassName===$||D?t:n.getElementsByClassName(e)},H=[],P=[":focus"],(R.qsa=n(r.querySelectorAll))&&(s(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||P.push("\\["+et+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),e.querySelectorAll(":checked").length||P.push(":checked")}),s(function(e){e.innerHTML="<input type='hidden' i=''/>",e.querySelectorAll("[i^='']").length&&P.push("[*^$]="+et+"*(?:\"\"|'')"),e.querySelectorAll(":enabled").length||P.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),P.push(",.*:")})),(R.matchesSelector=n(B=_.matchesSelector||_.mozMatchesSelector||_.webkitMatchesSelector||_.oMatchesSelector||_.msMatchesSelector))&&s(function(e){R.disconnectedMatch=B.call(e,"div"),B.call(e,"[s!='']:x"),H.push("!=",st)}),P=RegExp(P.join("|")),H=RegExp(H.join("|")),j=n(_.contains)||_.compareDocumentPosition?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!!r&&1===r.nodeType&&!!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},F=_.compareDocumentPosition?function(e,t){var n;return e===t?(L=!0,0):(n=t.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(t))?1&n||e.parentNode&&11===e.parentNode.nodeType?e===r||j(q,e)?-1:t===r||j(q,t)?1:0:4&n?-1:1:e.compareDocumentPosition?-1:1}:function(e,t){var n,i=0,s=e.parentNode,o=t.parentNode,a=[e],f=[t];if(e===t)return L=!0,0;if(e.sourceIndex&&t.sourceIndex)return(~t.sourceIndex||J)-(j(q,e)&&~e.sourceIndex||J);if(!s||!o)return e===r?-1:t===r?1:s?-1:o?1:0;if(s===o)return u(e,t);for(n=e;n=n.parentNode;)a.unshift(n);for(n=t;n=n.parentNode;)f.unshift(n);for(;a[i]===f[i];)i++;return i?u(a[i],f[i]):a[i]===q?-1:f[i]===q?1:0},L=!1,[0,0].sort(F),R.detectDuplicates=L,M):M},o.matches=function(e,t){return o(e,null,null,t)},o.matchesSelector=function(e,t){if((e.ownerDocument||e)!==M&&O(e),t=t.replace(bt,"='$1']"),!(!R.matchesSelector||D||H&&H.test(t)||P.test(t)))try{var n=B.call(e,t);if(n||R.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(r){}return o(t,M,null,[e]).length>0},o.contains=function(e,t){return(e.ownerDocument||e)!==M&&O(e),j(e,t)},o.attr=function(e,t){var n;return(e.ownerDocument||e)!==M&&O(e),D||(t=t.toLowerCase()),(n=T.attrHandle[t])?n(e):D||R.attributes?e.getAttribute(t):((n=e.getAttributeNode(t))||e.getAttribute(t))&&e[t]===!0?t:n&&n.specified?n.value:null},o.error=function(e){throw Error("Syntax error, unrecognized expression: "+e)},o.uniqueSort=function(e){var t,n=[],r=1,i=0;if(L=!R.detectDuplicates,e.sort(F),L){for(;t=e[r];r++)t===e[r-1]&&(i=n.push(r));for(;i--;)e.splice(n[i],1)}return e},N=o.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=N(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r];r++)n+=N(t);return n},T=o.selectors={cacheLength:50,createPseudo:i,match:ht,find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(wt,Et),e[3]=(e[4]||e[5]||"").replace(wt,Et),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||o.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&o.error(e[0]),e},PSEUDO:function(e){var t,n=!e[5]&&e[2];return ht.CHILD.test(e[0])?null:(e[4]?e[2]=e[4]:n&&lt.test(n)&&(t=c(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){return"*"===e?function(){return!0}:(e=e.replace(wt,Et).toLowerCase(),function(t){return t.nodeName&&t.nodeName.toLowerCase()===e})},CLASS:function(e){var t=W[e+" "];return t||(t=RegExp("(^|"+et+")"+e+"("+et+"|$)"))&&W(e,function(e){return t.test(e.className||typeof e.getAttribute!==$&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var i=o.attr(r,e);return null==i?"!="===t:t?(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.substr(i.length-n.length)===n:"~="===t?(" "+i+" ").indexOf(n)>-1:"|="===t?i===n||i.substr(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r,i){var s="nth"!==e.slice(0,3),o="last"!==e.slice(-4),u="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,a){var f,l,c,h,p,d,v=s!==o?"nextSibling":"previousSibling",m=t.parentNode,g=u&&t.nodeName.toLowerCase(),y=!a&&!u;if(m){if(s){for(;v;){for(c=t;c=c[v];)if(u?c.nodeName.toLowerCase()===g:1===c.nodeType)return!1;d=v="only"===e&&!d&&"nextSibling"}return!0}if(d=[o?m.firstChild:m.lastChild],o&&y){for(l=m[I]||(m[I]={}),f=l[e]||[],p=f[0]===U&&f[1],h=f[0]===U&&f[2],c=p&&m.childNodes[p];c=++p&&c&&c[v]||(h=p=0)||d.pop();)if(1===c.nodeType&&++h&&c===t){l[e]=[U,p,h];break}}else if(y&&(f=(t[I]||(t[I]={}))[e])&&f[0]===U)h=f[1];else for(;(c=++p&&c&&c[v]||(h=p=0)||d.pop())&&((u?c.nodeName.toLowerCase()!==g:1!==c.nodeType)||!++h||(y&&((c[I]||(c[I]={}))[e]=[U,h]),c!==t)););return h-=i,h===r||0===h%r&&h/r>=0}}},PSEUDO:function(e,t){var n,r=T.pseudos[e]||T.setFilters[e.toLowerCase()]||o.error("unsupported pseudo: "+e);return r[I]?r(t):r.length>1?(n=[e,e,"",t],T.setFilters.hasOwnProperty(e.toLowerCase())?i(function(e,n){for(var i,s=r(e,t),o=s.length;o--;)i=Z.call(e,s[o]),e[i]=!(n[i]=s[o])}):function(e){return r(e,0,n)}):r}},pseudos:{not:i(function(e){var t=[],n=[],r=k(e.replace(ot,"$1"));return r[I]?i(function(e,t,n,i){for(var s,o=r(e,null,i,[]),u=e.length;u--;)(s=o[u])&&(e[u]=!(t[u]=s))}):function(e,i,s){return t[0]=e,r(t,null,s,n),!n.pop()}}),has:i(function(e){return function(t){return o(e,t).length>0}}),contains:i(function(e){return function(t){return(t.textContent||t.innerText||N(t)).indexOf(e)>-1}}),lang:i(function(e){return ct.test(e||"")||o.error("unsupported lang: "+e),e=e.replace(wt,Et).toLowerCase(),function(t){var n;do if(n=D?t.getAttribute("xml:lang")||t.getAttribute("lang"):t.lang)return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===_},focus:function(e){return e===M.activeElement&&(!M.hasFocus||M.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>"@"||3===e.nodeType||4===e.nodeType)return!1;return!0},parent:function(e){return!T.pseudos.empty(e)},header:function(e){return gt.test(e.nodeName)},input:function(e){return mt.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)},first:l(function(){return[0]}),last:l(function(e,t){return[t-1]}),eq:l(function(e,t,n){return[0>n?n+t:n]}),even:l(function(e,t){for(var n=0;t>n;n+=2)e.push(n);return e}),odd:l(function(e,t){for(var n=1;t>n;n+=2)e.push(n);return e}),lt:l(function(e,t,n){for(var r=0>n?n+t:n;--r>=0;)e.push(r);return e}),gt:l(function(e,t,n){for(var r=0>n?n+t:n;t>++r;)e.push(r);return e})}};for(S in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})T.pseudos[S]=a(S);for(S in{submit:!0,reset:!0})T.pseudos[S]=f(S);k=o.compile=function(e,t){var n,r=[],i=[],s=V[e+" "];if(!s){for(t||(t=c(e)),n=t.length;n--;)s=g(t[n]),s[I]?r.push(s):i.push(s);s=V(e,y(i,r))}return s},T.pseudos.nth=T.pseudos.eq,T.filters=E.prototype=T.pseudos,T.setFilters=new E,O(),o.attr=ut.attr,ut.find=o,ut.expr=o.selectors,ut.expr[":"]=ut.expr.pseudos,ut.unique=o.uniqueSort,ut.text=o.getText,ut.isXMLDoc=o.isXML,ut.contains=o.contains}(e);var It=/Until$/,qt=/^(?:parents|prev(?:Until|All))/,Rt=/^.[^:#\[\.,]*$/,Ut=ut.expr.match.needsContext,zt={children:!0,contents:!0,next:!0,prev:!0};ut.fn.extend({find:function(e){var t,n,r;if("string"!=typeof e)return r=this,this.pushStack(ut(e).filter(function(){for(t=0;r.length>t;t++)if(ut.contains(r[t],this))return!0}));for(n=[],t=0;this.length>t;t++)ut.find(e,this[t],n);return n=this.pushStack(ut.unique(n)),n.selector=(this.selector?this.selector+" ":"")+e,n},has:function(e){var t,n=ut(e,this),r=n.length;return this.filter(function(){for(t=0;r>t;t++)if(ut.contains(this,n[t]))return!0})},not:function(e){return this.pushStack(c(this,e,!1))},filter:function(e){return this.pushStack(c(this,e,!0))},is:function(e){return!!e&&("string"==typeof e?Ut.test(e)?ut(e,this.context).index(this[0])>=0:ut.filter(e,this).length>0:this.filter(e).length>0)},closest:function(e,t){for(var n,r=0,i=this.length,s=[],o=Ut.test(e)||"string"!=typeof e?ut(e,t||this.context):0;i>r;r++)for(n=this[r];n&&n.ownerDocument&&n!==t&&11!==n.nodeType;){if(o?o.index(n)>-1:ut.find.matchesSelector(n,e)){s.push(n);break}n=n.parentNode}return this.pushStack(s.length>1?ut.unique(s):s)},index:function(e){return e?"string"==typeof e?ut.inArray(this[0],ut(e)):ut.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var n="string"==typeof e?ut(e,t):ut.makeArray(e&&e.nodeType?[e]:e),r=ut.merge(this.get(),n);return this.pushStack(ut.unique(r))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),ut.fn.andSelf=ut.fn.addBack,ut.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return ut.dir(e,"parentNode")},parentsUntil:function(e,t,n){return ut.dir(e,"parentNode",n)},next:function(e){return l(e,"nextSibling")},prev:function(e){return l(e,"previousSibling")},nextAll:function(e){return ut.dir(e,"nextSibling")},prevAll:function(e){return ut.dir(e,"previousSibling")},nextUntil:function(e,t,n){return ut.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return ut.dir(e,"previousSibling",n)},siblings:function(e){return ut.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return ut.sibling(e.firstChild)},contents:function(e){return ut.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:ut.merge([],e.childNodes)}},function(e,t){ut.fn[e]=function(n,r){var i=ut.map(this,t,n);return It.test(e)||(r=n),r&&"string"==typeof r&&(i=ut.filter(r,i)),i=this.length>1&&!zt[e]?ut.unique(i):i,this.length>1&&qt.test(e)&&(i=i.reverse()),this.pushStack(i)}}),ut.extend({filter:function(e,t,n){return n&&(e=":not("+e+")"),1===t.length?ut.find.matchesSelector(t[0],e)?[t[0]]:[]:ut.find.matches(e,t)},dir:function(e,n,r){for(var i=[],s=e[n];s&&9!==s.nodeType&&(r===t||1!==s.nodeType||!ut(s).is(r));)1===s.nodeType&&i.push(s),s=s[n];return i},sibling:function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}});var Wt="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",Xt=/ jQuery\d+="(?:null|\d+)"/g,Vt=RegExp("<(?:"+Wt+")[\\s/>]","i"),$t=/^\s+/,Jt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Kt=/<([\w:]+)/,Qt=/<tbody/i,Gt=/<|&#?\w+;/,Yt=/<(?:script|style|link)/i,Zt=/^(?:checkbox|radio)$/i,en=/checked\s*(?:[^=]|=\s*.checked.)/i,tn=/^$|\/(?:java|ecma)script/i,nn=/^true\/(.*)/,rn=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,sn={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:ut.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},on=h($),un=on.appendChild($.createElement("div"));sn.optgroup=sn.option,sn.tbody=sn.tfoot=sn.colgroup=sn.caption=sn.thead,sn.th=sn.td,ut.fn.extend({text:function(e){return ut.access(this,function(e){return e===t?ut.text(this):this.empty().append((this[0]&&this[0].ownerDocument||$).createTextNode(e))},null,e,arguments.length)},wrapAll:function(e){if(ut.isFunction(e))return this.each(function(t){ut(this).wrapAll(e.call(this,t))});if(this[0]){var t=ut(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstChild&&1===e.firstChild.nodeType;)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return ut.isFunction(e)?this.each(function(t){ut(this).wrapInner(e.call(this,t))}):this.each(function(){var t=ut(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=ut.isFunction(e);return this.each(function(n){ut(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){ut.nodeName(this,"body")||ut(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(e){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&this.appendChild(e)})},prepend:function(){return this.domManip(arguments,!0,function(e){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&this.insertBefore(e,this.firstChild)})},before:function(){return this.domManip(arguments,!1,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,!1,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var n,r=0;null!=(n=this[r]);r++)(!e||ut.filter(e,[n]).length>0)&&(t||1!==n.nodeType||ut.cleanData(b(n)),n.parentNode&&(t&&ut.contains(n.ownerDocument,n)&&m(b(n,"script")),n.parentNode.removeChild(n)));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++){for(1===e.nodeType&&ut.cleanData(b(e,!1));e.firstChild;)e.removeChild(e.firstChild);e.options&&ut.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return ut.clone(this,e,t)})},html:function(e){return ut.access(this,function(e){var n=this[0]||{},r=0,i=this.length;if(e===t)return 1===n.nodeType?n.innerHTML.replace(Xt,""):t;if(!("string"!=typeof e||Yt.test(e)||!ut.support.htmlSerialize&&Vt.test(e)||!ut.support.leadingWhitespace&&$t.test(e)||sn[(Kt.exec(e)||["",""])[1].toLowerCase()])){e=e.replace(Jt,"<$1></$2>");try{for(;i>r;r++)n=this[r]||{},1===n.nodeType&&(ut.cleanData(b(n,!1)),n.innerHTML=e);n=0}catch(s){}}n&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(e){var t=ut.isFunction(e);return t||"string"==typeof e||(e=ut(e).not(this).detach()),this.domManip([e],!0,function(e){var t=this.nextSibling,n=this.parentNode;(n&&1===this.nodeType||11===this.nodeType)&&(ut(this).remove(),t?t.parentNode.insertBefore(e,t):n.appendChild(e))})},detach:function(e){return this.remove(e,!0)},domManip:function(e,n,r){e=et.apply([],e);var i,s,o,u,a,f,l=0,c=this.length,h=this,m=c-1,g=e[0],y=ut.isFunction(g);if(y||!(1>=c||"string"!=typeof g||ut.support.checkClone)&&en.test(g))return this.each(function(i){var s=h.eq(i);y&&(e[0]=g.call(this,i,n?s.html():t)),s.domManip(e,n,r)});if(c&&(i=ut.buildFragment(e,this[0].ownerDocument,!1,this),s=i.firstChild,1===i.childNodes.length&&(i=s),s)){for(n=n&&ut.nodeName(s,"tr"),o=ut.map(b(i,"script"),d),u=o.length;c>l;l++)a=i,l!==m&&(a=ut.clone(a,!0,!0),u&&ut.merge(o,b(a,"script"))),r.call(n&&ut.nodeName(this[l],"table")?p(this[l],"tbody"):this[l],a,l);if(u)for(f=o[o.length-1].ownerDocument,ut.map(o,v),l=0;u>l;l++)a=o[l],tn.test(a.type||"")&&!ut._data(a,"globalEval")&&ut.contains(f,a)&&(a.src?ut.ajax({url:a.src,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0}):ut.globalEval((a.text||a.textContent||a.innerHTML||"").replace(rn,"")));i=s=null}return this}}),ut.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){ut.fn[e]=function(e){for(var n,r=0,i=[],s=ut(e),o=s.length-1;o>=r;r++)n=r===o?this:this.clone(!0),ut(s[r])[t](n),tt.apply(i,n.get());return this.pushStack(i)}}),ut.extend({clone:function(e,t,n){var r,i,s,o,u,a=ut.contains(e.ownerDocument,e);if(ut.support.html5Clone||ut.isXMLDoc(e)||!Vt.test("<"+e.nodeName+">")?u=e.cloneNode(!0):(un.innerHTML=e.outerHTML,un.removeChild(u=un.firstChild)),!(ut.support.noCloneEvent&&ut.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||ut.isXMLDoc(e)))for(r=b(u),i=b(e),o=0;null!=(s=i[o]);++o)r[o]&&y(s,r[o]);if(t)if(n)for(i=i||b(e),r=r||b(u),o=0;null!=(s=i[o]);o++)g(s,r[o]);else g(e,u);return r=b(u,"script"),r.length>0&&m(r,!a&&b(e,"script")),r=i=s=null,u},buildFragment:function(e,t,n,r){for(var i,s,o,u,a,f,l,c=e.length,p=h(t),d=[],v=0;c>v;v++)if(s=e[v],s||0===s)if("object"===ut.type(s))ut.merge(d,s.nodeType?[s]:s);else if(Gt.test(s)){for(u=u||p.appendChild(t.createElement("div")),o=(Kt.exec(s)||["",""])[1].toLowerCase(),a=sn[o]||sn._default,u.innerHTML=a[1]+s.replace(Jt,"<$1></$2>")+a[2],l=a[0];l--;)u=u.lastChild;if(!ut.support.leadingWhitespace&&$t.test(s)&&d.push(t.createTextNode($t.exec(s)[0])),!ut.support.tbody)for(s="table"!==o||Qt.test(s)?"<table>"!==a[1]||Qt.test(s)?0:u:u.firstChild,l=s&&s.childNodes.length;l--;)ut.nodeName(f=s.childNodes[l],"tbody")&&!f.childNodes.length&&s.removeChild(f);for(ut.merge(d,u.childNodes),u.textContent="";u.firstChild;)u.removeChild(u.firstChild);u=p.lastChild}else d.push(t.createTextNode(s));for(u&&p.removeChild(u),ut.support.appendChecked||ut.grep(b(d,"input"),w),v=0;s=d[v++];)if((!r||-1===ut.inArray(s,r))&&(i=ut.contains(s.ownerDocument,s),u=b(p.appendChild(s),"script"),i&&m(u),n))for(l=0;s=u[l++];)tn.test(s.type||"")&&n.push(s);return u=null,p},cleanData:function(e,n){for(var r,i,s,o,u=0,a=ut.expando,f=ut.cache,l=ut.support.deleteExpando,c=ut.event.special;null!=(s=e[u]);u++)if((n||ut.acceptData(s))&&(i=s[a],r=i&&f[i])){if(r.events)for(o in r.events)c[o]?ut.event.remove(s,o):ut.removeEvent(s,o,r.handle);f[i]&&(delete f[i],l?delete s[a]:s.removeAttribute!==t?s.removeAttribute(a):s[a]=null,Y.push(i))}}});var an,fn,ln,cn=/alpha\([^)]*\)/i,hn=/opacity\s*=\s*([^)]*)/,pn=/^(top|right|bottom|left)$/,dn=/^(none|table(?!-c[ea]).+)/,vn=/^margin/,mn=RegExp("^("+at+")(.*)$","i"),gn=RegExp("^("+at+")(?!px)[a-z%]+$","i"),yn=RegExp("^([+-])=("+at+")","i"),bn={BODY:"block"},wn={position:"absolute",visibility:"hidden",display:"block"},En={letterSpacing:0,fontWeight:400},Sn=["Top","Right","Bottom","Left"],xn=["Webkit","O","Moz","ms"];ut.fn.extend({css:function(e,n){return ut.access(this,function(e,n,r){var i,s,o={},u=0;if(ut.isArray(n)){for(i=fn(e),s=n.length;s>u;u++)o[n[u]]=ut.css(e,n[u],!1,i);return o}return r!==t?ut.style(e,n,r):ut.css(e,n)},e,n,arguments.length>1)},show:function(){return x(this,!0)},hide:function(){return x(this)},toggle:function(e){var t="boolean"==typeof e;return this.each(function(){(t?e:S(this))?ut(this).show():ut(this).hide()})}}),ut.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=an(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":ut.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,n,r,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var s,o,u,a=ut.camelCase(n),f=e.style;if(n=ut.cssProps[a]||(ut.cssProps[a]=E(f,a)),u=ut.cssHooks[n]||ut.cssHooks[a],r===t)return u&&"get"in u&&(s=u.get(e,!1,i))!==t?s:f[n];if(o=typeof r,"string"===o&&(s=yn.exec(r))&&(r=(s[1]+1)*s[2]+parseFloat(ut.css(e,n)),o="number"),!(null==r||"number"===o&&isNaN(r)||("number"!==o||ut.cssNumber[a]||(r+="px"),ut.support.clearCloneStyle||""!==r||0!==n.indexOf("background")||(f[n]="inherit"),u&&"set"in u&&(r=u.set(e,r,i))===t)))try{f[n]=r}catch(l){}}},css:function(e,n,r,i){var s,o,u,a=ut.camelCase(n);return n=ut.cssProps[a]||(ut.cssProps[a]=E(e.style,a)),u=ut.cssHooks[n]||ut.cssHooks[a],u&&"get"in u&&(s=u.get(e,!0,r)),s===t&&(s=an(e,n,i)),"normal"===s&&n in En&&(s=En[n]),r?(o=parseFloat(s),r===!0||ut.isNumeric(o)?o||0:s):s},swap:function(e,t,n,r){var i,s,o={};for(s in t)o[s]=e.style[s],e.style[s]=t[s];i=n.apply(e,r||[]);for(s in t)e.style[s]=o[s];return i}}),e.getComputedStyle?(fn=function(t){return e.getComputedStyle(t,null)},an=function(e,n,r){var i,s,o,u=r||fn(e),a=u?u.getPropertyValue(n)||u[n]:t,f=e.style;return u&&(""!==a||ut.contains(e.ownerDocument,e)||(a=ut.style(e,n)),gn.test(a)&&vn.test(n)&&(i=f.width,s=f.minWidth,o=f.maxWidth,f.minWidth=f.maxWidth=f.width=a,a=u.width,f.width=i,f.minWidth=s,f.maxWidth=o)),a}):$.documentElement.currentStyle&&(fn=function(e){return e.currentStyle},an=function(e,n,r){var i,s,o,u=r||fn(e),a=u?u[n]:t,f=e.style;return null==a&&f&&f[n]&&(a=f[n]),gn.test(a)&&!pn.test(n)&&(i=f.left,s=e.runtimeStyle,o=s&&s.left,o&&(s.left=e.currentStyle.left),f.left="fontSize"===n?"1em":a,a=f.pixelLeft+"px",f.left=i,o&&(s.left=o)),""===a?"auto":a}),ut.each(["height","width"],function(e,n){ut.cssHooks[n]={get:function(e,r,i){return r?0===e.offsetWidth&&dn.test(ut.css(e,"display"))?ut.swap(e,wn,function(){return C(e,n,i)}):C(e,n,i):t},set:function(e,t,r){var i=r&&fn(e);return T(e,t,r?N(e,n,r,ut.support.boxSizing&&"border-box"===ut.css(e,"boxSizing",!1,i),i):0)}}}),ut.support.opacity||(ut.cssHooks.opacity={get:function(e,t){return hn.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,r=e.currentStyle,i=ut.isNumeric(t)?"alpha(opacity="+100*t+")":"",s=r&&r.filter||n.filter||"";n.zoom=1,(t>=1||""===t)&&""===ut.trim(s.replace(cn,""))&&n.removeAttribute&&(n.removeAttribute("filter"),""===t||r&&!r.filter)||(n.filter=cn.test(s)?s.replace(cn,i):s+" "+i)}}),ut(function(){ut.support.reliableMarginRight||(ut.cssHooks.marginRight={get:function(e,n){return n?ut.swap(e,{display:"inline-block"},an,[e,"marginRight"]):t}}),!ut.support.pixelPosition&&ut.fn.position&&ut.each(["top","left"],function(e,n){ut.cssHooks[n]={get:function(e,r){return r?(r=an(e,n),gn.test(r)?ut(e).position()[n]+"px":r):t}}})}),ut.expr&&ut.expr.filters&&(ut.expr.filters.hidden=function(e){return 0===e.offsetWidth&&0===e.offsetHeight||!ut.support.reliableHiddenOffsets&&"none"===(e.style&&e.style.display||ut.css(e,"display"))},ut.expr.filters.visible=function(e){return!ut.expr.filters.hidden(e)}),ut.each({margin:"",padding:"",border:"Width"},function(e,t){ut.cssHooks[e+t]={expand:function(n){for(var r=0,i={},s="string"==typeof n?n.split(" "):[n];4>r;r++)i[e+Sn[r]+t]=s[r]||s[r-2]||s[0];return i}},vn.test(e)||(ut.cssHooks[e+t].set=T)});var Tn=/%20/g,Nn=/\[\]$/,Cn=/\r?\n/g,kn=/^(?:submit|button|image|reset)$/i,Ln=/^(?:input|select|textarea|keygen)/i;ut.fn.extend({serialize:function(){return ut.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=ut.prop(this,"elements");return e?ut.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!ut(this).is(":disabled")&&Ln.test(this.nodeName)&&!kn.test(e)&&(this.checked||!Zt.test(e))}).map(function(e,t){var n=ut(this).val();return null==n?null:ut.isArray(n)?ut.map(n,function(e){return{name:t.name,value:e.replace(Cn,"\r\n")}}):{name:t.name,value:n.replace(Cn,"\r\n")}}).get()}}),ut.param=function(e,n){var r,i=[],s=function(e,t){t=ut.isFunction(t)?t():null==t?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(n===t&&(n=ut.ajaxSettings&&ut.ajaxSettings.traditional),ut.isArray(e)||e.jquery&&!ut.isPlainObject(e))ut.each(e,function(){s(this.name,this.value)});else for(r in e)A(r,e[r],n,s);return i.join("&").replace(Tn,"+")};var An,On,Mn=ut.now(),_n=/\?/,Dn=/#.*$/,Pn=/([?&])_=[^&]*/,Hn=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Bn=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,jn=/^(?:GET|HEAD)$/,Fn=/^\/\//,In=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,qn=ut.fn.load,Rn={},Un={},zn="*/".concat("*");try{On=J.href}catch(Wn){On=$.createElement("a"),On.href="",On=On.href}An=In.exec(On.toLowerCase())||[],ut.fn.load=function(e,n,r){if("string"!=typeof e&&qn)return qn.apply(this,arguments);var i,s,o,u=this,a=e.indexOf(" ");return a>=0&&(i=e.slice(a,e.length),e=e.slice(0,a)),ut.isFunction(n)?(r=n,n=t):n&&"object"==typeof n&&(s="POST"),u.length>0&&ut.ajax({url:e,type:s,dataType:"html",data:n}).done(function(e){o=arguments,u.html(i?ut("<div>").append(ut.parseHTML(e)).find(i):e)}).complete(r&&function(e,t){u.each(r,o||[e.responseText,t,e])}),this},ut.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){ut.fn[t]=function(e){return this.on(t,e)}}),ut.each(["get","post"],function(e,n){ut[n]=function(e,r,i,s){return ut.isFunction(r)&&(s=s||i,i=r,r=t),ut.ajax({url:e,type:n,dataType:s,data:r,success:i})}}),ut.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:On,type:"GET",isLocal:Bn.test(An[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":zn,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":e.String,"text html":!0,"text json":ut.parseJSON,"text xml":ut.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?_(_(e,ut.ajaxSettings),t):_(ut.ajaxSettings,e)},ajaxPrefilter:O(Rn),ajaxTransport:O(Un),ajax:function(e,n){function r(e,n,r,u){var f,c,y,b,E,x=n;2!==w&&(w=2,a&&clearTimeout(a),i=t,o=u||"",S.readyState=e>0?4:0,r&&(b=D(h,S,r)),e>=200&&300>e||304===e?(h.ifModified&&(E=S.getResponseHeader("Last-Modified"),E&&(ut.lastModified[s]=E),E=S.getResponseHeader("etag"),E&&(ut.etag[s]=E)),304===e?(f=!0,x="notmodified"):(f=P(h,b),x=f.state,c=f.data,y=f.error,f=!y)):(y=x,(e||!x)&&(x="error",0>e&&(e=0))),S.status=e,S.statusText=(n||x)+"",f?v.resolveWith(p,[c,x,S]):v.rejectWith(p,[S,x,y]),S.statusCode(g),g=t,l&&d.trigger(f?"ajaxSuccess":"ajaxError",[S,h,f?c:y]),m.fireWith(p,[S,x]),l&&(d.trigger("ajaxComplete",[S,h]),--ut.active||ut.event.trigger("ajaxStop")))}"object"==typeof e&&(n=e,e=t),n=n||{};var i,s,o,u,a,f,l,c,h=ut.ajaxSetup({},n),p=h.context||h,d=h.context&&(p.nodeType||p.jquery)?ut(p):ut.event,v=ut.Deferred(),m=ut.Callbacks("once memory"),g=h.statusCode||{},y={},b={},w=0,E="canceled",S={readyState:0,getResponseHeader:function(e){var t;if(2===w){if(!u)for(u={};t=Hn.exec(o);)u[t[1].toLowerCase()]=t[2];t=u[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===w?o:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return w||(e=b[n]=b[n]||e,y[e]=t),this},overrideMimeType:function(e){return w||(h.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>w)for(t in e)g[t]=[g[t],e[t]];else S.always(e[S.status]);return this},abort:function(e){var t=e||E;return i&&i.abort(t),r(0,t),this}};if(v.promise(S).complete=m.add,S.success=S.done,S.error=S.fail,h.url=((e||h.url||On)+"").replace(Dn,"").replace(Fn,An[1]+"//"),h.type=n.method||n.type||h.method||h.type,h.dataTypes=ut.trim(h.dataType||"*").toLowerCase().match(ft)||[""],null==h.crossDomain&&(f=In.exec(h.url.toLowerCase()),h.crossDomain=!(!f||f[1]===An[1]&&f[2]===An[2]&&(f[3]||("http:"===f[1]?80:443))==(An[3]||("http:"===An[1]?80:443)))),h.data&&h.processData&&"string"!=typeof h.data&&(h.data=ut.param(h.data,h.traditional)),M(Rn,h,n,S),2===w)return S;l=h.global,l&&0===ut.active++&&ut.event.trigger("ajaxStart"),h.type=h.type.toUpperCase(),h.hasContent=!jn.test(h.type),s=h.url,h.hasContent||(h.data&&(s=h.url+=(_n.test(s)?"&":"?")+h.data,delete h.data),h.cache===!1&&(h.url=Pn.test(s)?s.replace(Pn,"$1_="+Mn++):s+(_n.test(s)?"&":"?")+"_="+Mn++)),h.ifModified&&(ut.lastModified[s]&&S.setRequestHeader("If-Modified-Since",ut.lastModified[s]),ut.etag[s]&&S.setRequestHeader("If-None-Match",ut.etag[s])),(h.data&&h.hasContent&&h.contentType!==!1||n.contentType)&&S.setRequestHeader("Content-Type",h.contentType),S.setRequestHeader("Accept",h.dataTypes[0]&&h.accepts[h.dataTypes[0]]?h.accepts[h.dataTypes[0]]+("*"!==h.dataTypes[0]?", "+zn+"; q=0.01":""):h.accepts["*"]);for(c in h.headers)S.setRequestHeader(c,h.headers[c]);if(!h.beforeSend||h.beforeSend.call(p,S,h)!==!1&&2!==w){E="abort";for(c in{success:1,error:1,complete:1})S[c](h[c]);if(i=M(Un,h,n,S)){S.readyState=1,l&&d.trigger("ajaxSend",[S,h]),h.async&&h.timeout>0&&(a=setTimeout(function(){S.abort("timeout")},h.timeout));try{w=1,i.send(y,r)}catch(x){if(!(2>w))throw x;r(-1,x)}}else r(-1,"No Transport");return S}return S.abort()},getScript:function(e,n){return ut.get(e,t,n,"script")},getJSON:function(e,t,n){return ut.get(e,t,n,"json")}}),ut.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return ut.globalEval(e),e}}}),ut.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),ut.ajaxTransport("script",function(e){if(e.crossDomain){var n,r=$.head||ut("head")[0]||$.documentElement;return{send:function(t,i){n=$.createElement("script"),n.async=!0,e.scriptCharset&&(n.charset=e.scriptCharset),n.src=e.url,n.onload=n.onreadystatechange=function(e,t){(t||!n.readyState||/loaded|complete/.test(n.readyState))&&(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),n=null,t||i(200,"success"))},r.insertBefore(n,r.firstChild)},abort:function(){n&&n.onload(t,!0)}}}});var Xn=[],Vn=/(=)\?(?=&|$)|\?\?/;ut.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Xn.pop()||ut.expando+"_"+Mn++;return this[e]=!0,e}}),ut.ajaxPrefilter("json jsonp",function(n,r,i){var s,o,u,a=n.jsonp!==!1&&(Vn.test(n.url)?"url":"string"==typeof n.data&&!(n.contentType||"").indexOf("application/x-www-form-urlencoded")&&Vn.test(n.data)&&"data");return a||"jsonp"===n.dataTypes[0]?(s=n.jsonpCallback=ut.isFunction(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,a?n[a]=n[a].replace(Vn,"$1"+s):n.jsonp!==!1&&(n.url+=(_n.test(n.url)?"&":"?")+n.jsonp+"="+s),n.converters["script json"]=function(){return u||ut.error(s+" was not called"),u[0]},n.dataTypes[0]="json",o=e[s],e[s]=function(){u=arguments},i.always(function(){e[s]=o,n[s]&&(n.jsonpCallback=r.jsonpCallback,Xn.push(s)),u&&ut.isFunction(o)&&o(u[0]),u=o=t}),"script"):t});var $n,Jn,Kn=0,Qn=e.ActiveXObject&&function(){var e;for(e in $n)$n[e](t,!0)};ut.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&H()||B()}:H,Jn=ut.ajaxSettings.xhr(),ut.support.cors=!!Jn&&"withCredentials"in Jn,Jn=ut.support.ajax=!!Jn,Jn&&ut.ajaxTransport(function(n){if(!n.crossDomain||ut.support.cors){var r;return{send:function(i,s){var o,u,a=n.xhr();if(n.username?a.open(n.type,n.url,n.async,n.username,n.password):a.open(n.type,n.url,n.async),n.xhrFields)for(u in n.xhrFields)a[u]=n.xhrFields[u];n.mimeType&&a.overrideMimeType&&a.overrideMimeType(n.mimeType),n.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");try{for(u in i)a.setRequestHeader(u,i[u])}catch(f){}a.send(n.hasContent&&n.data||null),r=function(e,i){var u,f,l,c,h;try{if(r&&(i||4===a.readyState))if(r=t,o&&(a.onreadystatechange=ut.noop,Qn&&delete $n[o]),i)4!==a.readyState&&a.abort();else{c={},u=a.status,h=a.responseXML,l=a.getAllResponseHeaders(),h&&h.documentElement&&(c.xml=h),"string"==typeof a.responseText&&(c.text=a.responseText);try{f=a.statusText}catch(p){f=""}u||!n.isLocal||n.crossDomain?1223===u&&(u=204):u=c.text?200:404}}catch(d){i||s(-1,d)}c&&s(u,f,c,l)},n.async?4===a.readyState?setTimeout(r):(o=++Kn,Qn&&($n||($n={},ut(e).unload(Qn)),$n[o]=r),a.onreadystatechange=r):r()},abort:function(){r&&r(t,!0)}}}});var Gn,Yn,Zn=/^(?:toggle|show|hide)$/,er=RegExp("^(?:([+-])=|)("+at+")([a-z%]*)$","i"),tr=/queueHooks$/,nr=[R],rr={"*":[function(e,t){var n,r,i=this.createTween(e,t),s=er.exec(t),o=i.cur(),u=+o||0,a=1,f=20;if(s){if(n=+s[2],r=s[3]||(ut.cssNumber[e]?"":"px"),"px"!==r&&u){u=ut.css(i.elem,e,!0)||n||1;do a=a||".5",u/=a,ut.style(i.elem,e,u+r);while(a!==(a=i.cur()/o)&&1!==a&&--f)}i.unit=r,i.start=u,i.end=s[1]?u+(s[1]+1)*n:n}return i}]};ut.Animation=ut.extend(I,{tweener:function(e,t){ut.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var n,r=0,i=e.length;i>r;r++)n=e[r],rr[n]=rr[n]||[],rr[n].unshift(t)},prefilter:function(e,t){t?nr.unshift(e):nr.push(e)}}),ut.Tween=U,U.prototype={constructor:U,init:function(e,t,n,r,i,s){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=s||(ut.cssNumber[n]?"":"px")},cur:function(){var e=U.propHooks[this.prop];return e&&e.get?e.get(this):U.propHooks._default.get(this)},run:function(e){var t,n=U.propHooks[this.prop];return this.pos=t=this.options.duration?ut.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):U.propHooks._default.set(this),this}},U.prototype.init.prototype=U.prototype,U.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=ut.css(e.elem,e.prop,"auto"),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){ut.fx.step[e.prop]?ut.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[ut.cssProps[e.prop]]||ut.cssHooks[e.prop])?ut.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},U.propHooks.scrollTop=U.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},ut.each(["toggle","show","hide"],function(e,t){var n=ut.fn[t];ut.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(z(t,!0),e,r,i)}}),ut.fn.extend({fadeTo:function(e,t,n,r){return this.filter(S).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=ut.isEmptyObject(e),s=ut.speed(t,n,r),o=function(){var t=I(this,ut.extend({},e),s);o.finish=function(){t.stop(!0)},(i||ut._data(this,"finish"))&&t.stop(!0)};return o.finish=o,i||s.queue===!1?this.each(o):this.queue(s.queue,o)},stop:function(e,n,r){var i=function(e){var t=e.stop;delete e.stop,t(r)};return"string"!=typeof e&&(r=n,n=e,e=t),n&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,n=null!=e&&e+"queueHooks",s=ut.timers,o=ut._data(this);if(n)o[n]&&o[n].stop&&i(o[n]);else for(n in o)o[n]&&o[n].stop&&tr.test(n)&&i(o[n]);for(n=s.length;n--;)s[n].elem!==this||null!=e&&s[n].queue!==e||(s[n].anim.stop(r),t=!1,s.splice(n,1));(t||!r)&&ut.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=ut._data(this),r=n[e+"queue"],i=n[e+"queueHooks"],s=ut.timers,o=r?r.length:0;for(n.finish=!0,ut.queue(this,e,[]),i&&i.cur&&i.cur.finish&&i.cur.finish.call(this),t=s.length;t--;)s[t].elem===this&&s[t].queue===e&&(s[t].anim.stop(!0),s.splice(t,1));for(t=0;o>t;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}}),ut.each({slideDown:z("show"),slideUp:z("hide"),slideToggle:z("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){ut.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),ut.speed=function(e,t,n){var r=e&&"object"==typeof e?ut.extend({},e):{complete:n||!n&&t||ut.isFunction(e)&&e,duration:e,easing:n&&t||t&&!ut.isFunction(t)&&t};return r.duration=ut.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in ut.fx.speeds?ut.fx.speeds[r.duration]:ut.fx.speeds._default,(null==r.queue||r.queue===!0)&&(r.queue="fx"),r.old=r.complete,r.complete=function(){ut.isFunction(r.old)&&r.old.call(this),r.queue&&ut.dequeue(this,r.queue)},r},ut.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},ut.timers=[],ut.fx=U.prototype.init,ut.fx.tick=function(){var e,n=ut.timers,r=0;for(Gn=ut.now();n.length>r;r++)e=n[r],e()||n[r]!==e||n.splice(r--,1);n.length||ut.fx.stop(),Gn=t},ut.fx.timer=function(e){e()&&ut.timers.push(e)&&ut.fx.start()},ut.fx.interval=13,ut.fx.start=function(){Yn||(Yn=setInterval(ut.fx.tick,ut.fx.interval))},ut.fx.stop=function(){clearInterval(Yn),Yn=null},ut.fx.speeds={slow:600,fast:200,_default:400},ut.fx.step={},ut.expr&&ut.expr.filters&&(ut.expr.filters.animated=function(e){return ut.grep(ut.timers,function(t){return e===t.elem}).length}),ut.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){ut.offset.setOffset(this,e,t)});var n,r,i={top:0,left:0},s=this[0],o=s&&s.ownerDocument;if(o)return n=o.documentElement,ut.contains(n,s)?(s.getBoundingClientRect!==t&&(i=s.getBoundingClientRect()),r=W(o),{top:i.top+(r.pageYOffset||n.scrollTop)-(n.clientTop||0),left:i.left+(r.pageXOffset||n.scrollLeft)-(n.clientLeft||0)}):i},ut.offset={setOffset:function(e,t,n){var r=ut.css(e,"position");"static"===r&&(e.style.position="relative");var i,s,o=ut(e),u=o.offset(),a=ut.css(e,"top"),f=ut.css(e,"left"),l=("absolute"===r||"fixed"===r)&&ut.inArray("auto",[a,f])>-1,c={},h={};l?(h=o.position(),i=h.top,s=h.left):(i=parseFloat(a)||0,s=parseFloat(f)||0),ut.isFunction(t)&&(t=t.call(e,n,u)),null!=t.top&&(c.top=t.top-u.top+i),null!=t.left&&(c.left=t.left-u.left+s),"using"in t?t.using.call(e,c):o.css(c)}},ut.fn.extend({position:function(){if(this[0]){var e,t,n={top:0,left:0},r=this[0];return"fixed"===ut.css(r,"position")?t=r.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),ut.nodeName(e[0],"html")||(n=e.offset()),n.top+=ut.css(e[0],"borderTopWidth",!0),n.left+=ut.css(e[0],"borderLeftWidth",!0)),{top:t.top-n.top-ut.css(r,"marginTop",!0),left:t.left-n.left-ut.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||$.documentElement;e&&!ut.nodeName(e,"html")&&"static"===ut.css(e,"position");)e=e.offsetParent;return e||$.documentElement})}}),ut.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,n){var r=/Y/.test(n);ut.fn[e]=function(i){return ut.access(this,function(e,i,s){var o=W(e);return s===t?o?n in o?o[n]:o.document.documentElement[i]:e[i]:(o?o.scrollTo(r?ut(o).scrollLeft():s,r?s:ut(o).scrollTop()):e[i]=s,t)},e,i,arguments.length,null)}}),ut.each({Height:"height",Width:"width"},function(e,n){ut.each({padding:"inner"+e,content:n,"":"outer"+e},function(r,i){ut.fn[i]=function(i,s){var o=arguments.length&&(r||"boolean"!=typeof i),u=r||(i===!0||s===!0?"margin":"border");return ut.access(this,function(n,r,i){var s;return ut.isWindow(n)?n.document.documentElement["client"+e]:9===n.nodeType?(s=n.documentElement,Math.max(n.body["scroll"+e],s["scroll"+e],n.body["offset"+e],s["offset"+e],s["client"+e])):i===t?ut.css(n,r,u):ut.style(n,r,i,u)},n,o?i:t,o,null)}})}),e.jQuery=e.$=ut,"function"==typeof define&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return ut})}(window),function(){var e=this,t=e._,n={},r=Array.prototype,i=Object.prototype,s=Function.prototype,o=r.push,u=r.slice,a=r.concat,f=i.toString,l=i.hasOwnProperty,c=r.forEach,h=r.map,p=r.reduce,d=r.reduceRight,v=r.filter,m=r.every,g=r.some,y=r.indexOf,b=r.lastIndexOf,w=Array.isArray,E=Object.keys,S=s.bind,x=function(e){return e instanceof x?e:this instanceof x?(this._wrapped=e,void 0):new x(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=x),exports._=x):e._=x,x.VERSION="1.4.3";var T=x.each=x.forEach=function(e,t,r){if(null!=e)if(c&&e.forEach===c)e.forEach(t,r);else if(e.length===+e.length){for(var i=0,s=e.length;s>i;i++)if(t.call(r,e[i],i,e)===n)return}else for(var o in e)if(x.has(e,o)&&t.call(r,e[o],o,e)===n)return};x.map=x.collect=function(e,t,n){var r=[];return null==e?r:h&&e.map===h?e.map(t,n):(T(e,function(e,i,s){r[r.length]=t.call(n,e,i,s)}),r)};var N="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(e,t,n,r){var i=arguments.length>2;if(null==e&&(e=[]),p&&e.reduce===p)return r&&(t=x.bind(t,r)),i?e.reduce(t,n):e.reduce(t);if(T(e,function(e,s,o){i?n=t.call(r,n,e,s,o):(n=e,i=!0)}),!i)throw new TypeError(N);return n},x.reduceRight=x.foldr=function(e,t,n,r){var i=arguments.length>2;if(null==e&&(e=[]),d&&e.reduceRight===d)return r&&(t=x.bind(t,r)),i?e.reduceRight(t,n):e.reduceRight(t);var s=e.length;if(s!==+s){var o=x.keys(e);s=o.length}if(T(e,function(u,a,f){a=o?o[--s]:--s,i?n=t.call(r,n,e[a],a,f):(n=e[a],i=!0)}),!i)throw new TypeError(N);return n},x.find=x.detect=function(e,t,n){var r;return C(e,function(e,i,s){return t.call(n,e,i,s)?(r=e,!0):void 0}),r},x.filter=x.select=function(e,t,n){var r=[];return null==e?r:v&&e.filter===v?e.filter(t,n):(T(e,function(e,i,s){t.call(n,e,i,s)&&(r[r.length]=e)}),r)},x.reject=function(e,t,n){return x.filter(e,function(e,r,i){return!t.call(n,e,r,i)},n)},x.every=x.all=function(e,t,r){t||(t=x.identity);var i=!0;return null==e?i:m&&e.every===m?e.every(t,r):(T(e,function(e,s,o){return(i=i&&t.call(r,e,s,o))?void 0:n}),!!i)};var C=x.some=x.any=function(e,t,r){t||(t=x.identity);var i=!1;return null==e?i:g&&e.some===g?e.some(t,r):(T(e,function(e,s,o){return i||(i=t.call(r,e,s,o))?n:void 0}),!!i)};x.contains=x.include=function(e,t){return null==e?!1:y&&e.indexOf===y?-1!=e.indexOf(t):C(e,function(e){return e===t})},x.invoke=function(e,t){var n=u.call(arguments,2);return x.map(e,function(e){return(x.isFunction(t)?t:e[t]).apply(e,n)})},x.pluck=function(e,t){return x.map(e,function(e){return e[t]})},x.where=function(e,t){return x.isEmpty(t)?[]:x.filter(e,function(e){for(var n in t)if(t[n]!==e[n])return!1;return!0})},x.max=function(e,t,n){if(!t&&x.isArray(e)&&e[0]===+e[0]&&65535>e.length)return Math.max.apply(Math,e);if(!t&&x.isEmpty(e))return-1/0;var r={computed:-1/0,value:-1/0};return T(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o>=r.computed&&(r={value:e,computed:o})}),r.value},x.min=function(e,t,n){if(!t&&x.isArray(e)&&e[0]===+e[0]&&65535>e.length)return Math.min.apply(Math,e);if(!t&&x.isEmpty(e))return 1/0;var r={computed:1/0,value:1/0};return T(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;r.computed>o&&(r={value:e,computed:o})}),r.value},x.shuffle=function(e){var t,n=0,r=[];return T(e,function(e){t=x.random(n++),r[n-1]=r[t],r[t]=e}),r};var k=function(e){return x.isFunction(e)?e:function(t){return t[e]}};x.sortBy=function(e,t,n){var r=k(t);return x.pluck(x.map(e,function(e,t,i){return{value:e,index:t,criteria:r.call(n,e,t,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(r>n||void 0===r)return-1}return e.index<t.index?-1:1}),"value")};var L=function(e,t,n,r){var i={},s=k(t||x.identity);return T(e,function(t,o){var u=s.call(n,t,o,e);r(i,u,t)}),i};x.groupBy=function(e,t,n){return L(e,t,n,function(e,t,n){(x.has(e,t)?e[t]:e[t]=[]).push(n)})},x.countBy=function(e,t,n){return L(e,t,n,function(e,t){x.has(e,t)||(e[t]=0),e[t]++})},x.sortedIndex=function(e,t,n,r){n=null==n?x.identity:k(n);for(var i=n.call(r,t),s=0,o=e.length;o>s;){var u=s+o>>>1;i>n.call(r,e[u])?s=u+1:o=u}return s},x.toArray=function(e){return e?x.isArray(e)?u.call(e):e.length===+e.length?x.map(e,x.identity):x.values(e):[]},x.size=function(e){return null==e?0:e.length===+e.length?e.length:x.keys(e).length},x.first=x.head=x.take=function(e,t,n){return null==e?void 0:null==t||n?e[0]:u.call(e,0,t)},x.initial=function(e,t,n){return u.call(e,0,e.length-(null==t||n?1:t))},x.last=function(e,t,n){return null==e?void 0:null==t||n?e[e.length-1]:u.call(e,Math.max(e.length-t,0))},x.rest=x.tail=x.drop=function(e,t,n){return u.call(e,null==t||n?1:t)},x.compact=function(e){return x.filter(e,x.identity)};var A=function(e,t,n){return T(e,function(e){x.isArray(e)?t?o.apply(n,e):A(e,t,n):n.push(e)}),n};x.flatten=function(e,t){return A(e,t,[])},x.without=function(e){return x.difference(e,u.call(arguments,1))},x.uniq=x.unique=function(e,t,n,r){x.isFunction(t)&&(r=n,n=t,t=!1);var i=n?x.map(e,n,r):e,s=[],o=[];return T(i,function(n,r){(t?r&&o[o.length-1]===n:x.contains(o,n))||(o.push(n),s.push(e[r]))}),s},x.union=function(){return x.uniq(a.apply(r,arguments))},x.intersection=function(e){var t=u.call(arguments,1);return x.filter(x.uniq(e),function(e){return x.every(t,function(t){return x.indexOf(t,e)>=0})})},x.difference=function(e){var t=a.apply(r,u.call(arguments,1));return x.filter(e,function(e){return!x.contains(t,e)})},x.zip=function(){for(var e=u.call(arguments),t=x.max(x.pluck(e,"length")),n=Array(t),r=0;t>r;r++)n[r]=x.pluck(e,""+r);return n},x.object=function(e,t){if(null==e)return{};for(var n={},r=0,i=e.length;i>r;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},x.indexOf=function(e,t,n){if(null==e)return-1;var r=0,i=e.length;if(n){if("number"!=typeof n)return r=x.sortedIndex(e,t),e[r]===t?r:-1;r=0>n?Math.max(0,i+n):n}if(y&&e.indexOf===y)return e.indexOf(t,n);for(;i>r;r++)if(e[r]===t)return r;return-1},x.lastIndexOf=function(e,t,n){if(null==e)return-1;var r=null!=n;if(b&&e.lastIndexOf===b)return r?e.lastIndexOf(t,n):e.lastIndexOf(t);for(var i=r?n:e.length;i--;)if(e[i]===t)return i;return-1},x.range=function(e,t,n){1>=arguments.length&&(t=e||0,e=0),n=arguments[2]||1;for(var r=Math.max(Math.ceil((t-e)/n),0),i=0,s=Array(r);r>i;)s[i++]=e,e+=n;return s};var O=function(){};x.bind=function(e,t){var n,r;if(e.bind===S&&S)return S.apply(e,u.call(arguments,1));if(!x.isFunction(e))throw new TypeError;return n=u.call(arguments,2),r=function(){if(this instanceof r){O.prototype=e.prototype;var i=new O;O.prototype=null;var s=e.apply(i,n.concat(u.call(arguments)));return Object(s)===s?s:i}return e.apply(t,n.concat(u.call(arguments)))}},x.bindAll=function(e){var t=u.call(arguments,1);return 0==t.length&&(t=x.functions(e)),T(t,function(t){e[t]=x.bind(e[t],e)}),e},x.memoize=function(e,t){var n={};return t||(t=x.identity),function(){var r=t.apply(this,arguments);return x.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}},x.delay=function(e,t){var n=u.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},x.defer=function(e){return x.delay.apply(x,[e,1].concat(u.call(arguments,1)))},x.throttle=function(e,t){var n,r,i,s,o=0,u=function(){o=new Date,i=null,s=e.apply(n,r)};return function(){var a=new Date,f=t-(a-o);return n=this,r=arguments,0>=f?(clearTimeout(i),i=null,o=a,s=e.apply(n,r)):i||(i=setTimeout(u,f)),s}},x.debounce=function(e,t,n){var r,i;return function(){var s=this,o=arguments,u=function(){r=null,n||(i=e.apply(s,o))},a=n&&!r;return clearTimeout(r),r=setTimeout(u,t),a&&(i=e.apply(s,o)),i}},x.once=function(e){var t,n=!1;return function(){return n?t:(n=!0,t=e.apply(this,arguments),e=null,t)}},x.wrap=function(e,t){return function(){var n=[e];return o.apply(n,arguments),t.apply(this,n)}},x.compose=function(){var e=arguments;return function(){for(var t=arguments,n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},x.after=function(e,t){return 0>=e?t():function(){return 1>--e?t.apply(this,arguments):void 0}},x.keys=E||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)x.has(e,n)&&(t[t.length]=n);return t},x.values=function(e){var t=[];for(var n in e)x.has(e,n)&&t.push(e[n]);return t},x.pairs=function(e){var t=[];for(var n in e)x.has(e,n)&&t.push([n,e[n]]);return t},x.invert=function(e){var t={};for(var n in e)x.has(e,n)&&(t[e[n]]=n);return t},x.functions=x.methods=function(e){var t=[];for(var n in e)x.isFunction(e[n])&&t.push(n);return t.sort()},x.extend=function(e){return T(u.call(arguments,1),function(t){if(t)for(var n in t)e[n]=t[n]}),e},x.pick=function(e){var t={},n=a.apply(r,u.call(arguments,1));return T(n,function(n){n in e&&(t[n]=e[n])}),t},x.omit=function(e){var t={},n=a.apply(r,u.call(arguments,1));for(var i in e)x.contains(n,i)||(t[i]=e[i]);return t},x.defaults=function(e){return T(u.call(arguments,1),function(t){if(t)for(var n in t)null==e[n]&&(e[n]=t[n])}),e},x.clone=function(e){return x.isObject(e)?x.isArray(e)?e.slice():x.extend({},e):e},x.tap=function(e,t){return t(e),e};var M=function(e,t,n,r){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof x&&(e=e._wrapped),t instanceof x&&(t=t._wrapped);var i=f.call(e);if(i!=f.call(t))return!1;switch(i){case"[object String]":return e==t+"";case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;for(var s=n.length;s--;)if(n[s]==e)return r[s]==t;n.push(e),r.push(t);var o=0,u=!0;if("[object Array]"==i){if(o=e.length,u=o==t.length)for(;o--&&(u=M(e[o],t[o],n,r)););}else{var a=e.constructor,l=t.constructor;if(a!==l&&!(x.isFunction(a)&&a instanceof a&&x.isFunction(l)&&l instanceof l))return!1;for(var c in e)if(x.has(e,c)&&(o++,!(u=x.has(t,c)&&M(e[c],t[c],n,r))))break;if(u){for(c in t)if(x.has(t,c)&&!(o--))break;u=!o}}return n.pop(),r.pop(),u};x.isEqual=function(e,t){return M(e,t,[],[])},x.isEmpty=function(e){if(null==e)return!0;if(x.isArray(e)||x.isString(e))return 0===e.length;for(var t in e)if(x.has(e,t))return!1;return!0},x.isElement=function(e){return!!e&&1===e.nodeType},x.isArray=w||function(e){return"[object Array]"==f.call(e)},x.isObject=function(e){return e===Object(e)},T(["Arguments","Function","String","Number","Date","RegExp"],function(e){x["is"+e]=function(t){return f.call(t)=="[object "+e+"]"}}),x.isArguments(arguments)||(x.isArguments=function(e){return!!e&&!!x.has(e,"callee")}),x.isFunction=function(e){return"function"==typeof e},x.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},x.isNaN=function(e){return x.isNumber(e)&&e!=+e},x.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"==f.call(e)},x.isNull=function(e){return null===e},x.isUndefined=function(e){return void 0===e},x.has=function(e,t){return l.call(e,t)},x.noConflict=function(){return e._=t,this},x.identity=function(e){return e},x.times=function(e,t,n){for(var r=Array(e),i=0;e>i;i++)r[i]=t.call(n,i);return r},x.random=function(e,t){return null==t&&(t=e,e=0),e+(0|Math.random()*(t-e+1))};var _={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};_.unescape=x.invert(_.escape);var D={escape:RegExp("["+x.keys(_.escape).join("")+"]","g"),unescape:RegExp("("+x.keys(_.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(e){x[e]=function(t){return null==t?"":(""+t).replace(D[e],function(t){return _[e][t]})}}),x.result=function(e,t){if(null==e)return null;var n=e[t];return x.isFunction(n)?n.call(e):n},x.mixin=function(e){T(x.functions(e),function(t){var n=x[t]=e[t];x.prototype[t]=function(){var e=[this._wrapped];return o.apply(e,arguments),F.call(this,n.apply(x,e))}})};var P=0;x.uniqueId=function(e){var t=""+ ++P;return e?e+t:t},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var H=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},j=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(e,t,n){n=x.defaults({},n,x.templateSettings);var r=RegExp([(n.escape||H).source,(n.interpolate||H).source,(n.evaluate||H).source].join("|")+"|$","g"),i=0,s="__p+='";e.replace(r,function(t,n,r,o,u){return s+=e.slice(i,u).replace(j,function(e){return"\\"+B[e]}),n&&(s+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),r&&(s+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),o&&(s+="';\n"+o+"\n__p+='"),i=u+t.length,t}),s+="';\n",n.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{var o=Function(n.variable||"obj","_",s)}catch(u){throw u.source=s,u}if(t)return o(t,x);var a=function(e){return o.call(this,e,x)};return a.source="function("+(n.variable||"obj")+"){\n"+s+"}",a},x.chain=function(e){return x(e).chain()};var F=function(e){return this._chain?x(e).chain():e};x.mixin(x),T(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=r[e];x.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),"shift"!=e&&"splice"!=e||0!==n.length||delete n[0],F.call(this,n)}}),T(["concat","join","slice"],function(e){var t=r[e];x.prototype[e]=function(){return F.call(this,t.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),define("underscore",function(e){return function(){var t,n;return t||e._}}(this)),function(){var e=this,t=e.Backbone,n=[],r=n.push,i=n.slice,s=n.splice,o;o="undefined"!=typeof exports?exports:e.Backbone={},o.VERSION="0.9.10";var u=e._;!u&&"undefined"!=typeof require&&(u=require("underscore")),o.$=e.jQuery||e.Zepto||e.ender,o.noConflict=function(){return e.Backbone=t,this},o.emulateHTTP=!1,o.emulateJSON=!1;var a=/\s+/,f=function(e,t,n,r){if(!n)return!0;if("object"==typeof n)for(var i in n)e[t].apply(e,[i,n[i]].concat(r));else{if(!a.test(n))return!0;n=n.split(a),i=0;for(var s=n.length;i<s;i++)e[t].apply(e,[n[i]].concat(r))}},l=function(e,t){var n,r=-1,i=e.length;switch(t.length){case 0:for(;++r<i;)(n=e[r]).callback.call(n.ctx);break;case 1:for(;++r<i;)(n=e[r]).callback.call(n.ctx,t[0]);break;case 2:for(;++r<i;)(n=e[r]).callback.call(n.ctx,t[0],t[1]);break;case 3:for(;++r<i;)(n=e[r]).callback.call(n.ctx,t[0],t[1],t[2]);break;default:for(;++r<i;)(n=e[r]).callback.apply(n.ctx,t)}},n=o.Events={on:function(e,t,n){return!f(this,"on",e,[t,n])||!t?this:(this._events||(this._events={}),(this._events[e]||(this._events[e]=[])).push({callback:t,context:n,ctx:n||this}),this)},once:function(e,t,n){if(!f(this,"once",e,[t,n])||!t)return this;var r=this,i=u.once(function(){r.off(e,i),t.apply(this,arguments)});return i._callback=t,this.on(e,i,n),this},off:function(e,t,n){var r,i,s,o,a,l,c,h;if(!this._events||!f(this,"off",e,[t,n]))return this;if(!e&&!t&&!n)return this._events={},this;o=e?[e]:u.keys(this._events),a=0;for(l=o.length;a<l;a++)if(e=o[a],r=this._events[e]){s=[];if(t||n){c=0;for(h=r.length;c<h;c++)i=r[c],(t&&t!==i.callback&&t!==i.callback._callback||n&&n!==i.context)&&s.push(i)}this._events[e]=s}return this},trigger:function(e){if(!this._events)return this;var t=i.call(arguments,1);if(!f(this,"trigger",e,t))return this;var n=this._events[e],r=this._events.all;return n&&l(n,t),r&&l(r,arguments),this},listenTo:function(e,t,n){var r=this._listeners||(this._listeners={}),i=e._listenerId||(e._listenerId=u.uniqueId("l"));return r[i]=e,e.on(t,"object"==typeof t?this:n,this),this},stopListening:function(e,t,n){var r=this._listeners;if(r){if(e)e.off(t,"object"==typeof t?this:n,this),!t&&!n&&delete r[e._listenerId];else{"object"==typeof t&&(n=this);for(var i in r)r[i].off(t,n,this);this._listeners={}}return this}}};n.bind=n.on,n.unbind=n.off,u.extend(o,n);var c=o.Model=function(e,t){var n,r=e||{};this.cid=u.uniqueId("c"),this.attributes={},t&&t.collection&&(this.collection=t.collection),t&&t.parse&&(r=this.parse(r,t)||{});if(n=u.result(this,"defaults"))r=u.defaults({},r,n);this.set(r,t),this.changed={},this.initialize.apply(this,arguments)};u.extend(c.prototype,n,{changed:null,idAttribute:"id",initialize:function(){},toJSON:function(){return u.clone(this.attributes)},sync:function(){return o.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return u.escape(this.get(e))},has:function(e){return null!=this.get(e)},set:function(e,t,n){var r,i,s,o,a,f,l;if(null==e)return this;"object"==typeof e?(i=e,n=t):(i={})[e]=t,n||(n={});if(!this._validate(i,n))return!1;s=n.unset,o=n.silent,e=[],a=this._changing,this._changing=!0,a||(this._previousAttributes=u.clone(this.attributes),this.changed={}),l=this.attributes,f=this._previousAttributes,this.idAttribute in i&&(this.id=i[this.idAttribute]);for(r in i)t=i[r],u.isEqual(l[r],t)||e.push(r),u.isEqual(f[r],t)?delete this.changed[r]:this.changed[r]=t,s?delete l[r]:l[r]=t;if(!o){e.length&&(this._pending=!0),t=0;for(r=e.length;t<r;t++)this.trigger("change:"+e[t],this,l[e[t]],n)}if(a)return this;if(!o)for(;this._pending;)this._pending=!1,this.trigger("change",this,n);return this._changing=this._pending=!1,this},unset:function(e,t){return this.set(e,void 0,u.extend({},t,{unset:!0}))},clear:function(e){var t={},n;for(n in this.attributes)t[n]=void 0;return this.set(t,u.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!u.isEmpty(this.changed):u.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?u.clone(this.changed):!1;var t,n=!1,r=this._changing?this._previousAttributes:this.attributes,i;for(i in e)u.isEqual(r[i],t=e[i])||((n||(n={}))[i]=t);return n},previous:function(e){return null==e||!this._previousAttributes?null:this._previousAttributes[e]},previousAttributes:function(){return u.clone(this._previousAttributes)},fetch:function(e){e=e?u.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=e.success;return e.success=function(e,n,r){if(!e.set(e.parse(n,r),r))return!1;t&&t(e,n,r)},this.sync("read",this,e)},save:function(e,t,n){var r,i,s=this.attributes;return null==e||"object"==typeof e?(r=e,n=t):(r={})[e]=t,r&&(!n||!n.wait)&&!this.set(r,n)?!1:(n=u.extend({validate:!0},n),this._validate(r,n)?(r&&n.wait&&(this.attributes=u.extend({},s,r)),void 0===n.parse&&(n.parse=!0),i=n.success,n.success=function(e,t,n){e.attributes=s;var o=e.parse(t,n);n.wait&&(o=u.extend(r||{},o));if(u.isObject(o)&&!e.set(o,n))return!1;i&&i(e,t,n)},e=this.isNew()?"create":n.patch?"patch":"update","patch"===e&&(n.attrs=r),e=this.sync(e,this,n),r&&n.wait&&(this.attributes=s),e):!1)},destroy:function(e){e=e?u.clone(e):{};var t=this,n=e.success,r=function(){t.trigger("destroy",t,t.collection,e)};e.success=function(e,t,i){(i.wait||e.isNew())&&r(),n&&n(e,t,i)};if(this.isNew())return e.success(this,null,e),!1;var i=this.sync("delete",this,e);return e.wait||r(),i},url:function(){var e=u.result(this,"urlRoot")||u.result(this.collection,"url")||k();return this.isNew()?e:e+("/"===e.charAt(e.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(e){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(e){return!this.validate||!this.validate(this.attributes,e)},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=u.extend({},this.attributes,e);var n=this.validationError=this.validate(e,t)||null;return n?(this.trigger("invalid",this,n,t||{}),!1):!0}});var h=o.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this.models=[],this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,u.extend({silent:!0},t))};u.extend(h.prototype,n,{model:c,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return o.sync.apply(this,arguments)},add:function(e,t){e=u.isArray(e)?e.slice():[e],t||(t={});var n,i,o,a,f,l,c,h,p,d;c=[],h=t.at,p=this.comparator&&null==h&&0!=t.sort,d=u.isString(this.comparator)?this.comparator:null,n=0;for(i=e.length;n<i;n++)(o=this._prepareModel(a=e[n],t))?(f=this.get(o))?t.merge&&(f.set(a===o?o.attributes:a,t),p&&!l&&f.hasChanged(d)&&(l=!0)):(c.push(o),o.on("all",this._onModelEvent,this),this._byId[o.cid]=o,null!=o.id&&(this._byId[o.id]=o)):this.trigger("invalid",this,a,t);c.length&&(p&&(l=!0),this.length+=c.length,null!=h?s.apply(this.models,[h,0].concat(c)):r.apply(this.models,c)),l&&this.sort({silent:!0});if(t.silent)return this;n=0;for(i=c.length;n<i;n++)(o=c[n]).trigger("add",o,this,t);return l&&this.trigger("sort",this,t),this},remove:function(e,t){e=u.isArray(e)?e.slice():[e],t||(t={});var n,r,i,s;n=0;for(r=e.length;n<r;n++)if(s=this.get(e[n]))delete this._byId[s.id],delete this._byId[s.cid],i=this.indexOf(s),this.models.splice(i,1),this.length--,t.silent||(t.index=i,s.trigger("remove",s,this,t)),this._removeReference(s);return this},push:function(e,t){return e=this._prepareModel(e,t),this.add(e,u.extend({at:this.length},t)),e},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return e=this._prepareModel(e,t),this.add(e,u.extend({at:0},t)),e},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(e,t){return this.models.slice(e,t)},get:function(e){if(null!=e)return this._idAttr||(this._idAttr=this.model.prototype.idAttribute),this._byId[e.id||e.cid||e[this._idAttr]||e]},at:function(e){return this.models[e]},where:function(e){return u.isEmpty(e)?[]:this.filter(function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},sort:function(e){if(!this.comparator)throw Error("Cannot sort a set without a comparator");return e||(e={}),u.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(u.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return u.invoke(this.models,"get",e)},update:function(e,t){t=u.extend({add:!0,merge:!0,remove:!0},t),t.parse&&(e=this.parse(e,t));var n,r,i,s,o=[],a=[],f={};u.isArray(e)||(e=e?[e]:[]);if(t.add&&!t.remove)return this.add(e,t);r=0;for(i=e.length;r<i;r++)n=e[r],s=this.get(n),t.remove&&s&&(f[s.cid]=!0),(t.add&&!s||t.merge&&s)&&o.push(n);if(t.remove){r=0;for(i=this.models.length;r<i;r++)n=this.models[r],f[n.cid]||a.push(n)}return a.length&&this.remove(a,t),o.length&&this.add(o,t),this},reset:function(e,t){t||(t={}),t.parse&&(e=this.parse(e,t));for(var n=0,r=this.models.length;n<r;n++)this._removeReference(this.models[n]);return t.previousModels=this.models.slice(),this._reset(),e&&this.add(e,u.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),this},fetch:function(e){e=e?u.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=e.success;return e.success=function(e,n,r){e[r.update?"update":"reset"](n,r),t&&t(e,n,r)},this.sync("read",this,e)},create:function(e,t){t=t?u.clone(t):{};if(!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var n=this,r=t.success;return t.success=function(e,t,i){i.wait&&n.add(e,i),r&&r(e,t,i)},e.save(null,t),e},parse:function(e){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models.length=0,this._byId={}},_prepareModel:function(e,t){if(e instanceof c)return e.collection||(e.collection=this),e;t||(t={}),t.collection=this;var n=new this.model(e,t);return n._validate(e,t)?n:!1},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){("add"===e||"remove"===e)&&n!==this||("destroy"===e&&this.remove(t,r),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],null!=t.id&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments))},sortedIndex:function(e,t,n){t||(t=this.comparator);var r=u.isFunction(t)?t:function(e){return e.get(t)};return u.sortedIndex(this.models,e,r,n)}}),u.each("forEach each map collect reduce foldl inject reduceRight foldr find detect filter select reject every all some any include contains invoke max min toArray size first head take initial rest tail drop last without indexOf shuffle lastIndexOf isEmpty chain".split(" "),function(e){h.prototype[e]=function(){var t=i.call(arguments);return t.unshift(this.models),u[e].apply(u,t)}}),u.each(["groupBy","countBy","sortBy"],function(e){h.prototype[e]=function(t,n){var r=u.isFunction(t)?t:function(e){return e.get(t)};return u[e](this.models,r,n)}});var p=o.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},d=/\((.*?)\)/g,v=/(\(\?)?:\w+/g,m=/\*\w+/g,g=/[\-{}\[\]+?.,\\\^$|#\s]/g;u.extend(p.prototype,n,{initialize:function(){},route:function(e,t,n){return u.isRegExp(e)||(e=this._routeToRegExp(e)),n||(n=this[t]),o.history.route(e,u.bind(function(r){r=this._extractParameters(e,r),n&&n.apply(this,r),this.trigger.apply(this,["route:"+t].concat(r)),this.trigger("route",t,r),o.history.trigger("route",this,t,r)},this)),this},navigate:function(e,t){return o.history.navigate(e,t),this},_bindRoutes:function(){if(this.routes)for(var e,t=u.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])},_routeToRegExp:function(e){return e=e.replace(g,"\\$&").replace(d,"(?:$1)?").replace(v,function(e,t){return t?e:"([^/]+)"}).replace(m,"(.*?)"),RegExp("^"+e+"$")},_extractParameters:function(e,t){return e.exec(t).slice(1)}});var y=o.History=function(){this.handlers=[],u.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},b=/^[#\/]|\s+$/g,w=/^\/+|\/+$/g,E=/msie [\w.]+/,S=/\/$/;y.started=!1,u.extend(y.prototype,n,{interval:50,getHash:function(e){return(e=(e||this).location.href.match(/#(.*)$/))?e[1]:""},getFragment:function(e,t){if(null==e)if(this._hasPushState||!this._wantsHashChange||t){e=this.location.pathname;var n=this.root.replace(S,"");e.indexOf(n)||(e=e.substr(n.length))}else e=this.getHash();return e.replace(b,"")},start:function(e){if(y.started)throw Error("Backbone.history has already been started");y.started=!0,this.options=u.extend({},{root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.options.pushState||!this.history||!this.history.pushState),e=this.getFragment();var t=document.documentMode,t=E.exec(navigator.userAgent.toLowerCase())&&(!t||7>=t);this.root=("/"+this.root+"/").replace(w,"/"),t&&this._wantsHashChange&&(this.iframe=o.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(e)),this._hasPushState?o.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!t?o.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=e,e=this.location,t=e.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!t)return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&t&&e.hash&&(this.fragment=this.getHash().replace(b,""),this.history.replaceState({},document.title,this.root+this.fragment+e.search));if(!this.options.silent)return this.loadUrl()},stop:function(){o.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),y.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(){var e=this.getFragment();e===this.fragment&&this.iframe&&(e=this.getFragment(this.getHash(this.iframe)));if(e===this.fragment)return!1;this.iframe&&this.navigate(e),this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(e){var t=this.fragment=this.getFragment(e);return u.any(this.handlers,function(e){if(e.route.test(t))return e.callback(t),!0})},navigate:function(e,t){if(!y.started)return!1;if(!t||!0===t)t={trigger:t};e=this.getFragment(e||"");if(this.fragment!==e){this.fragment=e;var n=this.root+e;if(this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}t.trigger&&this.loadUrl(e)}},_updateHash:function(e,t,n){n?(n=e.href.replace(/(javascript:|#).*$/,""),e.replace(n+"#"+t)):e.hash="#"+t}}),o.history=new y;var x=o.View=function(e){this.cid=u.uniqueId("view"),this._configure(e||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},T=/^(\S+)\s*(.*)$/,N="model collection el id attributes className tagName events".split(" ");u.extend(x.prototype,n,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,t){return this.$el&&this.undelegateEvents(),this.$el=e instanceof o.$?e:o.$(e),this.el=this.$el[0],!1!==t&&this.delegateEvents(),this},delegateEvents:function(e){if(e||(e=u.result(this,"events"))){this.undelegateEvents();for(var t in e){var n=e[t];u.isFunction(n)||(n=this[e[t]]);if(!n)throw Error('Method "'+e[t]+'" does not exist');var r=t.match(T),i=r[1],r=r[2],n=u.bind(n,this),i=i+(".delegateEvents"+this.cid);""===r?this.$el.on(i,n):this.$el.on(i,r,n)}}},undelegateEvents:function(){this.$el.off(".delegateEvents"+this.cid)},_configure:function(e){this.options&&(e=u.extend({},u.result(this,"options"),e)),u.extend(this,u.pick(e,N)),this.options=e},_ensureElement:function(){if(this.el)this.setElement(u.result(this,"el"),!1);else{var e=u.extend({},u.result(this,"attributes"));this.id&&(e.id=u.result(this,"id")),this.className&&(e["class"]=u.result(this,"className")),e=o.$("<"+u.result(this,"tagName")+">").attr(e),this.setElement(e,!1)}}});var C={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};o.sync=function(e,t,n){var r=C[e];u.defaults(n||(n={}),{emulateHTTP:o.emulateHTTP,emulateJSON:o.emulateJSON});var i={type:r,dataType:"json"};n.url||(i.url=u.result(t,"url")||k()),null==n.data&&t&&("create"===e||"update"===e||"patch"===e)&&(i.contentType="application/json",i.data=JSON.stringify(n.attrs||t.toJSON(n))),n.emulateJSON&&(i.contentType="application/x-www-form-urlencoded",i.data=i.data?{model:i.data}:{});if(n.emulateHTTP&&("PUT"===r||"DELETE"===r||"PATCH"===r)){i.type="POST",n.emulateJSON&&(i.data._method=r);var s=n.beforeSend;n.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override",r);if(s)return s.apply(this,arguments)}}"GET"!==i.type&&!n.emulateJSON&&(i.processData=!1);var a=n.success;n.success=function(e){a&&a(t,e,n),t.trigger("sync",t,e,n)};var f=n.error;return n.error=function(e){f&&f(t,e,n),t.trigger("error",t,e,n)},e=n.xhr=o.ajax(u.extend(i,n)),t.trigger("request",t,e,n),e},o.ajax=function(){return o.$.ajax.apply(o.$,arguments)},c.extend=h.extend=p.extend=x.extend=y.extend=function(e,t){var n=this,r;r=e&&u.has(e,"constructor")?e.constructor:function(){return n.apply(this,arguments)},u.extend(r,n,t);var i=function(){this.constructor=r};return i.prototype=n.prototype,r.prototype=new i,e&&u.extend(r.prototype,e),r.__super__=n.prototype,r};var k=function(){throw Error('A "url" property or function must be specified')}}.call(this),define("backbone",["underscore","jquery"],function(e){return function(){var t,n;return t||e.Backbone}}(this)),function(){define("storage",["require"],function(e){var t;return t={session:{set:function(e,t){return window.sessionStorage.setItem(e,JSON.stringify(t))},get:function(e){return JSON.parse(window.sessionStorage.getItem(e))},remove:function(e){return window.sessionStorage.removeItem(e)}},local:{set:function(e,t){return window.localStorage.setItem(e,JSON.stringify(t))},get:function(e){return JSON.parse(window.localStorage.getItem(e))},remove:function(e){return window.localStorage.removeItem(e)}},cookie:{set:function(e,t,n){var r,i;return i=n?(r=new Date,r.setTime(r.getTime()+n*24*60*60*1e3),"; expires="+r.toGMTString()):"",document.cookie=""+e+"="+t+i+"; path=/"},get:function(e){var t,n,r,i,s;r=""+e+"=",n=document.cookie.split(";");for(i=0,s=n.length;i<s;i++){t=n[i];while(t.charAt(0)===" ")t=t.substring(1,t.length);if(t.indexOf(r)===0)return t.substring(r.length,t.length)}return null},remove:function(e){return t.cookie.set(e,"",-1)}}},t})}.call(this),define("text",["module"],function(e){var t,n,r=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],i=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,s=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,o=typeof location!="undefined"&&location.href,u=o&&location.protocol&&location.protocol.replace(/\:/,""),a=o&&location.hostname,f=o&&(location.port||undefined),l=[],c=e.config&&e.config()||{};t={version:"2.0.3",strip:function(e){if(e){e=e.replace(i,"");var t=e.match(s);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:c.createXhr||function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(t=0;t<3;t+=1){n=r[t];try{e=new ActiveXObject(n)}catch(i){}if(e){r=[n];break}}return e},parseName:function(e){var t=!1,n=e.indexOf("."),r=e.substring(0,n),i=e.substring(n+1,e.length);return n=i.indexOf("!"),n!==-1&&(t=i.substring(n+1,i.length),t=t==="strip",i=i.substring(0,n)),{moduleName:r,ext:i,strip:t}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,i){var s,o,u,a=t.xdRegExp.exec(e);return a?(s=a[2],o=a[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===n)&&(!o||o.toLowerCase()===r.toLowerCase())&&(!u&&!o||u===i)):!0},finishLoad:function(e,n,r,i){r=n?t.strip(r):r,c.isBuild&&(l[e]=r),i(r)},load:function(e,n,r,i){if(i.isBuild&&!i.inlineText){r();return}c.isBuild=i.isBuild;var s=t.parseName(e),l=s.moduleName+"."+s.ext,h=n.toUrl(l),p=c.useXhr||t.useXhr;!o||p(h,u,a,f)?t.get(h,function(n){t.finishLoad(e,s.strip,n,r)},function(e){r.error&&r.error(e)}):n([l],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,r)})},write:function(e,n,r,i){if(l.hasOwnProperty(n)){var s=t.jsEscape(l[n]);r.asModule(e+"!"+n,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,n,r,i,s){var o=t.parseName(n),u=o.moduleName+"."+o.ext,a=r.toUrl(o.moduleName+"."+o.ext)+".js";t.load(u,r,function(n){var r=function(e){return i(a,e)};r.asModule=function(e,t){return i.asModule(e,a,t)},t.write(e,u,r,s)},s)}};if(c.env==="node"||!c.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node)n=require.nodeRequire("fs"),t.get=function(e,t){var r=n.readFileSync(e,"utf8");r.indexOf("﻿")===0&&(r=r.substring(1)),t(r)};else if(c.env==="xhr"||!c.env&&t.createXhr())t.get=function(e,n,r){var i=t.createXhr();i.open("GET",e,!0),c.onXhr&&c.onXhr(i,e),i.onreadystatechange=function(t){var s,o;i.readyState===4&&(s=i.status,s>399&&s<600?(o=new Error(e+" HTTP status: "+s),o.xhr=i,r(o)):n(i.responseText))},i.send(null)};else if(c.env==="rhino"||!c.env&&typeof Packages!="undefined"&&typeof java!="undefined")t.get=function(e,t){var n,r,i="utf-8",s=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),i)),a="";try{n=new java.lang.StringBuffer,r=u.readLine(),r&&r.length()&&r.charAt(0)===65279&&(r=r.substring(1)),n.append(r);while((r=u.readLine())!==null)n.append(o),n.append(r);a=String(n.toString())}finally{u.close()}t(a)};return t}),define("text!templates/main/_page.html",[],function(){return'<!-- Action Bar -->\n<nav id="action-bar" class="action-bar">\n</nav>\n<!-- /Action Bar -->\n\n<!-- Content -->\n<div class="main">\n  <section id="main-content" class="content">\n  </section>\n</div>\n<!-- /Content -->\n\n<!-- Sidebar -->\n<section id="sidebar" class="sidebar">\n</section>\n<!-- /Sidebar -->\n'}),function(){var e=Object.prototype.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("core/page_manager",["require","jquery","underscore","backbone","text!templates/main/_page.html"],function(e){var n,r,i,s,o;return n=e("jquery"),o=e("underscore"),r=e("backbone"),i=function(n){function r(){r.__super__.constructor.apply(this,arguments)}return t(r,n),r.prototype.className="page",r.prototype.template=o.template(e("text!templates/main/_page.html")),r.prototype.initialize=function(){this._views=[{name:"actionBar",parentSelector:"#action-bar"},{name:"sidebar",parentSelector:"#sidebar"},{name:"mainContent",parentSelector:"#main-content"}];if(this.options.views!=null)return this.setViews(this.options.views)},r.prototype.render=function(){return this.$el.html(this.template({}))},r.prototype.setViews=function(e){var t,n,r,i,s;i=this._views,s=[];for(n=0,r=i.length;n<r;n++)t=i[n],t.instance!=null&&this._removeView(t.instance),s.push(t.instance=e[t.name]);return s},r.prototype.open=function(){var e,t,n,r,i,s,o;this.render(),e=function(t){var n,r,i,s;if(!t)return;if(t.subViews){s=t.subViews;for(r=0,i=s.length;r<i;r++)n=s[r],e(n)}return typeof t.onOpen=="function"?t.onOpen():void 0},i=this._views,o=[];for(n=0,r=i.length;n<r;n++)t=i[n],this.$(t.parentSelector).append((s=t.instance)!=null?s.$el:void 0),o.push(e(t.instance));return o},r.prototype.canClose=function(){var e,t,n,r,i,s,o;e=!0,i=this._views;for(n=0,r=i.length;n<r;n++)t=i[n],e=(s=e&&((o=t.instance)!=null?typeof o.canClose==="function"?o.canClose():void 0:void 0))!=null?s:!0;return e},r.prototype._removeView=function(e){var t,n,r,i,s,o,u;if(!e)return;if(e.subViews){if(e.subViews){o=e.subViews;for(n=0,i=o.length;n<i;n++)t=o[n],this._removeView(t)}e.subViews=void 0;if(e.instances){u=e.instances;for(r=0,s=u.length;r<s;r++)t=u[r],this._removeView(t)}e.instances=void 0}return typeof e.onClose=="function"&&e.onClose(),e.unbind(),e.remove(),e.$el.detach(),e.$el=void 0,e.el=void 0,e.model=void 0,e.collection=void 0},r.prototype.close=function(){var e,t,n,r;r=this._views;for(t=0,n=r.length;t<n;t++)e=r[t],this._removeView(e.instance);return this.remove(),this.$el=void 0},r}(r.View),s=function(){function e(){}return e.prototype.Page=i,e.prototype.currentPage=null,e.prototype.canClose=function(){var e,t,r,i;return e=new n.Deferred,this.currentPage===null||((r=this.currentPage)!=null?r.toClose:void 0)?!0:(this.currentPage.toClose=!1,((i=typeof (t=this.currentPage).canClose==="function"?t.canClose():void 0)!=null?i:!0)?e.resolve():window.confirm("You haven't saved your changes yet. Do you want to leave without finishing?")?(this.currentPage.toClose=!0,e.resolve()):e.reject(),e.promise())},e.prototype.open=function(e){var t;if(!e||e===this.currentPage)return;return e.id===((t=this.currentPage)!=null?t.id:void 0)?e.open():(this.close(this.currentPage),n("#content").append(e.$el),e.open(),this.currentPage=e)},e.prototype.close=function(e){if(!e)return;e.close(),n("#content").html("");if(this.currentPage===e)return this.currentPage=null},e}(),new s})}.call(this);var dutils={};dutils.conf={},dutils.urls=function(){function e(e,t,n){var r=n[e]||!1;if(!r)throw"URL not found for view: "+e;var i=r,s;for(s in t)if(t.hasOwnProperty(s)){if(!r.match("<"+s+">"))throw s+" does not exist in "+i;r=r.replace("<"+s+">",t[s])}var o=new RegExp("<[a-zA-Z0-9-_]{1,}>","g"),u=r.match(o);if(u)throw"Missing arguments ("+u.join(", ")+") for url "+i;return r}return{resolve:function(t,n,r){return r||(r=dutils.conf.urls||{}),e(t,n,r)}}}(),define("dutils",function(e){return function(){var t,n;return t||e.dutils}}(this)),dutils.conf.urls={user_root:"/users/",user_verification:"/users/verification/<key>/",user_view:"/users/<id_>/",user_edit:"/users/<id_>/edit/",user_view_me:"/users/<>/",register:"/register/",login:"/login/",not_verified:"/not-verified/",verified:"/verified/",user_api:"/api/users/",login_api:"/api/users/login/",logout_api:"/api/users/logout/",user_info_api:"/api/users/<id_>/",logged_user_info_api:"/api/users/<>/",user_update_api:"/api/users/<id_>/update/",login_facebook:"/user/login/facebook",facebook_authorized:"/user/login/facebook/authorized/",login_google:"/user/login/google",google_authorized:"/user/login/google/authorized/",javascript_catalog:"/jsi18n/",hotsite:"/about/about/",root:"/",map:"/map/",map_coords:"/map/<lat>/<lng>/<zoom>/",get_geojson:"/get_geojson",radial_search:"/radial_search",send_error_report:"/send_error_report/",organizations_root:"/organizations/<id_>/edit/",organizations_api:"/api/organizations/",organization_api:"/api/organizations/<id_>/",feature_types:"/map_info/feature_types/",tooltip:"/map_info/tooltip/<zoom>/<app_label>/<model_name>/<obj_id>/",info_window:"/map_info/info_window/<zoom>/<app_label>/<model_name>/<obj_id>/",geojson:"/map_info/geojson/<app_label>/<model_name>/<obj_id>/",related:"/map_info/related/<app_label>/<model_name>/<obj_id>/"},define("dutils_urls",["dutils"],function(e){return function(){var t,n;return t||e.dutils.urls}}(this)),function(){define("urls",["require","dutils","dutils_urls"],function(e){var t,n,r;return t=e("dutils"),r=e("dutils_urls"),n=function(e){return t.conf.urls[e].replace(/^\/(.*)(\/)$/,"$1(/)").replace(/<([^>]*)>/g,":$1").replace(/\.\*/g,"*path")},{resolve:r.resolve,route:n}})}.call(this),define("text!templates/core/_edit_overlay.html",[],function(){return'<div class="overlay">\n  <a href="#" class="edit"><%= msg %></a>\n</div>\n\n'}),function(){define("core/mixins",["require","underscore","text!templates/core/_edit_overlay.html"],function(e){var t,n,r;return r=e("underscore"),n={defaultPermissions:{view:!0,edit:!0},hasPermission:function(e,t){var n,i,s;return n=(i=(s=this.permissions)!=null?s[e]:void 0)!=null?i:this.defaultPermissions[e],n?(r.isFunction(n)&&(t==null&&(t=KomooNS.user),n=n.apply(this,[t])),n):!1}},t={_overlayTemplate:r.template(e("text!templates/core/_edit_overlay.html")),setMode:function(e){var t;return this.mode=e!=null?e:(t=this.options.mode)!=null?t:"show",this.mode==="edit"?this.showOverlay():this.hideOverlay()},showOverlay:function(e){return e==null&&(e=i18n("Edit this")),this._overlay==null&&(this._overlay=$(this._overlayTemplate({msg:e}))),this.$el.append(this._overlay.css({marginTop:this.$el.height()*-1,height:this.$el.height()}))},hideOverlay:function(){var e;return(e=this._overlay)!=null?e.detach():void 0}},{PermissionMixin:n,EditOverlayMixin:t}})}.call(this),function(){var e=Object.prototype.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("main/models",["require","backbone","underscore","app","core/mixins"],function(e){var n,r,i,s,o;return n=e("backbone"),o=e("underscore"),i=e("app"),s=e("core/mixins"),r=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),o.extend(n.prototype,s.PermissionMixin),n.prototype.showUrl=function(){return""+this.navRoot+"/"+this.id},n.prototype.editUrl=function(){return""+this.navRoot+"/"+this.id+"/edit"},n.prototype.newUrl=function(){return""+this.navRoot+"/new"},n}(n.Model),{CommonObject:r}})}.call(this),Backbone.Paginator=function(e,t,n){var r={};return r.version="0.5.1-dev",r.clientPager=e.Collection.extend({useDiacriticsPlugin:!0,useLevenshteinPlugin:!0,sortColumn:"",sortDirection:"desc",lastSortColumn:"",fieldFilterRules:[],lastFieldFilterRules:[],filterFields:"",filterExpression:"",lastFilterExpression:"",defaults_ui:{firstPage:0,currentPage:1,perPage:5,totalPages:10,pagesInRange:4},initialize:function(){this.on("add",this.addModel,this),this.on("remove",this.removeModel,this),this.setDefaults()},setDefaults:function(){var e=t.defaults(this.paginator_ui,this.defaults_ui);t.defaults(this,e)},addModel:function(e){this.origModels.push(e)},removeModel:function(e){var n=t.indexOf(this.origModels,e);this.origModels.splice(n,1)},sync:function(r,i,s){var o=this;this.setDefaults();var u={};t.each(t.result(o,"server_api"),function(e,n){t.isFunction(e)&&(e=t.bind(e,o),e=e()),u[n]=e});var a=t.clone(o.paginator_core);t.each(a,function(e,n){t.isFunction(e)&&(e=t.bind(e,o),e=e()),a[n]=e}),a=t.defaults(a,{timeout:25e3,cache:!1,type:"GET",dataType:"jsonp"}),a=t.extend(a,{data:decodeURIComponent(n.param(u)),processData:!1,url:t.result(a,"url")},s);var f=e.VERSION.split("."),l=parseInt(f[0],10)===0&&parseInt(f[1],10)===9&&parseInt(f[2],10)<=9,c=a.success;a.success=function(e,t,n){c&&(l?c(e,t,n):c(i,e,a)),i&&i.trigger&&i.trigger("sync",i,e,a)};var h=a.error;a.error=function(e){h&&h(i,e,a),i&&i.trigger&&i.trigger("error",i,e,a)};var p=a.xhr=n.ajax(a);return i&&i.trigger&&i.trigger("request",i,p,a),p},nextPage:function(){this.currentPage<this.information.totalPages&&(this.currentPage=++this.currentPage,this.pager())},previousPage:function(){this.currentPage=--this.currentPage||1,this.pager()},goTo:function(e){e!==undefined&&(this.currentPage=parseInt(e,10),this.pager())},howManyPer:function(e){if(e!==undefined){var t=this.perPage;this.perPage=parseInt(e,10),this.currentPage=Math.ceil((t*(this.currentPage-1)+1)/e),this.pager()}},setSort:function(e,t){e!==undefined&&t!==undefined&&(this.lastSortColumn=this.sortColumn,this.sortColumn=e,this.sortDirection=t,this.pager(),this.info())},setFieldFilter:function(e){t.isEmpty(e)?(this.lastFieldFilterRules=this.fieldFilterRules,this.fieldFilterRules="",this.pager(),this.info()):(this.lastFieldFilterRules=this.fieldFilterRules,this.fieldFilterRules=e,this.pager(),this.info())},doFakeFieldFilter:function(e){if(!t.isEmpty(e)){var n=this.origModels;return n===undefined&&(n=this.models),n=this._fieldFilter(n,e),this.filterExpression!==""&&(n=this._filter(n,this.filterFields,this.filterExpression)),n.length}},setFilter:function(e,t){e!==undefined&&t!==undefined&&(this.filterFields=e,this.lastFilterExpression=this.filterExpression,this.filterExpression=t,this.pager(),this.info())},doFakeFilter:function(e,n){if(e!==undefined&&n!==undefined){var r=this.origModels;return r===undefined&&(r=this.models),t.isEmpty(this.fieldFilterRules)||(r=this._fieldFilter(r,this.fieldFilterRules)),r=this._filter(r,e,n),r.length}},pager:function(){var e=this,n=this.perPage,r=(e.currentPage-1)*n,i=r+n;e.origModels===undefined&&(e.origModels=e.models),e.models=e.origModels,this.sortColumn!==""&&(e.models=e._sort(e.models,this.sortColumn,this.sortDirection)),t.isEmpty(this.fieldFilterRules)||(e.models=e._fieldFilter(e.models,this.fieldFilterRules)),this.filterExpression!==""&&(e.models=e._filter(e.models,this.filterFields,this.filterExpression));if(this.lastSortColumn!==this.sortColumn||this.lastFilterExpression!==this.filterExpression||!t.isEqual(this.fieldFilterRules,this.lastFieldFilterRules))r=0,i=r+n,e.currentPage=1,this.lastSortColumn=this.sortColumn,this.lastFieldFilterRules=this.fieldFilterRules,this.lastFilterExpression=this.filterExpression;e.sortedAndFilteredModels=e.models,e.reset(e.models.slice(r,i))},_sort:function(e,n,r){return e=e.sort(function(e,i){var s=e.get(n),o=i.get(n);if(t.isUndefined(s)||t.isUndefined(o))return 0;s=s.toString().toLowerCase(),o=o.toString().toLowerCase();if(r==="desc")if(!s.match(/[^\-\d\.]/)&&s.match(/-?[\d\.]*/)&&!o.match(/[^\-\d\.]/)&&o.match(/-?[\d\.]*/)){if(s-0<o-0)return 1;if(s-0>o-0)return-1}else{if(s<o)return 1;if(s>o)return-1}else if(!s.match(/[^\-\d\.]/)&&s.match(/-?[\d\.]*/)&&!o.match(/[^\-\d\.]/)&&o.match(/-?[\d\.]*/)){if(s-0<o-0)return-1;if(s-0>o-0)return 1}else{if(s<o)return-1;if(s>o)return 1}return 0}),e},_fieldFilter:function(e,n){if(t.isEmpty(n))return e;var r=[];return t.each(e,function(e){var i=!0;t.each(n,function(n){if(!i)return!1;i=!1;if(n.type==="function"){var r=t.wrap(n.value,function(t){return t(e.get(n.field))});r()&&(i=!0)}else n.type==="required"?t.isEmpty(e.get(n.field).toString())||(i=!0):n.type==="min"?!t.isNaN(Number(e.get(n.field)))&&!t.isNaN(Number(n.value))&&Number(e.get(n.field))>=Number(n.value)&&(i=!0):n.type==="max"?!t.isNaN(Number(e.get(n.field)))&&!t.isNaN(Number(n.value))&&Number(e.get(n.field))<=Number(n.value)&&(i=!0):n.type==="range"?!t.isNaN(Number(e.get(n.field)))&&t.isObject(n.value)&&!t.isNaN(Number(n.value.min))&&!t.isNaN(Number(n.value.max))&&Number(e.get(n.field))>=Number(n.value.min)&&Number(e.get(n.field))<=Number(n.value.max)&&(i=!0):n.type==="minLength"?e.get(n.field).toString().length>=n.value&&(i=!0):n.type==="maxLength"?e.get(n.field).toString().length<=n.value&&(i=!0):n.type==="rangeLength"?t.isObject(n.value)&&!t.isNaN(Number(n.value.min))&&!t.isNaN(Number(n.value.max))&&e.get(n.field).toString().length>=n.value.min&&e.get(n.field).toString().length<=n.value.max&&(i=!0):n.type==="oneOf"?t.isArray(n.value)&&t.include(n.value,e.get(n.field))&&(i=!0):n.type==="equalTo"?n.value===e.get(n.field)&&(i=!0):n.type==="containsAllOf"?t.isArray(n.value)&&t.isArray(e.get(n.field))&&t.intersection(n.value,e.get(n.field)).length===n.value.length&&(i=!0):n.type==="pattern"?e.get(n.field).toString().match(n.value)&&(i=!0):i=!1}),i&&r.push(e)}),r},_filter:function(n,r,i){var s=this,o={};t.isString(r)?o[r]={cmp_method:"regexp"}:t.isArray(r)?t.each(r,function(e){o[e]={cmp_method:"regexp"}}):t.each(r,function(e,n){o[n]=t.defaults(e,{cmp_method:"regexp"})}),r=o,t.has(e.Paginator,"removeDiacritics")&&s.useDiacriticsPlugin&&(i=e.Paginator.removeDiacritics(i));if(i===""||!t.isString(i))return n;var u=t.map(i.match(/\w+/ig),function(e){return e.toLowerCase()}),a="("+t.uniq(u).join("|")+")",f=new RegExp(a,"igm"),l=[];return t.each(n,function(n){var o=[];t.each(r,function(r,a){var l=n.get(a);if(l){var c=[];t.has(e.Paginator,"removeDiacritics")&&s.useDiacriticsPlugin?l=e.Paginator.removeDiacritics(l.toString()):l=l.toString();if(r.cmp_method==="levenshtein"&&t.has(e.Paginator,"levenshtein")&&s.useLevenshteinPlugin){var h=e.Paginator.levenshtein(l,i);t.defaults(r,{max_distance:0}),h<=r.max_distance&&(c=t.uniq(u))}else c=l.match(f);c=t.map(c,function(e){return e.toString().toLowerCase()}),t.each(c,function(e){o.push(e)})}}),o=t.uniq(t.without(o,"")),t.isEmpty(t.difference(u,o))&&l.push(n)}),l},info:function(){var e=this,t={},n=e.sortedAndFilteredModels?e.sortedAndFilteredModels.length:e.length,r=Math.ceil(n/e.perPage);return t={totalUnfilteredRecords:e.origModels.length,totalRecords:n,currentPage:e.currentPage,perPage:this.perPage,totalPages:r,lastPage:r,previous:!1,next:!1,startRecord:n===0?0:(e.currentPage-1)*this.perPage+1,endRecord:Math.min(n,e.currentPage*this.perPage)},e.currentPage>1&&(t.previous=e.currentPage-1),e.currentPage<t.totalPages&&(t.next=e.currentPage+1),t.pageSet=e.setPagination(t),e.information=t,t},setPagination:function(e){var t=[],n=0,r=0,i=this.pagesInRange*2,s=Math.ceil(e.totalRecords/e.perPage);if(s>1)if(s<=1+i)for(n=1,r=s;n<=r;n++)t.push(n);else if(e.currentPage<=this.pagesInRange+1)for(n=1,r=2+i;n<r;n++)t.push(n);else if(s-this.pagesInRange>e.currentPage&&e.currentPage>this.pagesInRange)for(n=e.currentPage-this.pagesInRange;n<=e.currentPage+this.pagesInRange;n++)t.push(n);else for(n=s-i;n<=s;n++)t.push(n);return t}}),r.requestPager=e.Collection.extend({sync:function(r,i,s){var o=this;t.defaults(o.paginator_ui,{firstPage:0,currentPage:1,perPage:5,totalPages:10,pagesInRange:4}),t.each(o.paginator_ui,function(e,n){t.isUndefined(o[n])&&(o[n]=o.paginator_ui[n])});var u={};t.each(t.result(o,"server_api"),function(e,n){t.isFunction(e)&&(e=t.bind(e,o),e=e()),u[n]=e});var a=t.clone(o.paginator_core);t.each(a,function(e,n){t.isFunction(e)&&(e=t.bind(e,o),e=e()),a[n]=e}),a=t.defaults(a,{timeout:25e3,cache:!1,type:"GET",dataType:"jsonp"}),s.data?s.data=decodeURIComponent(n.param(t.extend(u,s.data))):s.data=decodeURIComponent(n.param(u)),a=t.extend(a,{data:decodeURIComponent(n.param(u)),processData:!1,url:t.result(a,"url")},s);var f=e.VERSION.split("."),l=parseInt(f[0],10)===0&&parseInt(f[1],10)===9&&parseInt(f[2],10)<=9,c=a.success;a.success=function(e,t,n){c&&(l?c(e,t,n):c(i,e,a)),i&&i.trigger&&i.trigger("sync",i,e,a)};var h=a.error;a.error=function(e){h&&h(i,e,a),i&&i.trigger&&i.trigger("error",i,e,a)};var p=a.xhr=n.ajax(a);return i&&i.trigger&&i.trigger("request",i,p,a),p},requestNextPage:function(e){if(this.currentPage!==undefined)return this.currentPage+=1,this.pager(e);var t=new n.Deferred;return t.reject(),t.promise()},requestPreviousPage:function(e){if(this.currentPage!==undefined)return this.currentPage-=1,this.pager(e);var t=new n.Deferred;return t.reject(),t.promise()},updateOrder:function(e){e!==undefined&&(this.sortField=e,this.pager())},goTo:function(e,t){if(e!==undefined)return this.currentPage=parseInt(e,10),this.pager(t);var r=new n.Deferred;return r.reject(),r.promise()},howManyPer:function(e){e!==undefined&&(this.currentPage=this.firstPage,this.perPage=e,this.pager())},sort:function(){},info:function(){var e={totalRecords:this.totalRecords||0,currentPage:this.currentPage,firstPage:this.firstPage,totalPages:Math.ceil(this.totalRecords/this.perPage),lastPage:this.totalPages,perPage:this.perPage,hasPrevious:!1,hasNext:!1};return this.currentPage>1&&(e.hasPrevious=this.currentPage-1),this.currentPage<e.totalPages&&(e.hasNext=this.currentPage+1),e.pageSet=this.setPagination(e),this.information=e,e},setPagination:function(e){var t=[],n=0,r=0,i=this.pagesInRange*2,s=Math.ceil(e.totalRecords/e.perPage);if(s>1)if(s<=1+i)for(n=1,r=s;n<=r;n++)t.push(n);else if(e.currentPage<=this.pagesInRange+1)for(n=1,r=2+i;n<r;n++)t.push(n);else if(s-this.pagesInRange>e.currentPage&&e.currentPage>this.pagesInRange)for(n=e.currentPage-this.pagesInRange;n<=e.currentPage+this.pagesInRange;n++)t.push(n);else for(n=s-i;n<=s;n++)t.push(n);return t},pager:function(e){return t.isObject(e)||(e={}),this.fetch(e)},url:function(){return this.paginator_core!==undefined&&this.paginator_core.url!==undefined?this.paginator_core.url:null}}),r}(Backbone,_,jQuery),define("backbone.paginator",["backbone"],function(e){return function(){var t,n;return t||e.Backbone}}(this)),function(){define("update/models",["require","underscore","backbone"],function(e){var t,n,r;return r=e("underscore"),t=e("backbone"),n=t.Model.extend(),{Update:n}})}.call(this),function(){var e=Object.prototype.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("user/collections",["require","underscore","backbone","backbone.paginator","urls","update/models"],function(e){var n,r,i,s,o;return o=e("underscore"),n=e("backbone"),e("backbone.paginator"),s=e("urls"),i=e("update/models").Update,r=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.model=i,n.prototype.paginator_core={dataType:"json",url:function(){return s.resolve("user_update_api",{id_:this.options.user.id})}},n.prototype.paginator_ui={firstPage:0,currentPage:0,perPage:5},n.prototype.server_api={per_page:function(){return this.perPage},page:function(){return this.currentPage}},n.prototype.initialize=function(e,t){this.options=t},n.prototype.parse=function(e){var t;return t=e.results,this.totalPages=Math.ceil(e.count/this.perPage),this.totalRecords=parseInt(e.count),t},n}(n.Paginator.requestPager),{PaginatedUpdates:r}})}.call(this),function(){var e=Object.prototype.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("user/models",["require","underscore","backbone","app","urls","core/mixins","main/models","./collections"],function(e){var n,r,i,s,o,u,a,f,l;return l=e("underscore"),n=e("backbone"),o=e("app"),f=e("urls"),r=e("core/mixins").PermissionMixin,a=e("main/models"),i=e("./collections").PaginatedUpdates,u=function(e){if(e==null){typeof console!="undefined"&&console!==null&&console.log("User id not specified");return}if(l.isNumber(e)||l.isString(e))e=new s({id:e});return e instanceof s?e:null},s=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.permissions={edit:function(e){return e instanceof n&&(e.isSuperuser()||e.get("id")===this.get("id"))}},n.prototype.urlRoot=f.resolve("user_api"),n.prototype.navRoot="/users",n.prototype.defaults={about_me:"",geojson:{type:"FeatureCollection",features:[{geometry:{type:"Point",coordinates:[-23.566743,-46.746802]},type:"Feature",properties:{type:"User"}}]}},n.prototype.getUpdates=function(){var e;return(e=this.updates)!=null?e:this.updates=new i([],{user:this})},n.prototype.view=function(){return o.goTo(f.resolve("user_view",{id_:this.id}))},n.prototype.edit=function(){return o.goTo(f.resolve("user_edit",{id_:this.id}))},n.prototype.isSuperuser=function(){return!1},n}(a.CommonObject),{getUser:u,User:s}})}.call(this),define("async",[],function(){function n(e){var t,n;t=document.createElement("script"),t.type="text/javascript",t.async=!0,t.src=e,n=document.getElementsByTagName("script")[0],n.parentNode.insertBefore(t,n)}function r(t,n){var r=/!(.+)/,i=t.replace(r,""),s=r.test(t)?t.replace(/.+!/,""):e;return i+=i.indexOf("?")<0?"?":"&",i+s+"="+n}function i(){return t+=1,"__async_req_"+t+"__"}var e="callback",t=0;return{load:function(e,t,s,o){if(o.isBuild)s(null);else{var u=i();window[u]=s,n(r(e,u))}}}}),define("propertyParser",[],function(){function n(t){var n,i={};while(n=e.exec(t))i[n[1]]=r(n[2]||n[3]);return i}function r(e){return t.test(e)?e=e.replace(t,"$1").split(","):e==="null"?e=null:e==="false"?e=!1:e==="true"?e=!0:e===""||e==="''"||e==='""'?e="":isNaN(e)||(e=+e),e}var e=/([\w-]+)\s*:\s*(?:(\[[^\]]+\])|([^,]+)),?/g,t=/^\[([^\]]+)\]$/;return{parseProperties:n,typecastVal:r}}),define("goog",["async","propertyParser"],function(e,t){function r(e){var r=n.exec(e),i={moduleName:r[1],version:r[2]||"1"};return i.settings=t.parseProperties(r[3]),i}var n=/^([^,]+)(?:,([^,]+))?(?:,(.+))?/;return{load:function(e,t,n,i){if(i.isBuild)n(null);else{var s=r(e),o=s.settings;o.callback=n,t(["async!"+(document.location.protocol==="https:"?"https":"http")+"://www.google.com/jsapi"],function(){google.load(s.moduleName,s.version,o)})}}}}),function(){define("services/googlemaps",["goog!maps,3,other_params:[sensor=false&libraries=drawing&language=pt-br]"],function(){return google.maps})}.call(this),function(){define("core/map/core",["require","jquery","underscore","backbone"],function(e){var t,n,r,i,s;return t=e("jquery"),s=e("underscore"),n=e("backbone"),r=function(){function r(){this._components={},this._pubQueue=[],this._pubsub={},s.extend(this._pubsub,n.Events)}return r.prototype.loading=0,r.prototype.data={deferred:t.Deferred,when:t.when},r.prototype._getComponent=function(e,t){var n,r;n=(r=this._components[e])!=null?r:{};if(n[t]==null)throw new Error("Could not be found a component '"+e+"' with id '"+t+"'");return n[t]},r.prototype._removeComponent=function(e,t){var n;return(n=this._components[e])!=null?delete n[t]:void 0},r.prototype.load=function(t,n,r){var i,s,o,u,a,f=this;return a=n,o=t.split("::"),i=o[0],s=o[1],u=this.data.deferred(),e([i],function(e){var i,o;i=e[s];try{o=new i(f,n)}catch(l){throw l}return f.data.when(o.init(r)).done(function(){return f._components[t][a].instance=o,f.publish(""+s+":started",a),u.resolve(o)}).fail(function(){return typeof console!="undefined"&&console!==null&&console.warn("Could not initialize component '"+t+"'"),u.resolve(o)})},function(n){var r;if(n.requireType!=="timeout")throw r=n.requireModules&&n.requireModules[0],e.undef(r),n;return typeof console!="undefined"&&console!==null&&console.warn("Could not load module '"+n.requireModules+"'"),u.resolve()}),u.promise()},r.prototype.unload=function(e){},r.prototype.start=function(e,n,r){var i,o,u,a,f,l,c,h,p,d,v,m=this;r==null&&(r={}),s.isString(e)?o=[{component:e,el:n,opts:r}]:s.isArray(e)?o=e:o=[e];if(!s.isArray(o))throw new Error("componentList must be defined as an array");c=[];for(d=0,v=o.length;d<v;d++)l=o[d],i=l.component,n=l.el,r=l.opts,this.loading++,f=n,(p=this._components)[i]==null&&(p[i]={}),u=this._components[i],u[f]!=null&&typeof console!="undefined"&&console!==null&&console.error("Conflict: already exists one component '"+i+"' with id '"+f+"' "),this._components[i][f]={type:i,el:n,opts:r},a=this.data.deferred(),c.push(this.load(i,n,r));return h=this.data.when.apply(t,c),h.done(function(){return m.loading-=arguments.length,m._processPublishQueue()}),h},r.prototype.stop=function(e,n){var r,i,o,u,a,f,l,c,h;a=n,f=s.isArray(a)?a:[a],o=this.data.deferred(),l=f.length,u=0;for(c=0,h=f.length;c<h;c++)r=f[c],i=this._getComponent(e,r),i.instance.destroy().done(function(){t(i.el).children().remove(),this._removeComponent(e,r),u++;if(u===l)return o.resolve()});return o.promise()},r.prototype.publish=function(e){return this._addToPublishQueue.apply(this,arguments),this._processPublishQueue()},r.prototype.subscribe=function(e,t,n){return this._pubsub.on(e,t,n)},r.prototype.remove=function(){return this._pubsub.stopListening(),this._pubsub.off()},r.prototype._addToPublishQueue=function(e){return this._pubQueue.push(arguments)},r.prototype._processPublishQueue=function(){var e;if(this.loading>0)return!1;e=this._pubQueue.shift();if(e!=null)return this._pubsub.trigger.apply(this._pubsub,e),this._processPublishQueue()},r}(),i={Mediator:r},i})}.call(this),function(){var e=Object.prototype.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("core/map/collections",["require","services/googlemaps"],function(e){var n,r,i,s,o,u;return o=e("services/googlemaps"),window.komoo==null&&(window.komoo={}),(u=window.komoo).event==null&&(u.event=o.event),i=function(){function e(e){this.options=e!=null?e:{},this.elements=[],this.length=0}return e.prototype.updateLength=function(){return this.length=this.elements.length},e.prototype.clear=function(){return this.elements.length=0,this.updateLength()},e.prototype.getAt=function(e){return this.elements[e]},e.prototype.push=function(e){return this.elements.push(e),this.updateLength()},e.prototype.pop=function(){var e;return e=this.elements.pop(),this.updateLength(),e},e.prototype.forEach=function(e,t){return this.elements.forEach(e,t)},e.prototype.getArray=function(){return this.elements},e.prototype.slice=function(e,t){return this.elements.slice(e,t)},e}(),n=function(e){function n(e){var t,r=this;e==null&&(e={}),n.__super__.constructor.call(this,e),e.map&&this.setMap(e.map),(t=e.features)!=null&&t.forEach(function(e){return r.push(e)})}return t(n,e),n.prototype.push=function(e){if(e==null)return;return n.__super__.push.call(this,e),e.setMap(this.map)},n.prototype.getBounds=function(){var e,t,n,r=this;return e=this.getAt(0),e&&e.getGeometryType()!=="Empty"&&(t=e.getGeometry(),n=t.getLatLngFromArray(t.getCenter()),this.bounds=new o.LatLngBounds(n,n),this.forEach(function(e){var t;return(t=r.bounds)!=null?t.union(e.getBounds()):void 0})),this.bounds},n.prototype.getCenter=function(){var e;return(e=this.getBounds())!=null?e.getCenter():void 0},n.prototype.setMap=function(e,t){var n,r=this;return this.map=e,n=null,this.forEach(function(e){return t!=null&&(n={geometry:t!=null?t.geometry:void 0,point:t!=null?t.icon:void 0,icon:t!=null?t.icon:void 0}),e.getType()==="Community"&&n!=null&&(n.point=!1),e!=null?e.setMap(r.map,n):void 0}),this.handleMapEvents()},n.prototype.show=function(){return this.setMap(this.map,{geometry:!0}),this.setVisible(!0)},n.prototype.hide=function(){return this.setVisible(!1)},n.prototype.getGeoJson=function(e){var t;return e.geometryCollection==null&&(e.geometryCollection=!1),e.geometryCollection?(t={type:"GeometryCollection",geometries:[]},this.forEach(function(e){return t.geometries.push(e.getGeometryGeoJson())})):(t={type:"FeatureCollection",features:[]},this.forEach(function(e){return t.features.push(e.getGeoJson())})),t},n.prototype.removeAllFromMap=function(){return this.forEach(function(e){return e.removeFromMap()})},n.prototype.remove=function(){return this.forEach(function(e){return e.remove()}),this.clear()},n.prototype.setVisible=function(e){return this.forEach(function(t){return t.setVisible(e)})},n.prototype.updateFeaturesVisibility=function(){return this.forEach(function(e){return e.seMap(e.getMap())})},n.prototype.handleMapEvents=function(){var e=this;return komoo.event.addListener(this.map,"zoom_changed",function(){})},n}(i),r=function(e){function r(e){e==null&&(e={}),r.__super__.constructor.call(this,e),this.featuresByType={}}return t(r,e),r.prototype.push=function(e){var t,i,s,o,u,a,f,l=this;return r.__super__.push.call(this,e),t=e.getType(),(i=this.featuresByType)[t]==null&&(i[t]={}),(s=this.featuresByType[t])["categories"]==null&&(s.categories={}),(o=this.featuresByType[t]["categories"])["all"]==null&&(o.all=new n({map:this.map})),(u=this.featuresByType[t]["categories"])["uncategorized"]==null&&(u.uncategorized=new n({map:this.map})),(f=e.getCategories())!=null&&f.forEach(function(r){var i,s;return(i=l.featuresByType[t]["categories"])[s=r.name]==null&&(i[s]=new n({map:l.map})),l.featuresByType[t].categories[r.name].push(e)}),(e.getCategories()==null||e.getCategories().length===0)&&this.featuresByType[t].categories.uncategorized.push(e),this.featuresByType[t].categories.all.push(e),(a=this.featuresByType[t])["ids"]==null&&(a.ids={}),this.featuresByType[t].ids[e.getProperty("id")]=e},r.prototype.pop=function(){return r.__super__.pop.call(this)},r.prototype.clear=function(){return this.featuresByType={},r.__super__.clear.call(this)},r.prototype.getByType=function(e,t,r){var i,s=this;return r==null&&(r=!1),this.featuresByType[e]?t?t.length===0?this.featuresByType[e].categories.uncategorized:(i=new n({map:this.map}),t.forEach(function(t){if(s.featuresByType[e].categories[t])return s.featuresByType[e].categories[t].forEach(function(e){if(!r||!e.getCategories()||e.getCategories().length===1)return i.push(e)})}),i):this.featuresByType[e].categories.all:!1},r.prototype.getById=function(e,t){var n;return(n=this.featuresByType[e])!=null?n.ids[t]:void 0},r.prototype.highlightFeature=function(e,t){var n,r;n=typeof e=="string"?this.getById(e,t):e;if(n.isHighlighted())return;return(r=this.highlighted)!=null&&r.setHighlight(!1),n.highlight(),this.highlighted=n},r}(n),s=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n}(n),window.komoo.collections={GenericCollection:i,FeatureCollection:n,FeatureCollectionPlus:r,makeFeatureCollection:function(e){return e==null&&(e={}),new n(e)},makeFeatureCollectionPlus:function(e){return e==null&&(e={}),new r(e)}},window.komoo.collections})}.call(this),function(){define("core/map/common",[],function(){return{geometries:{types:{EMPTY:"Empty",POINT:"Point",MULTIPOINT:"MultiPoint",POLYGON:"Polygon",POLYLINE:"LineString",LINESTRING:"LineString",MULTIPOLYLINE:"MultiLineString",MULTILINESTRING:"MultiLineString"}}}})}.call(this),define("core/map/multimarker",["services/googlemaps"],function(e){return MultiMarker=function(t){t=t||{},this.markers_=new e.MVCArray(t.markers||[]),this.positions_=new e.MVCArray(t.positions||[]),this.map_=t.map,this.visible_=t.visible,this.clickable_=t.clickable,this.draggable_=t.draggable,this.icon_=t.icon,this.zIndex=t.zIndex||0},MultiMarker.prototype.getPosition=function(){var e;return(e=this.markers_.getAt(0))?e.getPosition():null},MultiMarker.prototype.getPositions=function(){this.positions_.clear();for(var e=0;e<this.markers_.getLength();e++)this.positions_.push(this.markers_.getAt(e).getPosition());return this.positions_},MultiMarker.prototype.setPositions=function(e){if(e.length!=this.markers_.getLength())throw"Invalid length.";this.positions_.clear();for(var t=0;t<this.markers_.getLength();t++)this.markers_.getAt(t).setPosition(e[t]),this.positions_.push(e[t])},MultiMarker.prototype.addMarker=function(t,n){var r=this;this.markers_.push(t),n||this.icon_&&t.setIcon(this.icon_),e.event.addListener(t,"click",function(n){e.event.trigger(r,"click",n,t)}),e.event.addListener(t,"mouseover",function(n){e.event.trigger(r,"mouseover",n,t)}),e.event.addListener(t,"mouseout",function(n){e.event.trigger(r,"mouseout",n,t)}),e.event.addListener(t,"mousemove",function(n){e.event.trigger(r,"mousemove",n,t)})},MultiMarker.prototype.addMarkers=function(e,t){for(var n=0;n<e.length;n++)this.addMarker(e[n],t)},MultiMarker.prototype.getMarkers=function(){return this.markers_},MultiMarker.prototype.setDraggable=function(e){for(var t=0;t<this.markers_.getLength();t++)this.markers_.getAt(t).setDraggable(e);this.draggable_=e},MultiMarker.prototype.getDraggable=function(){return this.draggable_},MultiMarker.prototype.setMap=function(e){for(var t=0;t<this.markers_.getLength();t++)this.markers_.getAt(t).setMap(e);this.map_=e},MultiMarker.prototype.getMap=function(){return this.map_},MultiMarker.prototype.setIcon=function(e){for(var t=0;t<this.markers_.getLength();t++)this.markers_.getAt(t).setIcon(e);this.icon_=e},MultiMarker.prototype.getIcon=function(){return this.icon_},MultiMarker.prototype.setVisible=function(e){for(var t=0;t<this.markers_.getLength();t++)this.markers_.getAt(t).setVisible(e);this.visible_=e},MultiMarker.prototype.getVisible=function(){return this.visible_},MultiMarker}),define("core/map/multipolyline",["services/googlemaps"],function(e){return MultiPolyline=function(t){t=t||{},this.polylines_=new e.MVCArray(t.polylines||[]),this.paths_=new e.MVCArray(t.paths||[]),this.map_=t.map,this.visible_=t.visible,this.clickable_=t.clickable,this.zIndex=t.zIndex||0,this.strokeColor_=t.strokeColor||"black",this.strokOpacity_=t.strokeOpacity||1,this.strokeWeight_=t.strokeWeight||3},MultiPolyline.prototype.getPaths=function(){this.paths_.clear();for(var e=0;e<this.polylines_.getLength();e++)this.paths_.push(this.polylines_.getAt(e).getPath());return this.paths_},MultiPolyline.prototype.setPaths=function(e){if(e.length!=this.polylines_.getLength())throw"Invalid length.";this.paths_.clear();for(var t=0;t<this.polylines_.getLength();t++)this.polylines_.getAt(t).setPath(e[t]),this.paths_.push(e[t])},MultiPolyline.prototype.addPolyline=function(t,n){var r=this;this.polylines_.push(t),n!=1&&t.setOptions({clickable:this.clickable_,zIndex:this.zIndex,strokeColor:this.strokeColor_,strokeOpacity:this.strokOpacity_,strokeWeight:this.strokeWeight_}),e.event.addListener(t,"click",function(n){e.event.trigger(r,"click",n,t)}),e.event.addListener(t,"mouseover",function(n){e.event.trigger(r,"mouseover",n,t)}),e.event.addListener(t,"mouseout",function(n){e.event.trigger(r,"mouseout",n,t)}),e.event.addListener(t,"mousemove",function(n){e.event.trigger(r,"mousemove",n,t)})},MultiPolyline.prototype.addPolylines=function(e,t){for(var n=0;n<e.length;n++)this.addPolyline(e[n],t)},MultiPolyline.prototype.getPolylines=function(){return this.polylines_},MultiPolyline.prototype.setMap=function(e){for(var t=0;t<this.polylines_.getLength();t++)this.polylines_.getAt(t).setMap(e);this.map_=e},MultiPolyline.prototype.getMap=function(){return this.map_},MultiPolyline.prototype.setVisible=function(e){for(var t=0;t<this.polylines_.getLength();t++)this.polylines_.getAt(t).setVisible(e);this.visible_=e},MultiPolyline.prototype.setEditable=function(e){for(var t=0;t<this.polylines_.getLength();t++)this.polylines_.getAt(t).setEditable(e);this.visible_=e},MultiPolyline.prototype.setOptions=function(e){for(var t=0;t<this.polylines_.getLength();t++)this.polylines_.getAt(t).setOptions(e);this.options_=e},MultiPolyline.prototype.getVisible=function(){return this.visible_},MultiPolyline}),function(){var e=Object.prototype.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("core/map/geometries",["require","services/googlemaps","./common","./multimarker","./multipolyline"],function(e){var n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E;return w=e("services/googlemaps"),y=e("./common"),e("./multimarker"),e("./multipolyline"),window.komoo==null&&(window.komoo={}),(E=window.komoo).event==null&&(E.event=w.event),n=y.geometries.types.EMPTY,h=y.geometries.types.POINT,a=y.geometries.types.MULTIPOINT,p=y.geometries.types.POLYGON,d=y.geometries.types.LINESTRING,s=y.geometries.types.LINESTRING,f=y.geometries.types.MULTILINESTRING,u=y.geometries.types.MULTILINESTRING,b={BACKGROUND_COLOR:"#000",BACKGROUND_OPACITY:.6,BORDER_COLOR:"#000",BORDER_OPACITY:.6,BORDER_SIZE:1.5,BORDER_SIZE_HOVER:2.5,ZINDEX:1},i=function(){function e(e){this.options=e!=null?e:{},this.setFeature(this.options.feature),this.initOverlay(this.options)}return e.prototype.initOverlay=function(e){throw"Not Implemented"},e.prototype.getCoordinates=function(){throw"Not Implemented"},e.prototype.setCoordinates=function(e){return komoo.event.trigger(this,"coordinates_changed")},e.prototype.setEditable=function(e){throw"Not Implemented"},e.prototype.initEvents=function(e){var t,n=this;e==null&&(e=this.overlay);if(!e)return;return t=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"],t.forEach(function(t){return komoo.event.addListener(e,t,function(e,r){return komoo.event.trigger(n,t,e,r)})})},e.prototype.calculateBounds=function(){var e,t,n,r,i,s,o,u,a,l,c,h,d,v;s=a=l=n=null,i=function(e){return s==null&&(s=a!=null?a:a=e[0]),l==null&&(l=n!=null?n:n=e[1]),s=Math.max(e[0],s),a=Math.min(e[0],a),l=Math.min(e[1],l),n=Math.max(e[1],n),[[a,l],[s,n]]},t=this.getCoordinates(),r=this.getGeometryType(),r!==p&&r!==f&&(t=[t]);for(c=0,d=t.length;c<d;c++){o=t[c];for(h=0,v=o.length;h<v;h++)u=o[h],e=i(u)}return e!=null&&(this.bounds=new w.LatLngBounds(this.getLatLngFromArray(e[0]),this.getLatLngFromArray(e[1]))),this.bounds},e.prototype.getBounds=function(){return this.bounds!=null?this.bounds:this.calculateBounds()},e.prototype.getCenter=function(){var e,t,n;return this.overlay?this.getArrayFromLatLng((typeof (e=this.overlay).getCenter=="function"?e.getCenter():void 0)||((n=this.getBounds())!=null?n.getCenter():void 0)||(typeof (t=this.overlay).getPosition=="function"?t.getPosition():void 0)):[]},e.prototype.getOverlay=function(){return this.overlay},e.prototype.setOverlay=function(e){return this.overlay=e,this.initEvents()},e.prototype.getFeature=function(){return this.feature},e.prototype.setFeature=function(e){this.feature=e},e.prototype.getGeometryType=function(){return this.geometryType},e.prototype.getDefaultZIndex=function(){var e;return((e=this.feature)!=null?e.getDefaultZIndex():void 0)||b.ZINDEX},e.prototype.getLatLngFromArray=function(e){return e!=null?new w.LatLng(e[0],e[1]):null},e.prototype.getArrayFromLatLng=function(e){return e?[e.lat(),e.lng()]:[]},e.prototype.getLatLngArrayFromArray=function(e){var t,n,r,i;i=[];for(n=0,r=e.length;n<r;n++)t=e[n],i.push(this.getLatLngFromArray(t));return i},e.prototype.getArrayFromLatLngArray=function(e){var t,n,r,i;if(e){i=[];for(n=0,r=e.length;n<r;n++)t=e[n],i.push(this.getArrayFromLatLng(t));return i}return[]},e.prototype.getMap=function(){return this.map},e.prototype.setMap=function(e){var t;return this.map=e,(t=this.overlay)!=null?t.setMap(this.map&&this.map.googleMap?this.map.googleMap:this.map):void 0},e.prototype.getVisible=function(){var e;return(e=this.overlay)!=null?e.getVisible():void 0},e.prototype.setVisible=function(e){var t;return(t=this.overlay)!=null?t.setVisible(e):void 0},e.prototype.setOptions=function(e){var t;return this.options=e,(t=this.overlay)!=null?t.setOptions(this.options):void 0},e.prototype.getIcon=function(){var e;return(e=this.overlay)!=null?typeof e.getIcon=="function"?e.getIcon():void 0:void 0},e.prototype.setIcon=function(e){var t;return(t=this.overlay)!=null?typeof t.setIcon=="function"?t.setIcon(e):void 0:void 0},e.prototype.getIconUrl=function(e){var t;return(t=this.feature)!=null?t.getIconUrl(e):void 0},e.prototype.getGeoJson=function(){return{type:this.getGeometryType(),coordinates:this.getCoordinates()}},e}(),r=function(e){function r(){r.__super__.constructor.apply(this,arguments)}return t(r,e),r.prototype.geometryType=n,r.prototype.getOverlayOptions=function(e){return{}},r.prototype.initOverlay=function(e){return this.options=e!=null?e:{},!0},r.prototype.getCoordinates=function(){return[]},r.prototype.setEditable=function(e){return!0},r.prototype.getGeoJson=function(){return null},r}(i),v=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.geometryType=h,n.prototype.getOverlayOptions=function(e){var t,n,r;return e==null&&(e={}),{clickable:(t=e.clickable)!=null?t:!0,zIndex:(n=e.zIndex)!=null?n:this.getDefaultZIndex(),icon:(r=e.icon)!=null?r:this.getIconUrl(e.zoom)}},n.prototype.initOverlay=function(e){return this.setOverlay(new w.Marker(this.getOverlayOptions(e)))},n.prototype.initEvents=function(e){var t,r=this;return e==null&&(e=this.overlay),n.__super__.initEvents.call(this,e),t=["animation_changed","clickable_changed","cursor_changed","drag","dragend","daggable_changed","dragstart","flat_changed","icon_changed","position_changed","shadow_changed","shape_changed","title_changed","visible_changed","zindex_changed"],t.forEach(function(t){return komoo.event.addListener(e,t,function(e,n){return komoo.event.trigger(r,t,e,n)})})},n.prototype.getCoordinates=function(){return this.getArrayFromLatLng(this.overlay.getPosition())},n.prototype.setCoordinates=function(e){return this.bounds=null,this.overlay.setPosition(this.getLatLngFromArray(e)),n.__super__.setCoordinates.call(this,e)},n.prototype.setEditable=function(e){return this.overlay.setDraggable(e)},n.prototype.getPosition=function(){return this.overlay.getPosition()},n.prototype.setPosition=function(e){return this.overlay.setPosition(e instanceof Array?this.getLatLngFromArray(e):e)},n.prototype.addMarker=function(e){return this.setOverlay(e)},n}(i),c=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.geometryType=a,n.prototype.getOverlayOptions=function(e){var t,n,r;return e==null&&(e={}),{clickable:(t=e.clickable)!=null?t:!0,zIndex:(n=e.zIndex)!=null?n:this.getDefaultZIndex(),icon:(r=e.icon)!=null?r:this.getIconUrl(e.zoom)}},n.prototype.initOverlay=function(e){return this.setOverlay(new MultiMarker(this.getOverlayOptions(e)))},n.prototype.getPoints=function(){return this.overlay.getMarkers().getArray()},n.prototype.setPoints=function(e){return this.overlay.addMarkers(e)},n.prototype.guaranteePoints=function(e){var t,n,r,i,s,o;n=this.overlay.getMarkers();if(n.length>=e){s=[];for(t=0,r=n.length-e-1;0<=r?t<=r:t>=r;0<=r?t++:t--)s.push(n.pop());return s}o=[];for(t=0,i=e-n.length-1;0<=i?t<=i:t>=i;0<=i?t++:t--)o.push(this.overlay.addMarker(new w.Marker(this.options)));return o},n.prototype.getCoordinates=function(){var e,t,n,r,i;r=this.getPoints(),i=[];for(t=0,n=r.length;t<n;t++)e=r[t],i.push(this.getArrayFromLatLng(e.getPosition()));return i},n.prototype.setCoordinates=function(e){var t,r,i,s;e[0]instanceof Array||(e=[e]),this.guaranteePoints(e.length),this.bounds=null,s=this.getPoints();for(t=0,i=s.length;t<i;t++)r=s[t],r.setPosition(this.getLatLngFromArray(e[t]));return n.__super__.setCoordinates.call(this,e)},n.prototype.setEditable=function(e){return this.overlay.setDraggable(e)},n.prototype.getPositions=function(){var e,t,n,r,i;r=this.getPoints(),i=[];for(t=0,n=r.length;t<n;t++)e=r[t],i.push(e.getPosition());return i},n.prototype.setPositions=function(e){return this.overlay.setPositions(e)},n.prototype.getMarkers=function(){return this.overlay.getMarkers()},n.prototype.addMarkers=function(e){return this.overlay.addMarkers(e)},n.prototype.addMarker=function(e){return this.overlay.addMarker(e)},n}(i),g=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.geometryType=h,n.prototype.getGeoJson=function(){return{type:a,coordinates:this.getCoordinates()}},n}(c),o=function(e){function n(e){n.__super__.constructor.call(this,e),this.handleEvents()}return t(n,e),n.prototype.geometryType=s,n.prototype.getOverlayOptions=function(e){var t,n,r,i,s;return e==null&&(e={}),{clickable:(t=e.clickable)!=null?t:!0,zIndex:(n=e.zIndex)!=null?n:this.getDefaultZIndex(),strokeColor:(r=e.strokeColor)!=null?r:this.getBorderColor(),strokOpacity:(i=e.strokeOpacity)!=null?i:this.getBorderOpacity(),strokeWeight:(s=e.strokeWeight)!=null?s:this.getBorderSize()}},n.prototype.initOverlay=function(e){return this.setOverlay(new w.Polyline(this.getOverlayOptions(e)))},n.prototype.handleEvents=function(){var e=this;return komoo.event.addListener(this,"mousemove",function(t){return e.setOptions({strokeWeight:e.getBorderSizeHover()})}),komoo.event.addListener(this,"mouseout",function(t){return e.setOptions({strokeWeight:e.getBorderSize()})})},n.prototype.getCoordinates=function(){var e,t,n,r,i;r=this.overlay.getPath().getArray(),i=[];for(t=0,n=r.length;t<n;t++)e=r[t],i.push(this.getArrayFromLatLng(e));return i},n.prototype.setCoordinates=function(e){var t;return this.overlay.setPath(function(){var n,r,i;i=[];for(n=0,r=e.length;n<r;n++)t=e[n],i.push(this.getLatLngFromArray(t));return i}.call(this))},n.prototype.setEditable=function(e){return this.overlay.setEditable(e)},n.prototype.getBorderColor=function(){var e;return((e=this.feature)!=null?e.getBorderColor():void 0)||b.BORDER_COLOR},n.prototype.getBorderOpacity=function(){var e;return((e=this.feature)!=null?e.getBorderOpacity():void 0)||b.BORDER_OPACITY},n.prototype.getBorderSize=function(){var e;return((e=this.feature)!=null?e.getBorderSize():void 0)||b.BORDER_SIZE},n.prototype.getBorderSizeHover=function(){var e;return((e=this.feature)!=null?e.getBorderSizeHover():void 0)||b.BORDER_SIZE_HOVER},n.prototype.getPath=function(){return this.overlay.getPath()},n.prototype.setPath=function(e){return this.overlay.setPath(e)},n}(i),l=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.geometryType=f,n.prototype.initOverlay=function(e){return this.setOverlay(new MultiPolyline(this.getOverlayOptions(e)))},n.prototype.guaranteeLines=function(e){var t,n,r,i,s,o;n=this.overlay.getPolylines();if(n.length>=e){s=[];for(t=0,r=n.length-e-1;0<=r?t<=r:t>=r;0<=r?t++:t--)s.push(n.pop());return s}o=[];for(t=0,i=e-n.length-1;0<=i?t<=i:t>=i;0<=i?t++:t--)o.push(this.overlay.addPolyline(new w.Polyline(this.options)));return o},n.prototype.getCoordinates=function(){var e,t,n,r,i;r=this.overlay.getPolylines().getArray(),i=[];for(t=0,n=r.length;t<n;t++)e=r[t],i.push(this.getArrayFromLatLngArray(e.getPath().getArray()));return i},n.prototype.setCoordinates=function(e){var t,n,r,i,s;e[0][0]instanceof Array||(e=[e]),this.guaranteeLines(e.length),this.bounds=null,i=this.getLines(),s=[];for(t=0,r=i.length;t<r;t++)n=i[t],s.push(n.setPath(this.getLatLngArrayFromArray(e[t])));return s},n.prototype.getBorderSize=function(){return n.__super__.getBorderSize.call(this)+1},n.prototype.getBorderSizeHover=function(){return n.__super__.getBorderSizeHover.call(this)+1},n.prototype.getPath=function(){return this.getPaths().getAt(0)},n.prototype.getPaths=function(){return this.overlay.getPaths()},n.prototype.setPaths=function(e){return this.overlay.setPaths(e)},n.prototype.getLines=function(){return this.overlay.getPolylines().getArray()},n.prototype.setLines=function(e){return this.overlay.addPolylines(e)},n.prototype.addPolyline=function(e,t){return this.overlay.addPolyline(e,t)},n.prototype.getPolylines=function(){return this.overlay.getPolylines()},n}(o),m=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.geometryType=p,n.prototype.getOverlayOptions=function(e){var t,n,r,i,s,o,u;return e==null&&(e={}),{clickable:(t=e.clickable)!=null?t:!0,zIndex:(n=e.zIndex)!=null?n:this.getDefaultZIndex(),fillColor:(r=e.fillColor)!=null?r:this.getBackgroundColor(),fillOpacity:(i=e.fillOpacity)!=null?i:this.getBackgroundOpacity(),strokeColor:(s=e.strokeColor)!=null?s:this.getBorderColor(),strokeOpacity:(o=e.strokeOpacity)!=null?o:this.getBorderOpacity(),strokeWeight:(u=e.strokeWeight)!=null?u:this.getBorderSize()}},n.prototype.initOverlay=function(e){return this.setOverlay(new w.Polygon(this.getOverlayOptions(e)))},n.prototype.getBackgroundColor=function(){var e;return((e=this.feature)!=null?e.getBackgroundColor():void 0)||b.BACKGROUND_COLOR},n.prototype.getBackgroundOpacity=function(){var e;return((e=this.feature)!=null?e.getBackgroundOpacity():void 0)||b.BACKGROUND_OPACITY},n.prototype.getCoordinates=function(){var e,t,n,r,i,s;e=[],s=this.overlay.getPaths().getArray();for(r=0,i=s.length;r<i;r++)t=s[r],n=this.getArrayFromLatLngArray(t.getArray()),n.length&&n.push(n[0]),n.length>0&&e.push(n);return e},n.prototype.setCoordinates=function(e){var t,n,r,i,s;n=[],this.bounds=null;for(i=0,s=e.length;i<s;i++)r=e[i],t=this.getLatLngArrayFromArray(r),t.pop(),n.push(t);return this.setPaths(n)},n.prototype.getPath=function(){return this.getPaths().getAt(0)},n.prototype.getPaths=function(){return this.overlay.getPaths()},n.prototype.setPaths=function(e){return this.overlay.setPaths(e)},n}(o),window.komoo.geometries={types:{EMPTY:n,POINT:h,MULTIPOINT:a,POLYGON:p,POLYLINE:d,LINESTRING:s,MULTIPOLYLINE:f,MULTILINESTRING:u},MultiMarker:MultiMarker,Geometry:i,Empty:r,Point:g,MultiPoint:c,LineString:o,MultiLineString:l,Polygon:m,defaults:b,makeGeometry:function(e,t){var n,i,s,o;s={feature:t};if(e.geometry==null)return new r(s);o=e.geometry.type,n=e.geometry.coordinates;if(o==="Point")i=new g(s);else if(o==="MultiPoint"||o==="marker")i=new c(s);else if(o==="LineString"||o==="polyline")n&&(n=[n]),i=new l(s);else if(o==="MultiLineString")i=new l(s);else if(o==="Polygon"||o==="polygon")i=new m(s);return n&&i!=null&&i.setCoordinates(n),i}},window.komoo.geometries})}.call(this),function(){define("core/map/features",["require","services/googlemaps","./geometries"],function(e){var t,n,r,i;return r=e("services/googlemaps"),n=e("./geometries"),window.komoo==null&&(window.komoo={}),(i=window.komoo).event==null&&(i.event=r.event),t=function(){function e(e){var t;this.options=e!=null?e:{},t=this.options.geometry,this.setFeatureType(this.options.featureType),this.options.geojson&&(this.options.geojson.properties&&this.setProperties(this.options.geojson.properties),t==null&&(t=n.makeGeometry(this.options.geojson,this))),t!=null&&(this.setGeometry(t),this.createMarker())}return e.prototype.displayTooltip=!0,e.prototype.displayInfoWindow=!0,e.prototype.createMarker=function(){var e;return e=new n.Point({visible:!0,clickable:!0}),e.setCoordinates(this.getCenter()),this.setMarker(e)},e.prototype.initEvents=function(e){var t,n;return e==null&&(e=this.geometry),n=this,t=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick","drag","dragend","draggable_changed","dragstart","coordinates_changed"],t.forEach(function(t){return komoo.event.addListener(e,t,function(e,r){return komoo.event.trigger(n,t,e,r)})})},e.prototype.getGeometry=function(){return this.geometry},e.prototype.setGeometry=function(e){return this.geometry=e,this.geometry.feature=this,this.initEvents()},e.prototype.getGeometryType=function(){return this.geometry.getGeometryType()},e.prototype.getFeatureType=function(){return this.featureType},e.prototype.setFeatureType=function(e){this.featureType=e!=null?e:{minZoomPoint:0,maxZoomPoint:10,minZoomIcon:10,maxZoomIcon:100,minZoomGeometry:0,maxZoomGeometry:100}},e.prototype.getMarker=function(){return this.marker},e.prototype.setMarker=function(e){return this.marker=e,this.marker.getOverlay().feature=this,this.initEvents(this.marker),this.marker},e.prototype.handleGeometryEvents=function(){var e=this;return komoo.event.addListener(this.geometry,"coordinates_changed",function(t){return e.updateIcon(),komoo.event.trigger(e,"coordinates_changed",t)})},e.prototype.getUrl=function(){var e;return this.properties.type==="OrganizationBranch"?e="view_organization":e="view_"+this.properties.type.toLowerCase(),dutils.urls.resolve(e,{id:this.properties.id}).replace("//","/")},e.prototype.isHighlighted=function(){return this.highlighted},e.prototype.highlight=function(){return this.setHighlight(!0)},e.prototype.setHighlight=function(e,t){t==null&&(t=!1);if(this.highlighted===e)return;this.highlighted=e,this.updateIcon();if(!t)return komoo.event.trigger(this,"highlight_changed",this.highlighted)},e.prototype.isNew=function(){return!this.getProperty("id")},e.prototype.getIconUrl=function(e){var t,n,r;return this.getProperty("image")?this.getProperty("image"):(e==null&&(e=this.map?this.map.getZoom():10),r=e>=this.featureType.minZoomIcon?"near":"far",n=this.isHighlighted()?"highlighted/":"",this.properties.categories&&this.properties.categories[0]&&this.properties.categories[0].name&&e>=this.featureType.minZoomIcon?t=this.properties.categories[0].name.toLowerCase()+(this.properties.categories.length>1?"-plus":""):t=this.properties.type.toLowerCase(),("/static/img/"+r+"/"+n+t+".png").replace(" ","-"))},e.prototype.updateIcon=function(e){return this.setIcon(this.getIconUrl(e))},e.prototype.getCategoriesIcons=function(){var e,t,n,r,i;r=this.properties.categories,i=[];for(t=0,n=r.length;t<n;t++)e=r[t],i.push("/static/img/need_categories/"+category.name.toLowerCase()+".png");return i},e.prototype.getProperties=function(){return this.properties},e.prototype.setProperties=function(e){this.properties=e},e.prototype.getProperty=function(e){return this.properties[e]},e.prototype.setProperty=function(e,t){return this.properties[e]=t},e.prototype.getType=function(){return this.getProperty("type")},e.prototype.getCategories=function(){var e;return(e=this.getProperty("categories"))!=null?e:[]},e.prototype.getGeometryGeoJson=function(){return this.geometry.getGeoJson()},e.prototype.getGeometryCollectionGeoJson=function(){return{type:"GeometryCollection",geometries:[this.getGeometryGeoJson()]}},e.prototype.getGeoJsonGeometry=function(){return this.getGeometryGeoJson()},e.prototype.getGeoJson=function(){return{type:"Feature",geometry:this.getGeometryGeoJson(),properties:this.getProperties()}},e.prototype.getGeoJsonFeature=function(){return this.getGeoJson()},e.prototype.setEditable=function(e){return this.editable=e,this.geometry.setEditable(this.editable)},e.prototype.showGeometry=function(){return this.geometry.setMap(this.map)},e.prototype.hideGeometry=function(){return this.geometry.setMap(null)},e.prototype.showMarker=function(){var e;return(e=this.marker)!=null?e.setMap(this.map):void 0},e.prototype.hideMarker=function(){var e;return(e=this.marker)!=null?e.setMap(this.map):void 0},e.prototype.getMap=function(){return this.map},e.prototype.setMap=function(e,t){var n,r;t==null&&(t={geometry:!1,point:!1,icon:!1}),this.oldMap=this.map,this.map=e;if(this.properties.alwaysVisible===!0||this.editable)t={geometry:!0,point:!1,icon:!1};n=this.map!=null?this.map.getZoom():0,(r=this.marker)!=null&&r.setMap(t.point||t.icon||this.featureType.minZoomPoint<=n&&n<=this.featureType.maxZoomPoint||this.featureType.minZoomIcon<=n&&n<=this.featureType.maxZoomIcon?this.map:null),this.geometry.setMap(t.geometry||n<=this.featureType.maxZoomGeometry&&n>=this.featureType.minZoomGeometry?this.map:null),this.updateIcon();if(this.oldMap===void 0)return this.handleMapEvents()},e.prototype.handleMapEvents=function(){var e=this;return this.map.subscribe("feature_highlight_changed",function(t,n){if(n===e)return;if(e.isHighlighted())return e.setHighlight(!1,!0)})},e.prototype.getBounds=function(){return this.geometry.getBounds()},e.prototype.removeFromMap=function(){var e;return(e=this.marker)!=null&&e.setMap(null),this.setMap(null)},e.prototype.remove=function(){return komoo.event.clearInstanceListeners(this.marker),komoo.event.clearInstanceListeners(this),this.removeFromMap()},e.prototype.setVisible=function(e){var t;return this.visible=e,(t=this.marker)!=null&&t.setVisible(this.visible),this.geometry.setVisible(this.visible)},e.prototype.getCenter=function(){return this.geometry.getCenter()},e.prototype.setOptions=function(e){return this.geometry.setOptions(e)},e.prototype.getIcon=function(){return this.geometry.getIcon()},e.prototype.setIcon=function(e){var t;return(t=this.marker)!=null&&t.setIcon(e),this.geometry.setIcon(e)},e.prototype.getBorderSize=function(){return this.featureType.border_size},e.prototype.getBorderSizeHover=function(){return this.featureType.borderSizeHover},e.prototype.getBorderColor=function(){return this.featureType.borderColor},e.prototype.getBorderOpacity=function(){return this.featureType.borderOpacity},e.prototype.getBackgroundColor=function(){return this.featureType.backgroundColor},e.prototype.getBackgroundOpacity=function(){return this.featureType.backgroundOpacity},e.prototype.getDefaultZIndex=function(){return this.featureType.zIndex},e}(),window.komoo.features={Feature:t,makeFeature:function(e,t){var n;return new komoo.features.Feature({geojson:e,featureType:t!=null?t[e!=null?(n=e.properties)!=null?n.type:void 0:void 0]:void 0})}},window.komoo.features})}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=Object.prototype.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},r=Array.prototype.indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("core/map/maps",["require","services/googlemaps","underscore","./core","./collections","./features","./geometries"],function(t){var i,s,o,u,a,f,l,c,h,p,d,v,m,g;return v=t("services/googlemaps"),m=t("underscore"),p=t("./core"),o=t("./collections"),a=t("./features"),d=t("./geometries"),window.komoo==null&&(window.komoo={}),(g=window.komoo).event==null&&(g.event=v.event),f=function(t){function i(t){var n,r,s,u,a=this;this.options=t!=null?t:{},this.addFeature=e(this.addFeature,this),i.__super__.constructor.call(this),this.initialized=this.data.deferred(),this.element=(u=this.options.element)!=null?u:document.getElementById(this.options.elementId),this.el=this.element,this.features=o.makeFeatureCollectionPlus({map:this}),this.components={},this.addComponent("core/map/controls::Location"),s=this.initGoogleMap(this.options.googleMapOptions),n=this.initFeatureTypes(),r=this.handleEvents(),this.data.when(s,n,r).done(function(){return a.initialized.resolve()}),this.data.when(this.initialized).done(function(){return $(a.element).trigger("initialized",a)})}return n(i,t),i.prototype.featureTypesUrl="/map_info/feature_types/",i.prototype.googleMapDefaultOptions={zoom:12,center:new v.LatLng(-23.55,-46.65),disableDefaultUI:!1,streetViewControl:!0,scaleControl:!0,panControlOptions:{position:v.ControlPosition.RIGHT_TOP},zoomControlOptions:{position:v.ControlPosition.RIGHT_TOP},scaleControlOptions:{position:v.ControlPosition.RIGHT_BOTTOM,style:v.ScaleControlStyle.DEFAULT},mapTypeControlOptions:{mapTypeIds:[v.MapTypeId.ROADMAP,v.MapTypeId.HYBRID]},mapTypeId:v.MapTypeId.HYBRID},i.prototype.remove=function(){return i.__super__.remove.apply(this,arguments),this.features.remove(),komoo.event.clearInstanceListeners(this.googleMap)},i.prototype.addControl=function(e,t){return this.googleMap.controls[e].push(t)},i.prototype.loadGeoJsonFromOptons=function(){var e=this;return this.data.when(this.initialized).done(function(){var t;if(e.options.geojson)return t=e.loadGeoJSON(e.options.geojson,e.options.zoom==null),e.subscribe("features_loaded",function(n){var r;if(n!==t)return;return r=t.getBounds(),r!=null&&(e.options.zoom==null?e.fitBounds(r):e.googleMap.setCenter(r.getCenter())),t!=null&&t.setMap(e,{geometry:!0,icon:!0}),e.publish("set_zoom",e.options.zoom),e.publish("features_loaded_from_options",t)})})},i.prototype.initGoogleMap=function(e){return e==null&&(e=this.googleMapDefaultOptions),this.googleMap=new v.Map(this.element,e),this.handleGoogleMapEvents()},i.prototype.handleGoogleMapEvents=function(){var e,t=this;return google.maps.event.addListenerOnce(this.googleMap,"idle",function(){return $(t.element).trigger("loaded",t)}),e=["click","idle"],e.forEach(function(e){return komoo.event.addListener(t.googleMap,e,function(n){return t.publish(e,n)})})},i.prototype.initFeatureTypes=function(){var e,t,n=this;return e=this.data.deferred(),this.featureTypes==null&&(this.featureTypes={}),this.options.featureTypes!=null?((t=this.options.featureTypes)!=null&&t.forEach(function(e){return n.featureTypes[e.type]=e}),this.loadGeoJsonFromOptons(),e.resolve()):$.ajax({url:this.featureTypesUrl,dataType:"json",success:function(t){return t.forEach(function(e){return n.featureTypes[e.type]=e}),n.loadGeoJsonFromOptons(),e.resolve()}}),e.promise()},i.prototype.handleEvents=function(){var e=this;return this.subscribe("features_loaded",function(t){return komoo.event.trigger(e,"features_loaded",t)}),this.subscribe("close_clicked",function(){return komoo.event.trigger(e,"close_click")}),this.subscribe("drawing_started",function(t){return komoo.event.trigger(e,"drawing_started",t)}),this.subscribe("drawing_finished",function(t,n){komoo.event.trigger(e,"drawing_finished",t,n);if(n===!1)return e.revertFeature(t);if(t.getProperty("id")==null)return e.addFeature(t)}),this.subscribe("set_location",function(t){var n;return t=t.split(","),n=new v.LatLng(t[0],t[1]),e.googleMap.setCenter(n)}),this.subscribe("set_zoom",function(t){return e.setZoom(t)})},i.prototype.addComponent=function(e,t,n){var r=this;return t==null&&(t="generic"),n==null&&(n={}),this.data.when(this.initialized).done(function(){return m.isString(e)?e=r.start(e,"",n):e=r.start(e),r.data.when(e).done(function(){var e,n,i,s,o;o=[];for(i=0,s=arguments.length;i<s;i++)e=arguments[i],e.setMap(r),(n=r.components)[t]==null&&(n[t]=[]),r.components[t].push(e),o.push(typeof e.enable=="function"?e.enable():void 0);return o})})},i.prototype.enableComponents=function(e){var t,n=this;return(t=this.components[e])!=null?t.forEach(function(e){return typeof e.enable=="function"?e.enable():void 0}):void 0},i.prototype.disableComponents=function(e){var t,n=this;return(t=this.components[e])!=null?t.forEach(function(e){return typeof e.disable=="function"?e.disable():void 0}):void 0},i.prototype.getComponentsStatus=function(e){var t,n,i=this;return t=[],(n=this.components[e])!=null&&n.forEach(function(e){if(e.enabled===!0)return t.push("enabled")}),r.call(t,"enabled")>=0?"enabled":"disabled"},i.prototype.clear=function(){return this.features.removeAllFromMap(),this.features.clear()},i.prototype.refresh=function(){return v.event.trigger(this.googleMap,"resize")},i.prototype.saveLocation=function(e,t){return e==null&&(e=this.googleMap.getCenter()),t==null&&(t=this.getZoom()),this.publish("save_location",e,t)},i.prototype.goToSavedLocation=function(){return this.publish("goto_saved_location"),!0},i.prototype.goToUserLocation=function(){return this.publish("goto_user_location")},i.prototype.handleFeatureEvents=function(e){var t,n=this;return t=["mouseover","mouseout","mousemove","click","dblclick","rightclick","highlight_changed"],t.forEach(function(t){return komoo.event.addListener(e,t,function(r){return n.publish("feature_"+t,r,e)})})},i.prototype.goTo=function(e,t){return t==null&&(t=!0),this.publish("goto",e,t)},i.prototype.panTo=function(e,t){return t==null&&(t=!1),this.goTo(e,t)},i.prototype.makeFeature=function(e,t){var n;return t==null&&(t=!0),n=a.makeFeature(e,this.featureTypes),t&&this.addFeature(n),this.publish("feature_created",n),n},i.prototype.addFeature=function(e){return this.handleFeatureEvents(e),this.features.push(e)},i.prototype.revertFeature=function(e){if(e.getProperty("id")==null)return e.setMap(null)},i.prototype.getFeatures=function(){return this.features},i.prototype.getFeaturesByType=function(e,t,n){return this.features.getByType(e,t,n)},i.prototype.showFeaturesByType=function(e,t,n){var r;return(r=this.getFeaturesByType(e,t,n))!=null?r.show():void 0},i.prototype.hideFeaturesByType=function(e,t,n){var r;return(r=this.getFeaturesByType(e,t,n))!=null?r.hide():void 0},i.prototype.showFeatures=function(e){return e==null&&(e=this.features),e.show()},i.prototype.hideFeatures=function(e){return e==null&&(e=this.features),e.hide()},i.prototype.centerFeature=function(e,t){var n;return n=e instanceof a.Feature?e:this.features.getById(e,t),this.panTo(n!=null?n.getCenter():void 0,!1)},i.prototype.loadGeoJson=function(e,t,n){var r,i=this;return t==null&&(t=!1),n==null&&(n=!0),r=o.makeFeatureCollection({map:this}),this.data.when(this.initialized).done(function(){var s,o;return(e!=null?e.type:void 0)==null||!e.type==="FeatureCollection"?r:((s=e.features)!=null&&s.forEach(function(e){var t;return t=i.features.getById(e.properties.type,e.properties.id),t==null&&(t=i.makeFeature(e,n)),r.push(t)}),t&&((o=r.getAt(0))!=null?o.getBounds():void 0)&&i.googleMap.fitBounds(r.getAt(0).getBounds()),i.publish("features_loaded",r))}),r},i.prototype.loadGeoJSON=function(e,t,n){return this.loadGeoJson(e,t,n)},i.prototype.getGeoJson=function(e){var t;return e==null&&(e={}),e.newOnly==null&&(e.newOnly=!1),e.currentOnly==null&&(e.currentOnly=!1),e.geometryCollection==null&&(e.geometryCollection=!1),t=e.newOnly?this.newFeatures:e.currentOnly?o.makeFeatureCollection({map:this.map,features:[this.currentFeature]}):this.features,t.getGeoJson({geometryCollection:e.geometryCollection})},i.prototype.getGeoJSON=function(e){return this.getGeoJson(e)},i.prototype.drawNewFeature=function(e,t){var n;return n=this.makeFeature({type:"Feature",geometry:{type:e},properties:{name:"New "+t,type:t}}),this.publish("draw_feature",e,n)},i.prototype.editFeature=function(e,t){var n=this;return this.data.when(this.initialized).then(function(){return e==null&&(e=n.features.getAt(0)),t!=null&&e.getGeometryType()===d.types.EMPTY?(e.setGeometry(d.makeGeometry({geometry:{type:t}})),n.publish("draw_feature",t,e)):n.publish("edit_feature",e)})},i.prototype.setMode=function(e){return this.mode=e,this.publish("mode_changed",this.mode)},i.prototype.selectCenter=function(e,t){return this.selectPerimeter(e,t)},i.prototype.selectPerimeter=function(e,t){return this.publish("select_perimeter",e,t)},i.prototype.highlightFeature=function(){return this.centerFeature.apply(this,arguments),this.features.highlightFeature.apply(this.features,arguments)},i.prototype.getBounds=function(){return this.googleMap.getBounds()},i.prototype.setZoom=function(e){if(e!=null)return this.googleMap.setZoom(e)},i.prototype.getZoom=function(){return this.googleMap.getZoom()},i.prototype.fitBounds=function(e){return e==null&&(e=this.features.getBounds()),this.googleMap.fitBounds(e)},i}(p.Mediator),h=function(e){function t(e){t.__super__.constructor.call(this,e),this.addComponent("core/map/maptypes::CleanMapType","mapType"),this.addComponent("core/map/controls::DrawingManager","drawing"),this.addComponent("core/map/controls::SearchBox")}return n(t,e),t}(f),u=function(e){function t(e){t.__super__.constructor.call(this,e),this.addComponent("core/map/maptypes::CleanMapType"),this.addComponent("core/map/controls::SaveLocation"),this.addComponent("core/map/controls::StreetView"),this.addComponent("core/map/controls::DrawingManager"),this.addComponent("core/map/controls::DrawingControl"),this.addComponent("core/map/controls::GeometrySelector"),this.addComponent("core/map/controls::SupporterBox"),this.addComponent("core/map/controls::PerimeterSelector"),this.addComponent("core/map/controls::SearchBox")}return n(t,e),t}(f),l=function(e){function t(){t.__super__.constructor.apply(this,arguments)}return n(t,e),t.prototype.googleMapDefaultOptions={zoom:12,center:new v.LatLng(-23.55,-46.65),disableDefaultUI:!0,streetViewControl:!1,scaleControl:!0,scaleControlOptions:{position:v.ControlPosition.RIGHT_BOTTOM,style:v.ScaleControlStyle.DEFAULT},mapTypeId:v.MapTypeId.HYBRID},t}(f),c=function(e){function t(e){t.__super__.constructor.call(this,e),this.addComponent("core/map/maptypes::CleanMapType","mapType"),this.addComponent("core/map/controls::AutosaveLocation"),this.addComponent("core/map/controls::StreetView"),this.addComponent("core/map/controls::Tooltip","tooltip"),this.addComponent("core/map/controls::InfoWindow","infoWindow"),this.addComponent("core/map/controls::SupporterBox"),this.addComponent("core/map/controls::LicenseBox"),this.addComponent("core/map/controls::SearchBox")}return n(t,e),t.prototype.loadGeoJson=function(e,n,r){var i,s=this;return n==null&&(n=!1),r==null&&(r=!0),i=t.__super__.loadGeoJson.call(this,e,n,r),i.forEach(function(e){return e.setMap(s,{geometry:!0})}),i},t}(f),s=function(e){function t(e){t.__super__.constructor.call(this,e),this.addComponent("core/map/providers::FeatureProvider","provider"),this.addComponent("core/map/controls::FeatureClusterer","clusterer",{featureType:"Community",map:this})}return n(t,e),t}(c),i=function(e){function t(e){var n;t.__super__.constructor.call(this,e),this.addComponent("core/map/controls::DrawingManager"),this.addComponent("core/map/controls::DrawingControl"),this.addComponent("core/map/controls::GeometrySelector"),this.addComponent("core/map/controls::PerimeterSelector"),(e!=null?(n=e.geojson)!=null?n.features:void 0:void 0)||this.goToSavedLocation()||this.goToUserLocation()}return n(t,e),t}(s),window.komoo.maps={Map:f,Preview:l,AjaxMap:s,makeMap:function(e){var t,n;e==null&&(e={}),t=(n=e.type)!=null?n:"map";if(t==="main")return new i(e);if(t==="editor")return new u(e);if(t==="view")return new s(e);if(t==="static")return new c(e);if(t==="preview"||t==="tooltip")return new l(e);if(t==="userEditor")return new h(e)}},window.komoo.maps})}.call(this),function(){define("map.jquery",["require","jquery"],function(e){var t;return t=e("jquery"),function(t){var n;return n={init:function(n){return this.each(function(){var r,i,s,o,u,a=this;r=t(this),r.addClass("komoo-map-googlemap"),i=t.extend({element:r.get(0)},t.fn.komooMap.defaults,n),i.width!=null&&r.width(i.width),i.height!=null&&r.height(i.height);if((i!=null?i.type:void 0)==="preview"&&!(i!=null?(s=i.geojson)!=null?(o=s.features)!=null?(u=o[0])!=null?u.geometry:void 0:void 0:void 0:void 0)&&(i!=null?!i.force:!void 0)){r.html(t("<div>").addClass("placeholder").text("Informação geométrica não disponível")),r.parent().parent().find(".see-on-map").hide();return}return e(["core/map/maps"],function(e){var t;t=e.makeMap(i),t.subscribe("features_loaded",function(e){return r.trigger("features_loaded",e)}),r.data("map",t);if(i.mapType!=null)return t.googleMap.setMapTypeId(i.mapType)})})},edit:function(e){var n;return(n=t(this).data("map"))!=null&&n.editFeature(e),t(this)},geojson:function(e){var n,r;return e==null?(n=t(this).data("map"))!=null?n.getGeoJson():void 0:(r=t(this).data("map"))!=null?r.loadGeoJson(e):void 0},goTo:function(e){var n,r;return(n=t(this).data("map"))!=null&&n.panTo((r=e.position)!=null?r:e.address,e.displayMarker),t(this)},highlight:function(e){var n;return(n=t(this).data("map"))!=null&&n.highlightFeature(e.type,e.id),t(this)},resize:function(){return t(window).resize(),t(this)},refresh:function(){var e;return(e=t(this).data("map"))!=null&&e.refresh(),t(this)},fit:function(){var e;return(e=t(this).data("map"))!=null&&e.fitBounds(),t(this)},center:function(){var e;return e=t(this).data("map"),e!=null&&e.googleMap.setCenter(e!=null?e.features.getCenter():void 0),t(this)},remove:function(){var e;return(e=t(this).data("map"))!=null&&e.remove(),t(this).empty(),t(this).html(""),t(this).remove(),t(this)},clear:function(){var e;return(e=t(this).data("map"))!=null&&e.clear(),t(this)}},t.fn.komooMap=function(e){return n[e]?n[e].apply(this,Array.prototype.slice.call(arguments,1)):typeof e=="object"||!e?n.init.apply(this,arguments):t.error("Method "+e+" does not exist on jQuery.komooMap")},t.fn.komooMap.defaults={type:"editor"}}(t)})}.call(this),function(){var e=Object.prototype.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("map/views",["require","jquery","underscore","backbone","app","core/mixins","map.jquery"],function(e){var n,r,i,s,o,u,a,f,l;return n=e("jquery"),l=e("underscore"),r=e("backbone"),u=e("app"),f=e("core/mixins"),e("map.jquery"),a={},i=function(e){function r(){r.__super__.constructor.apply(this,arguments)}return t(r,e),r.prototype.initialize=function(){var e,t,r,i,s,o,f=this;return window.d=this,this.listenTo(u,"error",this.onError),this.mapData==null&&(this.mapData={type:this.type}),{mapType:"roadmap",zoom:(e=this.options.zoom)!=null?e:16,geojson:(t=(r=this.options.geojson)!=null?r:(i=this.model)!=null?i.get("geojson"):void 0)!=null?t:{},width:(s=this.options.width)!=null?s:"100%",height:(o=this.options.height)!=null?o:"100%"},a[this.type]!=null?(this.mapElement=a[this.type],this.loaded=!0):(this.mapElement=n("<div>"),this.loaded=!1),this.mapElement.on("initialized",function(){return f.trigger("initialize")}),this.render(),window.pm=this},r.prototype.render=function(){var e=this;return this.mapElement.detach(),this.$el.html('<div class="loading">'+i18n("Loading...")+"</div>"),this.mapElement.one("features_loaded",function(t){e.mapElement.fadeTo(0,0),e.$el.empty().css({height:"100%"}).append(e.mapElement),e.refresh().fadeTo(100,1),a[e.type]=e.mapElement,e.loaded=!0;if(e.mode!=null)return e.setMode(e.mode)}),this.loaded?this.mapElement.komooMap("geojson",this.model.get("geojson")):this.mapElement.komooMap(this.mapData),this},r.prototype.onError=function(e){if(!this.loaded&&e.message.indexOf(!1))return this.$el.html('<div class="loading">'+i18n("Map unavailable!")+"</div>")},r.prototype.onOpen=function(){return this.refresh()},r.prototype.remove=function(){return this.mapElement.detach().unbind(),this.mapElement.komooMap("clear"),this.stopListening(),r.__super__.remove.apply(this,arguments)},r.prototype.refresh=function(){return this.mapElement.komooMap("refresh").komooMap("center")},r.prototype.getMap=function(){return this.mapElement.data("map")},r}(r.View),o=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),l.extend(n.prototype,f.EditOverlayMixin),n.prototype.type="preview",n.prototype.events={"click .overlay > .edit":"edit"},n.prototype.initialize=function(){var e,t,r;return this.mapData={type:this.type,mapType:"roadmap",zoom:(e=this.options.zoom)!=null?e:16,geojson:this.model.get("geojson"),width:(t=this.options.width)!=null?t:"100%",height:(r=this.options.height)!=null?r:"100%"},n.__super__.initialize.apply(this,arguments)},n.prototype.edit=function(e){return e.preventDefault(),alert("sss")},n}(i),s=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.type="main",n.prototype.initialize=function(){var e,t,r,i,s,o;return this.mapData={type:this.type,mapType:"roadmap",zoom:(e=this.options.zoom)!=null?e:16,geojson:(t=(r=this.options.geojson)!=null?r:(i=this.model)!=null?i.get("geojson"):void 0)!=null?t:{},width:(s=this.options.width)!=null?s:"100%",height:(o=this.options.height)!=null?o:"100%"},n.__super__.initialize.apply(this,arguments)},n}(i),{Preview:o,Editor:s}})}.call(this),define("text!templates/main/_upper_bar.html",[],function(){return'<section class="upper-bar">\n  <form action="#" class="search">\n    <input type="text" name="query" placeholder="<% i18n(\'Search\') %>" value="" />\n    <input type="submit" value="<%= i18n(\'See results\') %>" />\n  </form>\n  <ul class="nav">\n  <li><a href="http://pt.wikibooks.org/wiki/MootiroMaps" target="_blank" class="help"><%= i18n(\'Help\') %></a></li>\n  <% if (KomooNS.isAuthenticated) { %>\n    <li><a href="<%= user.url %>" class="user"><%= user.name %></a></li>\n    <li><a href="#" class="logout"><%= i18n(\'Logout\') %></a></li>\n  <% } else { %>\n    <li><a href="#" class="login login-required" ><%= i18n(\'Login\') %></a></li>\n  <% } %>\n  </ul>\n</section>\n'}),define("text!templates/main/_header.html",[],function(){return'<header class="main">\n\n  <div class="content">\n\n    <div id="upper-bar-container"></div>\n\n    <h1 class="logo"><a href="/" title="Página principal">MootiroMaps</a></h1>\n\n    <nav>\n      <ul>\n        <li class="map"><a href="#">Mapa</a></li>\n        <li class="communities"><a href="#">Comunidades</a></li>\n        <li class="places has-submenu">\n          <a href="#">Locais</a>\n          <ul>\n            <li class="needs"><a href="#">Necessidades</a></li>\n            <li class="organizations"><a href="#">Organizações</a></li>\n            <li class="resources"><a href="#">Recursos</a></li>\n            <li class="investments"><a href="#">Investimentos</a></li>\n          </ul>\n        </li>\n        <li class="projects"><a href="#">Projetos</a></li>\n      </ul>\n    </nav>\n\n  </div>\n\n</header>\n'}),define("text!templates/main/_footer.html",[],function(){return'<section class="footer">\n  <hr />\n  <div>\n    <h3><%= i18n(\'More about\') %></h3>\n    <ul>\n      <li><a href="/about"><%= i18n(\'About MootiroMaps\') %></a></li>\n      <li><%= i18n(\'About Us\') %></li>\n      <li><%= i18n(\'Get Involved\') %></li>\n    </ul>\n  </div>\n  <div class="supporters">\n    <h3><%= i18n(\'Supporters\') %></h3>\n    <a href="http://www.institutocea.org.br/" target="_blank"><img class="cea-logo" src="<%= KomooNS.staticUrl %>img/supporters/cea-footer.png" alt="Instituto C&amp;A" width="104" height="100" /></a>\n  </div>\n  <div class="license">\n    <strong>Licença:</strong> Este texto é disponibilizado nos termos da licença <a href="http://creativecommons.org/licenses/by-sa/3.0/deed.pt_BR">Creative Commons - Atribuição - Partilha nos Mesmos Termos 3.0 Não Adaptada</a>; pode estar sujeito a condições adicionais. Para mais detalhes, consulte as Condições de Uso.\n  </div>\n</section>\n'}),define("text!templates/main/_action_bar.html",[],function(){return'<% _.each(actions, function(item) {\n    if (hasPermission(item.action)) {\n%>\n<li><a class="<%= item.action %>" data-action="<%= item.action %>" href="#" title="<%= item.label %>"><%= item.label %></a></li>\n<%\n    }\n  });\n%>\n'}),define("text!templates/main/_map_editor.html",[],function(){return'<div id="map-editor">\n  <div class="sidebar controls"></div>\n  <div id="map-container" class="map"></div>\n</div>\n'}),function(){var e=Object.prototype.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("main/views",["require","jquery","underscore","backbone","app","urls","map/views","text!templates/main/_upper_bar.html","text!templates/main/_header.html","text!templates/main/_footer.html","text!templates/main/_action_bar.html","text!templates/main/_map_editor.html"],function(e){var n,r,i,s,o,u,a,f,l,c,h,p;return n=e("jquery"),p=e("underscore"),i=e("backbone"),l=e("app"),h=e("urls"),c=e("map/views"),s=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.tagName="span",n.prototype.className="feedback",n.prototype.delay=100,n.prototype.initialize=function(){var e=this;return this.$el.hide(),this.listenTo(l,"working",function(){return e.open(i18n("Working..."))}),this.listenTo(l,"done",function(){return e.close()}),this.render()},n.prototype.open=function(e){var t=this;return this.$el.html(e),this.delayed==null&&(this.delayed=setTimeout(function(){return t.$el.css({display:"inline"})},this.delay)),this},n.prototype.close=function(){return clearTimeout(this.delayed),this.delayed=null,this.$el.fadeOut(),this},n}(i.View),f=function(n){function r(){r.__super__.constructor.apply(this,arguments)}return t(r,n),r.prototype.template=p.template(e("text!templates/main/_upper_bar.html")),r.prototype.events={"click .login":"login","click .logout":"logout","click .user":"profile"},r.prototype.initialize=function(){var e=this;return p.bindAll(this),this.listenTo(this.model,"change",this.render),this.listenTo(l,"change",function(t){if(e.model.id===t.id&&e.model.constructor===t.constructor)return e.model.fetch()}),this.render()},r.prototype.render=function(){return this.$el.html(this.template({user:this.model.toJSON()})),this},r.prototype.login=function(e){return e!=null&&e.preventDefault(),l.trigger("login",window.location.href),this},r.prototype.logout=function(e){return e!=null&&e.preventDefault(),l.trigger("logout",window.location.href),this},r.prototype.profile=function(e){var t;return e!=null&&e.preventDefault(),t=new this.model.constructor(this.model.toJSON()),t.view(),this},r}(i.View),u=function(r){function i(){i.__super__.constructor.apply(this,arguments)}return t(i,r),i.prototype.template=p.template(e("text!templates/main/_header.html")),i.prototype.events={"click .logo a":"root","click nav a":"nav"},i.prototype.urls={".map":h.resolve("map")},i.prototype.initialize=function(){return p.bindAll(this),this.subViews=[],this.subViews.push(new f({model:this.model,parentSelector:"#upper-bar-container"})),this.render()},i.prototype.setUrls=function(){var e,t;t=[];for(e in this.urls)t.push(this.$(""+e+" a").attr({href:this.urls[e]}));return t},i.prototype.render=function(){var e,t,n,r,i,s,o;s=this.subViews;for(t=0,r=s.length;t<r;t++)e=s[t],e.$el.detach();this.$el.html(this.template({user:this.model.toJSON()})),this.setUrls(),o=this.subViews;for(n=0,i=o.length;n<i;n++)e=o[n],this.$(e.options.parentSelector).append(e.$el);return this},i.prototype.root=function(e){return e!=null&&e.preventDefault(),l.goTo("")},i.prototype.nav=function(e){var t;return e!=null&&e.preventDefault(),t=n(e.target).attr("href"),l.goTo(t)},i}(i.View),o=function(n){function r(){r.__super__.constructor.apply(this,arguments)}return t(r,n),r.prototype.template=p.template(e("text!templates/main/_footer.html")),r.prototype.initialize=function(){return p.bindAll(this),this.render()},r.prototype.render=function(){return this.$el.html(this.template()),this},r}(i.View),r=function(r){function i(){i.__super__.constructor.apply(this,arguments)}return t(i,r),i.prototype.template=p.template(e("text!templates/main/_action_bar.html")),i.prototype.tagName="ul",i.prototype.events={"click a":"do"},i.prototype.actions=[{action:"edit",label:i18n("Edit")},{action:"rate",label:i18n("Rate")},{action:"discuss",label:i18n("Discuss")},{action:"history",label:i18n("History")},{action:"report",label:i18n("Report")},{action:"delete",label:i18n("Delete")}],i.prototype.initialize=function(){return p.bindAll(this),this.mode=this.options.mode,this.listenTo(this.model,"change",this.render),this.listenTo(l,"login logout change:session",this.render),this.render()},i.prototype.render=function(){return this.$el.html(this.template({actions:this.actions,model:this.model.toJSON(),hasPermission:p.bind(this.model.hasPermission,this.model)})),this.setMode(this.mode),this},i.prototype["do"]=function(e){var t,r,i,s;return e.preventDefault(),t=n(e.target).hasClass("active")?"show":n(e.target).attr("data-action"),r=typeof (i=this.model)[s=""+t+"Url"]=="function"?i[s]():void 0,l.goTo(r)},i.prototype.setMode=function(e){return this.mode=e,this.$(".active").removeClass("active"),this.$("a[data-action="+e+"]").addClass("active")},i}(i.View),a=function(r){function i(){i.__super__.constructor.apply(this,arguments)}return t(i,r),i.prototype.template=p.template(e("text!templates/main/_map_editor.html")),i.prototype.className="map-editor",i.prototype.initialize=function(){var e=this;return p.bindAll(this),this.subViews=[],this.mapEditor=new c.Editor({parentSelector:"#map-container"}),this.subViews.push(this.mapEditor),this.listenTo(this.mapEditor,"initialize",function(){return e.trigger("initialize")}),n(window).resize(this.resizeElement),this.render()},i.prototype.resizeElement=function(){var e,t,r,i;return t=n("#header-container"),i=t.offset().top+t.height(),e=n(document).height(),r=e-i,this.$("#map-editor").css({height:r})},i.prototype.render=function(){var e,t,n,r,i,s,o;s=this.subViews;for(t=0,r=s.length;t<r;t++)e=s[t],e.$el.detach();this.$el.html(this.template({})),o=this.subViews;for(n=0,i=o.length;n<i;n++)e=o[n],this.$(e.options.parentSelector).append(e.$el);return this.resizeElement(),this},i.prototype.getMap=function(){return this.mapEditor.getMap()},i}(i.View),{Header:u,Footer:o,UpperBar:f,ActionBar:r,Feedback:s,MapEditor:a}})}.call(this),function(){define("main/pages",["require","core/page_manager"],function(e){var t,n,r;return n=e("core/page_manager"),r={render:function(){var e;return e=new n.Page,n.open(e)}},t={render:function(){var e;return e=new n.Page,n.open(e)}},{root:r,error:t}})}.call(this),function(){var e=Object.prototype.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("main/router",["require","underscore","backbone","app","core/page_manager","./pages"],function(e){var n,r,i,s,o,u;return u=e("underscore"),n=e("backbone"),i=e("app"),s=e("core/page_manager"),o=e("./pages"),r=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.routes={"":"root"},n.prototype.initialize=function(){return u.bindAll(this),this.bindExternalEvents()},n.prototype.bindExternalEvents=function(){return i.on("open:root",this.root),i.on("open:error",this.error)},n.prototype.goTo=function(e,t){var n=this;return $.when(s.canClose()).done(function(){return n.navigate(e),$.when(t.render()).fail(function(e){return i.trigger("open:error",e.status,e.statusText)})})},n.prototype.root=function(){return this.goTo("",o.root)},n.prototype.error=function(e,t){return o.error.render(),alert(""+e+" "+t+" <TODO: render the error page>")},n}(n.Router),r})}.call(this),function(){var e,t,n,r,i,s,o,u,a,f,l,c,h;l='<form action="" method="post" id="<%= formId %>" >\n    <div>\n        <input type="submit" name="submit" value="<%=submit_label%>" />\n    </div>\n</form>',f='<div class="field-container <%=container_class%>" for="<%=name%>" >\n    <label><%=label%></label>\n    <div class="widget-container">\n    </div>\n</div>',c='<input type="<%=type%>" name="<%=name%>" value="<%=value%>" id="id_<%=name%>" <%=attrs%> />',h='<textarea name="<%=name%>" id="id_<%=name%>" <%=attrs%>><%=value%></textarea>',u='<label>\n  <input type="checkbox" name="<%=name%>" value="<%=choice_value%>" id="id_<%=name%>_<%=choice_num%>" class="checkbox" />\n  <%=choice_title%>\n</label>',a='<select name="<%=name%>" id="id_<%=name%>" <%=attrs%>>\n  <%_.each(choices, function (choice) {%>\n    <option value="<%=choice.value%>" <%=choice.attrs%>><%=choice.title%></option>\n  <% }); %>\n</select>',o=Backbone.View.extend({initialize:function(){var e;return _.bindAll(this),this._template=_.template(this.template),(e=this.options).attrs==null&&(e.attrs=""),this.name=this.options.name},render:function(){return this.$el.html(this._template(this.options)),typeof this.behavior=="function"&&this.behavior(),this},getInputElement:function(){return this.$("input[name="+this.name+"]")},set:function(e){return this.getInputElement().val(e)},get:function(){return this.getInputElement().val()}}),s=o.extend({template:c,initialize:function(){return this.options.type="text",o.prototype.initialize.apply(this,arguments)}}),r=o.extend({template:c,initialize:function(){return this.options.type="password",this.options.value="",this.options.attrs='autocomplete="off"',o.prototype.initialize.apply(this,arguments)}}),i=o.extend({template:h,getInputElement:function(){return this.$("textarea")}}),e=o.extend({template:u,render:function(){var e,t,n,r,i;this.$el.html(""),i=this.options.choices;for(t in i)n=i[t],e=_.extend(this.options,{choice_value:n.value,choice_title:n.title,choice_num:t+1}),r=this._template(e),this.$el.append(r);return this},set:function(e){return e?this.$("input[value="+e+"]").attr("checked",!0):this.$(":checked").attr("checked",!1)},get:function(){var e;return e=this.$(":checked"),e.length?e.val():""}}),t=o.extend({template:a,initialize:function(){var e;return(e=this.options).choices==null&&(e.choices=[]),o.prototype.initialize.apply(this,arguments)},getInputElement:function(){return this.$("select[name="+this.options.name+"]")}}),n=Backbone.View.extend({template:l,initialize:function(){var e,t,n,r,i,s;_.bindAll(this),this._template=_.template(this.template);if((n=this.options)!=null?n.model:void 0)this.model=this.options.model;this.patch=(r=(i=this.options)!=null?i.patch:void 0)!=null?r:!1,this.renderedFields=[],this.instances={},this.on("submit",this.save);if(this.events!=null){s=this.events;for(t in s)e=s[t],this.on(t,this[e])}return this.initializeFields()},render:function(){var e,t,n,r,i,s,o,u,a,f,l,c,h=this;a=this.renderedFields;for(i=0,o=a.length;i<o;i++)t=a[i],t.detach();e=((f=this.options)!=null?f.formId:void 0)||"",r=((l=this.options)!=null?l.submit_label:void 0)||(_.isFunction(window.i18n)?i18n("send"):"send"),n=this._template({formId:e,submit_label:r}),this.$el.html(n),c=this.renderedFields;for(s=0,u=c.length;s<u;s++)t=c[s],this.$("form").prepend(t);return this.$("form").submit(function(e){return e.preventDefault(),h.trigger("submit")}),this.model&&this.set(this.model.toJSON()),this},remove:function(){return Backbone.View.prototype.initialize.apply(this,arguments),this.clearInstances(),this.clearRenderedFields()},clearInstances:function(){var e,t,n,r;n=this.instances,r=[];for(t in n)e=n[t],e.remove(),r.push(this.instances[t]=null);return r},clearRenderedFields:function(){var e,t,n,r;r=this.renderedFields;for(t=0,n=r.length;t<n;t++)e=r[t],e.remove();return this.renderedFields.length=0},initializeFields:function(){var e,t,n,r,i,s,o,u,a,l;a=this.fields.slice(0).reverse(),l=[];for(o=0,u=a.length;o<u;o++)n=a[o],e={name:n.name,input_id:"id_"+n.name,label:n.label||"",value:n.value||"",container_class:n.container_class||""},e=_.extend(e,n.args||{}),i=new n.widget(e),this.instances[n.name]=i,s=_.template(f),t=$("<div>").html(s(e)),r=t.children().detach(),r.find(".widget-container").append(i.render().el),this.$("form").prepend(r),this.renderedFields.push(r),this.model?l.push(this.set(this.model.toJSON())):l.push(void 0);return l},disableSubmit:function(){return this.$("input[type=submit]").attr("disabled","disabled")},enableSubmit:function(){return this.$("input[type=submit]").removeAttr("disabled")},save:function(){var e=this;return this.disableSubmit(),this.model.save(this.get(),{wait:!0,patch:this.patch,success:function(t,n){return e.cleanErrors(),e.enableSubmit(),n.redirect&&(window.location.pathname===n.redirect?window.location.reload():window.location=n.redirect),e.trigger("success",n)},error:function(t,n){return e.enableSubmit(),n=JSON.parse(n.responseText),e.cleanErrors(),e.errors(n.errors||{}),e.trigger("error",n)}})},errors:function(e){var t,n,r,i;this._errors==null&&(this._errors={});if(!e)return this._errors;this._errors=_.extend(this._errors,e);for(r in e)n=e[r],r==="__all__"&&(i=this.$("input[type=submit]"),i.length&&!i.parent().find("small.error").length&&i.before("<small class='error'>"+n+"</small>")),t=this.$(".field-container[for="+r+"]"),t.find("#id_"+r).addClass("error"),t.find("label").addClass("error"),t.find("small.error").length||t.find(".widget-container").after("<small class='error'>"+n+"</smalll>")},cleanErrors:function(){return this.$("small.error").remove(),this.$(".error").removeClass("error")},get:function(e){var t,n,r,i,s;e==null&&(e="__all__");if(e==="__all__"){n={},s=this.fields;for(r=0,i=s.length;r<i;r++)t=s[r],n[t.name]=this.instances[t.name].get();return n}return t=_.find(this.fields,function(t){return t.name===e}),this.instances[t.name].get()},set:function(e){var t,n,r,i,s;e==null&&(e={}),s=[];for(n in e)r=e[n],t=_.find(this.fields,function(e){return e.name===n}),s.push((i=this.instances[t!=null?t.name:void 0])!=null?typeof i.set=="function"?i.set(r):void 0:void 0);return s}}),window.ReForm={Form:n,Widget:o,commonWidgets:{TextWidget:s,PasswordWidget:r,TextAreaWidget:i,CheckboxWidget:e,DropdownWidget:t}},typeof define=="function"&&define.amd&&define("reForm",[],function(){return window.ReForm})}.call(this),function(){var e=Object.prototype.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("authentication/models",["require","jquery","underscore","backbone","urls"],function(e){var n,r,i,s,o,u,a;return n=e("jquery"),a=e("underscore"),r=e("backbone"),u=e("urls"),i=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.urlRoot=u.resolve("login_api"),n}(r.Model),s=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.urlRoot=u.resolve("logout_api"),n.prototype.initialize=function(){return a.bindAll(this)},n.prototype.doLogout=function(e){var t=this;return this.set({next:e}),r.sync("read",this,{data:{next:e},success:function(e,t,n){if(t.redirect)return window.location.pathname===t.redirect?window.location.reload():window.location=t.redirect}})},n}(r.Model),o=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.urlRoot=u.resolve("user_api"),n}(r.Model),{LoginModel:i,LogoutModel:s,User:o}})}.call(this),define("text!templates/widgets/_signup.html",[],function(){return'<span class="small">\n  <a href="#register" class="auth-register"><%= i18n("Don\'t have an account? <strong>Sign Up</strong>") %><a/>\n</span>\n\n'}),define("text!templates/widgets/_signin.html",[],function(){return'\n<span class="small">\n  <a href="#login" class="auth-login"> <%= i18n(\'Already has an account? <strong>Sign In</strong>\') %><a/>\n</span>\n\n'}),function(){var e=Object.prototype.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("authentication/forms",["require","reForm","text!templates/widgets/_signup.html","text!templates/widgets/_signin.html"],function(e){var n,r,i,s,o,u,a;return o=e("reForm"),a=e("text!templates/widgets/_signup.html"),u=e("text!templates/widgets/_signin.html"),s=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.template=a,n.prototype.get=function(){return""},n}(o.Widget),i=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.template=u,n.prototype.get=function(){return""},n}(o.Widget),n=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.fields=[{name:"email",widget:o.commonWidgets.TextWidget,label:i18n("Email")},{name:"password",widget:o.commonWidgets.PasswordWidget,label:i18n("Password")},{name:"signup",widget:s}],n.prototype.render=function(){var e=this;return n.__super__.render.apply(this,arguments),this.$el.find(".auth-register").bind("click",function(t){return t.preventDefault(),e.trigger("register-link:click"),!1}),this},n}(o.Form),r=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.fields=[{name:"name",widget:o.commonWidgets.TextWidget,label:i18n("Name")},{name:"email",widget:o.commonWidgets.TextWidget,label:i18n("Email")},{name:"password",widget:o.commonWidgets.PasswordWidget,label:i18n("Password"),container_class:"half-box-left"},{name:"password_confirm",widget:o.commonWidgets.PasswordWidget,label:i18n("Password Confirmation"),container_class:"half-box-right"},{name:"license",widget:o.commonWidgets.CheckboxWidget,args:{choices:[{value:"agree",title:i18n('I\'ve read and accept the <a href="http://mootiro.org/terms">License Terms.</a>')}]}},{name:"signin",widget:i}],n.prototype.render=function(){var e=this;return n.__super__.render.apply(this,arguments),this.$el.find(".auth-login").bind("click",function(t){return t.preventDefault(),e.trigger("login-link:click"),!1}),this},n}(o.Form),{LoginForm:n,RegisterForm:r}})}.call(this),define("text!templates/authentication/_social_button.html",[],function(){return'<a href="<%= url %>" class="button fixed <%= provider %>">\n  <%= msg %>\n</a>\n'}),define("text!templates/authentication/_login.html",[],function(){return'  <div>\n    <div class="social_buttons"></div>\n\n    <div class="separator">\n      <div class="vertical_line top"></div>\n      <span><%= i18n(\'or\') %></span>\n      <div class="vertical_line bottom"></div>\n    </div>\n\n    <div class="login_form"></div>\n  </div>\n\n  <div class="clear-both"></div>\n\n'}),define("text!templates/authentication/_register.html",[],function(){return'<div class="form-wrapper"></div>\n'}),define("text!templates/authentication/_verified.html",[],function(){return'<div class="auth-verified">\n  <div class="half-box-left verified-msg">\n      <p><%= i18n(\'Your email was successfully verified.\') %></p>\n      <p><%= i18n(\'Please login.\') %></p>\n  </div>\n  <div class="half-box-right login-form-box"></div>\n</div>\n'}),define("text!templates/authentication/_not_verified.html",[],function(){return'<section class="auth-not-verified">\n  <img src="/static/img/spock-email.png" alt="check your email image" width="210" height="238" />\n  <article>\n  <header><h1><%= i18n(\'Your account was created!\')%></h1></header>\n\n    <p><%= i18n(\'But before using, you have to confirm your email\')%>.</p>\n    <p><%= i18n(\'Please go check your mail box\') %>.</p>\n  </article>\n</section>\n'}),function(){var e=Object.prototype.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("authentication/views",["require","underscore","backbone","./models","./forms","urls","text!templates/authentication/_social_button.html","text!templates/authentication/_login.html","text!templates/authentication/_register.html","text!templates/authentication/_verified.html","text!templates/authentication/_not_verified.html"],function(e){var n,r,i,s,o,u,a,f,l,c,h;return h=e("underscore"),n=e("backbone"),l=e("./models"),f=e("./forms"),c=e("urls"),o=function(n){function r(){r.__super__.constructor.apply(this,arguments)}return t(r,n),r.prototype.tagName="li",r.prototype.initialize=function(){return h.bindAll(this),this.template=h.template(e("text!templates/authentication/_social_button.html")),this.className=this.options.provider,this.url=""+this.options.url+"?next="+(this.options.next||""),this.msg=this.options.message,this.provider=this.options.provider},r.prototype.render=function(){return this.$el.html(this.template({provider:this.provider,url:this.url,msg:this.msg})),this.$el.addClass(this.className),this},r}(n.View),u=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.tagName="ul",n.prototype.className="external_providers",n.prototype.initialize=function(){return h.bindAll(this,"render"),this.buttons=this.options.buttons},n.prototype.render=function(){var e=this;return this.$el.html(""),h.each(this.buttons,function(t){var n;return n=new o(t),e.$el.append(n.render().el)}),this},n}(n.View),r=function(n){function r(){r.__super__.constructor.apply(this,arguments)}return t(r,n),r.prototype.className="login_box",r.prototype.tagName="section",r.prototype.initialize=function(){var t,n;return h.bindAll(this),this.template=h.template(e("text!templates/authentication/_login.html")),t=((n=this.options)!=null?n.next:void 0)||"",this.buildButtons(t),this.model=new l.LoginModel({}),this.form=new f.LoginForm({formId:"form_login",model:this.model})},r.prototype.render=function(){return this.$el.html(this.template({})),this.$(".social_buttons").append(this.socialBtnsView.render().el),this.$(".login_form").append(this.form.render().el),this},r.prototype.buildButtons=function(e){var t,n;return e==null&&(e=""),n={provider:"google",url:c.resolve("login_google"),next:e,message:i18n("Log In with Google")},t={provider:"facebook",url:c.resolve("login_facebook"),next:e,message:i18n("Log In with Facebook")},this.socialBtnsView=new u({buttons:[n,t]}),this},r.prototype.updateUrls=function(e){return e==null&&(e=""),this.model.set({next:e}),this.buildButtons(e),this.render(),this},r}(n.View),i=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(e){return this.options=e,h.bindAll(this),this.model=new l.LogoutModel({}),window.logoutmodel=this.model},n.prototype.logout=function(e){return this.model.doLogout(e)},n}(n.View),s=function(n){function r(){r.__super__.constructor.apply(this,arguments)}return t(r,n),r.prototype.className="register",r.prototype.tagName="section",r.prototype.initialize=function(){var t;return h.bindAll(this),this.template=h.template(e("text!templates/authentication/_register.html")),t=new l.User({}),this.form=new f.RegisterForm({formId:"form_register",submit_label:i18n("Register"),model:t})},r.prototype.render=function(){return this.$el.html(this.template({})),this.$(".form-wrapper").append(this.form.render().el),this},r}(n.View),a=function(n){function r(){r.__super__.constructor.apply(this,arguments)}return t(r,n),r.prototype.initialize=function(){return h.bindAll(this),this.verified=this.options.verified,this.verified?(this.template=h.template(e("text!templates/authentication/_verified.html")),this.loginModel=new l.LoginModel({}),this.loginForm=new f.LoginForm({model:this.loginModel})):this.template=h.template(e("text!templates/authentication/_not_verified.html"))},r.prototype.render=function(){return this.$el.html(this.template({})),this.verified&&this.$(".login-form-box").append(this.loginForm.render().el),this},r}(n.View),{LoginView:r,LogoutView:i,RegisterView:s,VerificationView:a}})}.call(this),function(){define("utils",["require","jquery","underscore","backbone"],function(e){var t,n,r,i,s;return t=e("jquery"),s=e("underscore"),n=e("backbone"),i=function(e){var n;if(!t('link[href="'+e+'"]').length)return typeof console!="undefined"&&console!==null&&typeof console.log=="function"&&console.log("Loading css: ",e),n=document.createElement("link"),n.type="text/css",n.rel="stylesheet",n.href=e,document.getElementsByTagName("head")[0].appendChild(n)},r=function(e,n,r,i){var s;return this.tabs=e,this.contents=n,this.selectedClass=i||"selected",this.onChange=r||function(e){return{}},t(n).hide(),s=this,t(e).click(function(){return s.to(this),!1}),this.length=t(e).length,this.to(t(e)[0]),this.initialized=!0},r.prototype.to=function(e){var n;t(this.tabs).removeClass(this.selectedClass),t(this.contents).removeClass(this.selectedClass).hide(),n=t(e).attr("href")||t(e).children().attr("href"),t("*[href="+n+"]").parent().addClass(this.selectedClass),t(n).addClass(this.selectedClass).show(),this.current=e;if(this.onChange&&this.initialized)return this.onChange(this)},r.prototype.getCurrentTabIndex=function(){return t(this.tabs).index(this.current)},{loadCss:i,Tabs:r}})}.call(this),define("text!templates/widgets/_modal_box.html",[],function(){return'<div id="<%= modal_id %>" class="modal" style="display: none">\n  <div class="modal-bg"></div>\n  <div class="dialog-container">\n    <article class="dialog">\n      <header>\n        <button class="close">Fechar</button>\n        <h1><%= title %></h1>\n      </header>\n      <section class="content"></section>\n    </article>\n  </div>\n</div>\n'}),function(){var e=Object.prototype.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("widgets/modal",["require","jquery","underscore","backbone","utils","text!templates/widgets/_modal_box.html"],function(e){var n,r,i,s,o;return n=e("jquery"),o=e("underscore"),r=e("backbone"),s=e("utils"),i=function(r){function i(){i.__super__.constructor.apply(this,arguments)}return t(i,r),i.prototype.template=o.template(e("text!templates/widgets/_modal_box.html")),i.prototype.events={"click .close":"close","click .modal-bg":"close"},i.prototype.initialize=function(){var e;return o.bindAll(this),this.tpl_args=o.extend({tile:"",modal_id:"modal-box"},this.options),this.content=(e=this.options.content)!=null?e:"",this.options.width&&(this.width=this.options.width),this.render()},i.prototype.render=function(){return this.$el.html(this.template(this.tpl_args)),n("body").append(this.el),this.$(".content").append(this.content),this.modal=this.$("#"+this.tpl_args.modal_id),this.width!=null&&this.modal.find(".dialog").css("width",this.width),this},i.prototype.open=function(){return this.modal.fadeIn(),this.trigger("open",this),this.isOpen=!0,this},i.prototype.close=function(){return this.modal.fadeOut(),this.isOpen&&(this.isOpen=!1,this.trigger("close",this)),this},i}(r.View),i})}.call(this),function(){var e=Object.prototype.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("authentication/router",["require","jquery","underscore","backbone","app","reForm","./views","widgets/modal"],function(e){var n,r,i,s,o,u,a,f;return n=e("jquery"),f=e("underscore"),r=e("backbone"),o=e("app"),u=e("reForm"),a=e("./views"),s=e("widgets/modal"),i=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.routes={"login(/)":"login","register(/)":"register","not-verified(/)":"not_verified","verified(/)":"verified"},n.prototype.initialize=function(){return f.bindAll(this),this.bindExternalEvents()},n.prototype.initializeLogin=function(){return this.loginView=new a.LoginView({}),this.loginView.form.on("register-link:click",this.registerLinkCB),this.loginBox=new s({title:i18n("Login"),content:this.loginView.render().el,modal_id:"login-modal-box"})},n.prototype.initializeLogout=function(){return this.logoutView=new a.LogoutView({})},n.prototype.initializeRegister=function(){return this.registerView=new a.RegisterView({}),this.registerView.form.on("success",this.registerFormOnSuccessCB),this.registerView.form.on("login-link:click",this.loginLinkCB),this.registerBox=new s({title:i18n("Register"),width:"450px",content:this.registerView.render().el,modal_id:"register-modal-box"})},n.prototype.initializeVerification=function(){return this.notVerifiedView=new a.VerificationView({verified:!1}),this.verifiedView=new a.VerificationView({verified:!0}),this.verifiedView.loginForm.on("register-link:click",this.registerLinkCB),this.notVerifiedBox=new s({title:i18n("Verification"),content:this.notVerifiedView.render().el,modal_id:"verification-modal-box"}),this.verifiedBox=new s({title:i18n("Verification"),content:this.verifiedView.render().el,modal_id:"verification-modal-box"})},n.prototype.bindExternalEvents=function(){return o.on("login",this._loginRequired),o.on("logout",this.logout)},n.prototype.registerLinkCB=function(){return this.register()},n.prototype.loginLinkCB=function(){return this.login()},n.prototype.registerFormOnSuccessCB=function(){return this.not_verified()},n.prototype._loginRequired=function(e){if(typeof KomooNS!="undefined"&&KomooNS!==null?!KomooNS.isAuthenticated:!void 0)return this.loginBox==null&&this.initializeLogin(),e&&this.loginView.updateUrls(e),this.login()},n.prototype.login=function(){this.closeModals();if(typeof KomooNS!="undefined"&&KomooNS!==null?!KomooNS.isAuthenticated:!void 0)return this.loginBox==null&&this.initializeLogin(),this.loginBox.open()},n.prototype.logout=function(){return this.logoutView||this.initializeLogout(),typeof console!="undefined"&&console!==null&&console.log("LOGOUT"),this.logoutView.logout()},n.prototype.register=function(){this.closeModals();if(typeof KomooNS!="undefined"&&KomooNS!==null?!KomooNS.isAuthenticated:!void 0)return this.registerBox==null&&this.initializeRegister(),this.registerBox.open()},n.prototype.not_verified=function(){return this.closeModals(),this.notVerifiedBox==null&&this.initializeVerification(),this.notVerifiedBox.open()},n.prototype.verified=function(){return this.closeModals(),this.verifiedBox==null&&this.initializeVerification(),this.verifiedBox.open()},n.prototype.closeModals=function(){var e,t,n,r,i;r=[this.loginBox,this.registerBox,this.verifiedBox,this.notVerifiedBox],i=[];for(t=0,n=r.length;t<n;t++)e=r[t],i.push(e!=null?e.close():void 0);return i},n}(r.Router),i})}.call(this),function(){var e=Object.prototype.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("core/form_widgets",["require","underscore","reForm"],function(e){var n,r,i,s,o,u,a;return a=e("underscore"),u=e("reForm"),i='<div class="collection-container <%=container_class%>">\n  <a href="#" class="remove" title="<%=i18n(\'Remove\')%>">[-]</a>\n</div>',s='<div class="field-container <%=container_class%>">\n  <label><%=label%></label>\n  <div class="widget-container"></div>\n</div>',o='<div class="fields-container"></div>\n<a class="add-row"><%=i18n(\'+ Add another one\')%></a>',r=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.fields=[],n.prototype.collectionTemplate=i,n.prototype.fieldTemplate=s,n.prototype.template=o,n.prototype.events={"click .add-row":"onAddClick","click .remove":"onRemoveClick"},n.prototype.initialize=function(){return this.options.type="json",this.rows=0,this.renderedFields=[],n.__super__.initialize.apply(this,arguments),typeof console!="undefined"&&console!==null?console.log(this,this.$el):void 0},n.prototype.set=function(e){var t,n,r,i;this.clear();if(a.isArray(e)){i=[];for(n=0,r=e.length;n<r;n++)t=e[n],i.push(this.addRow(t));return i}},n.prototype.get=function(){var e,t,n,r,i,s,o,u,f,l;i=[],f=this.renderedFields;for(o=0,u=f.length;o<u;o++){e=f[o],t=!0,r={},l=e.data("instances");for(n in l)s=l[n],r[n]=s.get(),r[n]&&(t=!1);t||i.push(r)}return a.isEmpty(i)?null:i},n.prototype.clear=function(){var e,t,n,r,i,s,o;s=this.renderedFields;for(r=0,i=s.length;r<i;r++){e=s[r],o=e.data("instances");for(n in o)t=o[n],t.unbind().remove();e.remove()}return this.rows=0,this.renderedFields.length=0,this},n.prototype.remove=function(){return this.clear(),n.__super__.remove.apply(this,arguments)},n.prototype.onAddClick=function(e){return e.preventDefault(),this.addRow()},n.prototype.onRemoveClick=function(e){var t;return e.preventDefault(),t=$(e.target),t.parent().remove()},n.prototype.addRow=function(e){var t,n,r,i,s,o,u,f,l,c,h,p,d;f=a.template(this.collectionTemplate),l=a.template(this.fieldTemplate),t={name:this.rows,input_id:"id_"+this.rows,container_class:"row"},s=$("<div>").html(f(t)).children().detach(),r={},p=this.fields.slice(0).reverse();for(c=0,h=p.length;c<h;c++)n=p[c],t={name:""+this.name+"_"+n.name+"_"+this.rows,label:n.label||"",value:n.value||"",container_class:n.container_class||""},t=a.extend(t,n.args||{}),u=new n.widget(t),r[n.name]=u,n=$("<div>").html(l(t)).children().detach(),n.find(".widget-container").append(u.render().el),s.prepend(n).data("instances",r);this.$(".fields-container").append(s);for(i in e)o=e[i],(d=r[i])!=null&&d.set(o);return this.renderedFields.push(s),this.rows++,this},n}(u.Widget),n=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.fieldTemplate='<div class="subfield-container <%=container_class%>">\n  <div class="widget-container"></div>\n</div>',n.prototype.fields=[{name:"type",container_class:"type",widget:u.commonWidgets.DropdownWidget,args:{choices:[{title:"",value:""},{title:i18n("Address"),value:"address"},{title:i18n("Phone"),value:"phone"},{title:i18n("Email"),value:"email"},{title:i18n("Website"),value:"website"},{title:i18n("Skype"),value:"skype"},{title:i18n("Facebook"),value:"facebook"},{title:i18n("Google Plus"),value:"gplus"},{title:i18n("Twitter"),value:"twitter"}]}},{name:"value",container_class:"value",widget:u.commonWidgets.TextWidget}],n}(r),{MultiWidget:r,ContactWidget:n}})}.call(this),define("text!templates/forms/_inline_form.html",[],function(){return'<form action="" method="post" id="<%= formId %>" >\n  <div>\n    <input type="submit" name="submit" value="<%=submit_label%>" />\n    <input type="button" class="cancel" value="<%=i18n(\'Cancel\')%>" />\n  </div>\n</form>\n'}),function(){var e=Object.prototype.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("core/form",["require","reForm","./form_widgets","text!templates/forms/_inline_form.html"],function(e){var n,r,i,s;return i=e("reForm"),r=i.commonWidgets,s=e("./form_widgets"),n=function(n){function r(){r.__super__.constructor.apply(this,arguments)}return t(r,n),r.prototype.template=e("text!templates/forms/_inline_form.html"),r.prototype.events={"click .cancel":"onCancelClick"},r.prototype.initialize=function(){return r.__super__.initialize.apply(this,arguments),this.render()},r.prototype.onCancelClick=function(e){return e!=null&&e.preventDefault(),this.set(this.model.toJSON()),this.trigger("cancel")},r.prototype.wasChanged=function(){return!_.isEqual(this.get(),_.pick(this.model.toJSON(),_.pluck(this.fields,"name")))},r}(i.Form),{commonWidgets:r,widgets:s,BaseForm:n}})}.call(this),function(){var e=Object.prototype.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("user/forms",["require","core/form"],function(e){var n,r;return r=e("core/form"),n=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.fields=[{name:"name",label:i18n("Name"),container_class:"name",widget:r.commonWidgets.TextWidget},{name:"contact",label:i18n("Contact"),container_class:"contact",widget:r.widgets.ContactWidget},{name:"about_me",label:i18n("About me"),container_class:"about-me",widget:r.commonWidgets.TextAreaWidget}],n}(r.BaseForm),{UserInfoForm:n}})}.call(this),define("text!templates/widgets/_avatar.html",[],function(){return'<img src="<%= model.avatar || KomooNS.staticUrl + \'img/avatar.png\' %>" class="avatar" width="216" height="151" />\n'}),function(){var e=Object.prototype.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("widgets/avatar",["require","underscore","backbone","core/mixins","text!templates/widgets/_avatar.html"],function(e){var n,r,i,s;return s=e("underscore"),r=e("backbone"),i=e("core/mixins"),n=function(n){function r(){r.__super__.constructor.apply(this,arguments)}return t(r,n),s.extend(r.prototype,i.EditOverlayMixin),r.prototype.template=s.template(e("text!templates/widgets/_avatar.html")),r.prototype.className="avatar",r.prototype.initialize=function(){return this.render()},r.prototype.render=function(){return this.$el.html(this.template({model:this.model.toJSON()})),console.warn("render"),this.setMode(this.mode),this},r}(r.View),{Avatar:n}})}.call(this),define("text!templates/user/_user_info.html",[],function(){return'<h1 class="title user name"><%= user.name %></h1>\n\n<ul class="contact-info">\n  <% if(user.email) { %>\n    <li class="email"><%= user.email %></li>\n  <% } %>\n  <% if(user.contact) _.each(user.contact, function (c) { %>\n    <li class="<%= c.type.toLowerCase() %>"><%= c.value %></li>\n  <% }); %>\n</ul>\n\n<article class="user-info">\n  <h1><%= i18n(\'About me\') %></h1>\n  <div class="content">\n    <%- user.about_me || i18n(\'User has not wrote about oneself\') %>\n  </div>\n</article>\n'}),define("text!templates/user/_profile.html",[],function(){return'<div id="user-info-container"></div>\n\n<div id="user-updates-container"></div>\n'}),define("text!templates/user/_sidebar.html",[],function(){return'<article class="box avatar"></article>\n<article class="box map"></article>\n'}),define("text!templates/user/_update_item.html",[],function(){return'<i></i>\n<a href="<%= update.url %>" class="label">\n  <%= update.name %>\n  <span class="info"><%= update.datetime %></span></a>\n<a href="#" class="see-on-map"><%= i18n(\'See on map\') %></a>\n'}),define("text!templates/user/_updates_block.html",[],function(){return'<article class="user-updates">\n  <h1>Últimas contribuições</h1>\n  <div class="list-container"></div>\n</article>\n'}),define("text!templates/widgets/_pagination.html",[],function(){return'  <a href="#" class="previous"><%= i18n(\'previous %n\').replace(\'%n\', perPage) %></a>\n  <%= i18n(\'page\') %><input type="text" class="current-page" size="2" value="<%= currentPage %>"> <%= i18n(\'of\') %> <span class="total-pages"><%= totalPages %></span>\n  <a href="#" class="next"><%= i18n(\'next %n\').replace(\'%n\', perPage) %></a>\n'}),function(){var e=Object.prototype.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("widgets/list",["require","jquery","underscore","backbone","text!templates/widgets/_pagination.html"],function(e){var n,r,i,s,o;return n=e("jquery"),o=e("underscore"),r=e("backbone"),s=function(n){function r(){r.__super__.constructor.apply(this,arguments)}return t(r,n),r.prototype.template=o.template(e("text!templates/widgets/_pagination.html")),r.prototype.className="pagination",r.prototype.events={"click a.previous":"previousPage","click a.next":"nextPage","keypress .current-page":"goTo"},r.prototype.initialize=function(){return o.bindAll(this),this.listenTo(this.collection,"reset",this.update),this.render()},r.prototype.render=function(){return this.$el.html(this.template(this.collection)),this},r.prototype.update=function(){var e,t;return e=this.collection.currentPage,t=this.collection.totalPages,this.$(".current-page").val(e+1),this.$(".total-pages").text(t),this.$(".previous")[this.isFirstPage()?"addClass":"removeClass"]("disabled"),this.$(".next")[this.isLastPage()?"addClass":"removeClass"]("disabled")},r.prototype.isFirstPage=function(){return this.collection.currentPage===this.collection.firstPage},r.prototype.isLastPage=function(){return this.collection.currentPage===this.collection.totalPages-1},r.prototype.previousPage=function(e){return e!=null&&typeof e.preventDefault=="function"&&e.preventDefault(),this.isFirstPage()||this.collection.requestPreviousPage(),this},r.prototype.nextPage=function(e){return e!=null&&typeof e.preventDefault=="function"&&e.preventDefault(),this.isLastPage()||this.collection.requestNextPage(),this},r.prototype.goTo=function(e){var t;if(e.keyCode!==13)return;t=parseInt(this.$(".current-page").val(),10);if(o.isNaN(t)||t<=0||t>this.collection.totalPages){this.update();return}return this.collection.goTo(t-1)},r}(r.View),i=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.tagName="ul",n.prototype.className="list",n.prototype.initialize=function(){return o.bindAll(this),this.listenTo(this.collection,"add",this.addOne),this.listenTo(this.collection,"reset",this.addAll),this.listenTo(this.collection,"all",this.render),this.listenTo(this.collection,"request",this._loading),this.listenTo(this.collection,"sync",this._loaded),this.ItemView=this.options.ItemView,this.subViews=[],this.collection.pager(),this.render()},n.prototype.render=function(){},n.prototype._loading=function(){return typeof console!="undefined"&&console!==null?console.log("loading..."):void 0},n.prototype._loaded=function(){return typeof console!="undefined"&&console!==null?console.log("loaded"):void 0},n.prototype.addAll=function(){return this.$el.empty(),this.collection.each(this.addOne),this},n.prototype.addOne=function(e){var t;return t=new this.ItemView({model:e}),this.$el.append(t.render().$el),this.subViews.push(t),this},n}(r.View),{Pagination:s,List:i}})}.call(this),function(){var e=Object.prototype.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("user/views",["require","jquery","underscore","backbone","reForm","app","main/views","./forms","widgets/avatar","text!templates/user/_user_info.html","text!templates/user/_profile.html","map/views","text!templates/user/_sidebar.html","text!templates/user/_update_item.html","text!templates/user/_updates_block.html","widgets/list"],function(e){var n,r,i,s,o,u,a,f,l,c,h,p,d,v;return n=e("jquery"),v=e("underscore"),s=e("backbone"),u=e("reForm"),p=e("app"),r=e("main/views").ActionBar,h=e("./forms").UserInfoForm,i=e("widgets/avatar").Avatar,c=function(n){function r(){r.__super__.constructor.apply(this,arguments)}return t(r,n),r.prototype.template=v.template(e("text!templates/user/_user_info.html")),r.prototype.initialize=function(){return this.listenTo(this.model,"change",this.render),this.render()},r.prototype.render=function(){return this.$el.html(this.template({user:this.model.toJSON()}))},r}(s.View),o=function(n){function r(){r.__super__.constructor.apply(this,arguments)}return t(r,n),r.prototype.template=v.template(e("text!templates/user/_profile.html")),r.prototype.initialize=function(){var e,t,n;this.subViews=[],this.userInfoViews={view:new c({model:this.model})},this.userInfoViews.edit=new h({model:this.model,formId:"user-info",submit_label:i18n("Save")}),this.listenTo(this.userInfoViews.edit,"success",this.onSuccess),this.listenTo(this.userInfoViews.edit,"cancel",this.onCancel),n=this.userInfoViews;for(e in n)t=n[e],this.subViews.push(t);return this.updatesView=new l({collection:this.model.getUpdates()}),this.subViews.push(this.updatesView),this.setMode()},r.prototype.render=function(){var e,t,n,r,i;r=this.subViews;for(t=0,n=r.length;t<n;t++)e=r[t],e.$el.detach();return this.$el.html(this.template({user:this.model.toJSON(),mode:this.mode})),this.$("#user-info-container").append((i=this.userInfoViews[this.mode])!=null?i.$el:void 0),this.$("#user-updates-container").append(this.updatesView.$el),this},r.prototype.canClose=function(){var e;return!((e=this.userInfoViews[this.mode])!=null?typeof e.wasChanged=="function"?e.wasChanged():void 0:void 0)},r.prototype.setMode=function(e){var t;this.mode=e!=null?e:(t=this.options.mode)!=null?t:"show";if(this.mode&&!this.model.hasPermission(this.mode)||this.userInfoViews[this.mode]==null){typeof console!="undefined"&&console!==null&&console.log("Mode '"+this.mode+"' not allowed, changing to 'view'."),this.model.view();return}return this.userInfoViews[this.mode].render(),this.render()},r.prototype.onSuccess=function(){return p.trigger("change",this.model),this.model.view()},r.prototype.onCancel=function(){return this.model.view()},r}(s.View),d=e("map/views"),a=function(n){function r(){r.__super__.constructor.apply(this,arguments)}return t(r,n),r.prototype.template=v.template(e("text!templates/user/_sidebar.html")),r.prototype.initialize=function(){return this.subViews=[],this.subViews.push(new i({model:this.model,mode:this.options.mode,parentSelector:".avatar.box"})),this.subViews.push(new d.Preview({model:this.model,mode:this.options.mode,parentSelector:".map.box"})),this.render(),this.setMode()},r.prototype.render=function(){var e,t,n,r,i,s,o;s=this.subViews;for(t=0,r=s.length;t<r;t++)e=s[t],e.$el.detach();this.$el.html(this.template({model:this.model.toJSON()})),o=this.subViews;for(n=0,i=o.length;n<i;n++)e=o[n],this.$(e.options.parentSelector).append(e.$el);return this},r.prototype.setMode=function(e){var t,n,r,i,s;this.mode=e,i=this.subViews,s=[];for(n=0,r=i.length;n<r;n++)t=i[n],s.push(typeof t.setMode=="function"?t.setMode(this.mode):void 0);return s},r}(s.View),f=function(n){function r(){r.__super__.constructor.apply(this,arguments)}return t(r,n),r.prototype.template=v.template(e("text!templates/user/_update_item.html")),r.prototype.tagName="li",r.prototype.events={"click .see-on-map":"seeOnMap"},r.prototype.initialize=function(){return this.listenTo(this.model,"change",this.render),this.render()},r.prototype.render=function(){var e,t;return this.$el.removeClass().addClass([(e=this.model.get("type"))!=null?e.toLowerCase():void 0,(t=this.model.get("action"))!=null?t.toLowerCase():void 0]),this.$el.html(this.template({update:this.model.toJSON()})),this},r.prototype.seeOnMap=function(e){return e!=null&&typeof e.preventDefault=="function"&&e.preventDefault(),this},r}(s.View),l=function(n){function r(){r.__super__.constructor.apply(this,arguments)}return t(r,n),r.prototype.template=v.template(e("text!templates/user/_updates_block.html")),r.prototype.initialize=function(){var t;return t=e("widgets/list"),this.subViews=[],this.subViews.push(new t.List({collection:this.collection,className:"updates list",parentSelector:".list-container",ItemView:f})),this.subViews.push(new t.Pagination({collection:this.collection,parentSelector:".list-container"})),this.render()},r.prototype.render=function(){var e,t,n,r,i,s,o;s=this.subViews;for(t=0,r=s.length;t<r;t++)e=s[t],e.$el.detach();this.$el.html(this.template(this.collection)),o=this.subViews.reverse();for(n=0,i=o.length;n<i;n++)e=o[n],this.$(e.options.parentSelector).prepend(e.$el);return this},r}(s.View),{Profile:o,Updates:l,ActionBar:r,Sidebar:a}})}.call(this),function(){var e=Object.prototype.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("user/pages",["require","jquery","backbone","core/page_manager","./views"],function(e){var n,r,i,s,o,u;return n=e("jquery"),r=e("backbone"),o=e("core/page_manager"),u=e("./views"),s=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(){var e,t,r;n.__super__.initialize.apply(this,arguments),this.mode=(t=this.options.mode)!=null?t:"view",this.id="user::profile::"+this.model.id,e={model:this.model,mode:this.mode};if(((r=o.currentPage)!=null?r.id:void 0)!==this.id)return this.setViews({actionBar:new u.ActionBar(e),sidebar:new u.Sidebar(e),mainContent:new u.Profile(e)})},n.prototype.open=function(){var e;if(((e=o.currentPage)!=null?e.id:void 0)===this.id){o.currentPage.setMode(this.mode);return}return n.__super__.open.apply(this,arguments)},n.prototype.setMode=function(e){var t,n,r,i,s;if(this.mode===e)return;i=this._views;for(n=0,r=i.length;n<r;n++)t=i[n],(s=t.instance)!=null&&typeof s.setMode=="function"&&s.setMode(e);this.mode=e;if(e===null)return this.model.view()},n}(o.Page),i=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(){return this.options.mode="edit",n.__super__.initialize.apply(this,arguments)},n}(s),{Profile:s,Edit:i}})}.call(this),function(){var e=Object.prototype.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("user/router",["require","underscore","backbone","app","urls","./pages","./models"],function(e){var n,r,i,s,o,u,a;return a=e("underscore"),n=e("backbone"),i=e("app"),u=e("urls"),o=e("./pages"),s=e("./models"),r=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.routes={},n.prototype.routes[u.route("user_view")]="detail",n.prototype.routes[u.route("user_edit")]="edit",n.prototype.initialize=function(){return a.bindAll(this)},n.prototype.goTo=function(e,t,n){var r,o=this;return r=s.getUser(t),r.fetch().done(function(){return i.goTo(u.resolve(e,{id_:r.id}),new n({model:r}))})},n.prototype.detail=function(e){return this.goTo("user_view",e,o.Profile)},n.prototype.edit=function(e){return this.goTo("user_edit",e,o.Edit)},n}(n.Router),r})}.call(this),function(){var e=Object.prototype.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("map/pages",["require","jquery","backbone","app","core/page_manager"],function(e){var n,r,i,s,o;return n=e("jquery"),r=e("backbone"),s=e("app"),o=e("core/page_manager"),i=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(){return n.__super__.initialize.apply(this,arguments),this.id="mainMap"},n.prototype.open=function(){return s.showMainMap()},n.prototype.close=function(){return s.hideMainMap()},n}(o.Page),{MapPage:i}})}.call(this),function(){var e=Object.prototype.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("map/router",["require","underscore","backbone","app","urls","./pages"],function(e){var n,r,i,s,o,u;return u=e("underscore"),n=e("backbone"),i=e("app"),o=e("urls"),s=e("./pages"),r=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.routes={},n.prototype.routes[o.route("map")]="mainMap",n.prototype.routes[o.route("map_coords")]="mainMap",n.prototype.initialize=function(){return u.bindAll(this)},n.prototype.mainMap=function(e,t,n){var r,u;return r={lat:e,lng:t,zoom:n},u=e?o.resolve("map_coords",r):o.resolve("map"),i.goTo(u,new s.MapPage)},n}(n.Router),r})}.call(this),function(){var e=Object.prototype.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("organizations/forms",["require","core/form"],function(e){var n,r;return r=e("core/form"),n=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.fields=[{name:"name",label:i18n("Name"),widget:r.commonWidgets.TextWidget},{name:"description",label:i18n("Description"),widget:r.commonWidgets.TextWidget},{name:"contact",label:i18n("Contact"),container_class:"contact",widget:r.widgets.ContactWidget}],n}(r.BaseForm),{OrganizationForm:n}})}.call(this),define("text!templates/organizations/_show_main.html",[],function(){return"<h1><%= obj.name %></h1>\n\n<div><%= obj.description %></div>\n"}),define("text!templates/organizations/_show_sidebar.html",[],function(){return"<h1>Show Sidebar</h1>\n"}),define("text!templates/organizations/_new_main.html",[],function(){return"<h1>New Main</h1>\n\n<div id='form-container'></div>\n"}),define("text!templates/organizations/_edit_main.html",[],function(){return"<h1>Edit Main</h1>\n\n<div id='form-container'></div>\n"}),define("text!templates/organizations/_edit_sidebar.html",[],function(){return"<h1>Edit Sidebar</h1>\n"}),function(){var e=Object.prototype.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("organizations/views",["require","jquery","underscore","backbone","./forms","text!templates/organizations/_show_main.html","text!templates/organizations/_show_sidebar.html","text!templates/organizations/_new_main.html","text!templates/organizations/_edit_main.html","text!templates/organizations/_edit_sidebar.html"],function(e){var n,r,i,s,o,u,a,f,l;return n=e("jquery"),l=e("underscore"),r=e("backbone"),f=e("./forms"),u=function(n){function r(){r.__super__.constructor.apply(this,arguments)}return t(r,n),r.prototype.template=l.template(e("text!templates/organizations/_show_main.html")),r.prototype.initialize=function(){return l.bindAll(this),this.listenTo(this.model,"change",this.render),this.render()},r.prototype.render=function(){return this.$el.html(this.template({obj:this.model.toJSON()})),this},r}(r.View),a=function(n){function r(){r.__super__.constructor.apply(this,arguments)}return t(r,n),r.prototype.template=l.template(e("text!templates/organizations/_show_sidebar.html")),r.prototype.initialize=function(){return l.bindAll(this),this.listenTo(this.model,"change",this.render),this.render()},r.prototype.render=function(){return this.$el.html(this.template({obj:this.model.toJSON()})),this},r}(r.View),o=function(n){function r(){r.__super__.constructor.apply(this,arguments)}return t(r,n),r.prototype.template=l.template(e("text!templates/organizations/_new_main.html")),r.prototype.initialize=function(){return l.bindAll(this),this.listenTo(this.model,"change",this.render),this.subViews=[],this.form=new f.OrganizationForm({model:this.model}),this.subViews.push(this.form),this.render()},r.prototype.render=function(){var e,t,n,r;r=this.subViews;for(t=0,n=r.length;t<n;t++)e=r[t],e.$el.detach();return this.$el.html(this.template({})),this.$("#form-container").append(this.form.$el),this},r}(r.View),i=function(n){function r(){r.__super__.constructor.apply(this,arguments)}return t(r,n),r.prototype.template=l.template(e("text!templates/organizations/_edit_main.html")),r.prototype.initialize=function(){return l.bindAll(this),this.listenTo(this.model,"change",this.render),this.subViews=[],this.form=new f.OrganizationForm({model:this.model}),this.subViews.push(this.form),this.render()},r.prototype.render=function(){var e,t,n,r;r=this.subViews;for(t=0,n=r.length;t<n;t++)e=r[t],e.$el.detach();return this.$el.html(this.template({data:this.model.toJSON()})),this.$("#form-container").append(this.form.$el),this},r}(r.View),s=function(n){function r(){r.__super__.constructor.apply(this,arguments)}return t(r,n),r.prototype.template=l.template(e("text!templates/organizations/_edit_sidebar.html")),r.prototype.initialize=function(){return l.bindAll(this),this.listenTo(this.model,"change",this.render),this.render()},r.prototype.render=function(){return this.$el.html(this.template({})),this},r}(r.View),{ShowMain:u,ShowSidebar:a,NewMain:o,EditMain:i,EditSidebar:s}})}.call(this),function(){var e=Object.prototype.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("organizations/models",["require","app","main/models"],function(e){var n,r,i;return r=e("app"),i=e("main/models"),n=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.urlRoot="/api/organizations",n.prototype.navRoot="/organizations",n}(i.CommonObject),{Organization:n}})}.call(this),function(){var e=Object.prototype.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("organizations/pages",["require","app","core/page_manager","main/views","./views","./models"],function(e){var n,r,i,s,o,u,a,f;return s=e("app"),f=e("core/page_manager"),o=e("main/views"),a=e("./views"),u=e("./models"),i=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(){var e;return n.__super__.initialize.apply(this,arguments),this.id="organizations::view::"+this.model.id,e={model:this.model},this.setViews({actionBar:new o.ActionBar(e),sidebar:new a.ShowSidebar(e),mainContent:new a.ShowMain(e)})},n}(f.Page),r=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(){var e,t;return n.__super__.initialize.apply(this,arguments),this.id="organizations::new",e={model:this.model},t=new a.NewMain(e),this.setViews({mainContent:t}),this.listenTo(t.form,"success",function(){return s.goTo("organizations/"+this.model.id)})},n}(f.Page),n=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(){var e,t;return n.__super__.initialize.apply(this,arguments),this.id="organizations::edit::"+this.model.id,e={model:this.model},t=new a.EditMain(e),this.setViews({actionBar:new o.ActionBar(e),sidebar:new a.EditSidebar(e),mainContent:t}),this.listenTo(t.form,"success",function(){return s.goTo("organizations/"+this.model.id)})},n}(f.Page),{Show:i,New:r,Edit:n}})}.call(this),function(){var e=Object.prototype.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("organizations/router",["require","underscore","backbone","app","./pages","./models"],function(e){var n,r,i,s,o,u;return u=e("underscore"),n=e("backbone"),i=e("app"),o=e("./pages"),s=e("./models"),r=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.routes={"organizations/new(/)":"new","organizations/:id(/)":"show","organizations/:id/edit(/)":"edit"},n.prototype.initialize=function(){return u.bindAll(this)},n.prototype.show=function(e){var t;return t=new s.Organization({id:e}),t.fetch(),i.goTo("/organizations/"+e,new o.Show({model:t}))},n.prototype["new"]=function(){var e;return e=new s.Organization({}),i.goTo("/organizations/new",new o.New({model:e}))},n.prototype.edit=function(e){var t;return t=new s.Organization({id:e}),t.fetch(),i.goTo("/organizations/"+e+"/edit",new o.Edit({model:t}))},n}(n.Router),r})}.call(this),define("services/analytics",[],function(){return{initialize:function(){var e=e||[];e.push(["_setAccount","UA-31165229-1"]),e.push(["_setDomainName","mootiro.org"]),e.push(["_setAllowLinker",!0]),e.push(["_trackPageview"]),function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()}}}),function(){define("core/app",["require","jquery","underscore","backbone","storage","core/page_manager"],function(e){var t,n,r,i,s,o;return t=e("jquery"),o=e("underscore"),r=e("backbone"),s=e("storage"),i=e("core/page_manager"),n=function(){function n(){var e=this;this.initialized=new t.Deferred,t.when(this.interceptAjaxRequests(),this.handleModulesError(),this.initializeUser(),this.initializeRouters(),this.initializeAnalytics()).done(function(){return t.when(e.drawLayout(),e.initializeMapEditor()).done(function(){return e.trigger("initialize"),e.initialized.resolve(!0)})})}return o.extend(n.prototype,r.Events),n.prototype.goTo=function(e,n){var r=this;return t.when(i.canClose()).done(function(){return n!=null?(r.routers[0].navigate(e),i.open(n)):r.routers[0].navigate(e,{trigger:!0})})},n.prototype.handleModulesError=function(){var e=this;return requirejs.onError=function(t){if(t.requireType!=="timeout")throw t;return alert("Timeout: Ocorreu uma falha ao carregar alguns serviços externos. Partes do Mootiro Maps poderão não funcionar corretamente."),e.trigger("error",t)},!0},n.prototype.interceptAjaxRequests=function(){var e,n,r,i=this;return r=function(e){var t,n,r,i;return t=document.location.host,r=document.location.protocol,i="//"+t,n=r+i,e===n||e.slice(0,n.length+1)===n+"/"||e===i||e.slice(0,i.length+1)===i+"/"||!/^(\/\/|http:|https:).*/.test(e)},n=function(e){return/^(GET|HEAD|OPTIONS|TRACE)$/.test(e)},t(document).ajaxSend(function(e,t,i){if(!n(i.type)&&r(i.url))return t.setRequestHeader("X-CSRFToken",s.cookie.get("csrftoken"))}),e=s.cookie.get("sessionid"),t(document).ajaxSuccess(function(t,n,o){var u;return u=s.cookie.get("sessionid"),r(o.url)&&e!==u&&i.trigger("change:session",u),e=u}),t(document).ajaxStart(function(){return i.trigger("working")}),t(document).ajaxStop(function(){return i.trigger("done")}),!0},n.prototype.initializeUser=function(){var n,r=this;return n=new t.Deferred,e(["user/models"],function(e){var t;return t=e.User,KomooNS.isAuthenticated?KomooNS.user=new t(KomooNS.user_data):KomooNS.user=new t({}),r.on("change:session",function(e){return KomooNS.user.clear(),KomooNS.user.set("id","me"),KomooNS.user.fetch({success:function(e){return KomooNS.isAuthenticated=e.get("id")!==null,e.trigger("change")}})}),n.resolve(!0)}),n.promise()},n.prototype.drawLayout=function(){var n,r=this;return n=new t.Deferred,e(["main/views"],function(e){var r,i,s;return t("body").prepend(t('<div id="fb-root" />')),r=new e.Feedback({el:"#feedback-container"}),s=new e.Header({el:"#header-container",model:KomooNS.user}),i=new e.Footer({el:"#footer-container"}),!0,n.resolve(!0)}),n.promise()},n.prototype.initializeRouters=function(){var n,i=this;return n=new t.Deferred,this.routers=[],t(function(){return e(["main/router","authentication/router","user/router","map/router","organizations/router"],function(){var e,t,s;for(t=0,s=arguments.length;t<s;t++)e=arguments[t],i.routers.push(new e);return window.routers=i.routers,r.history.start({pushState:!0,root:"/"}),n.resolve(!0)})}),n.promise()},n.prototype.initializeAnalytics=function(){var n;return n=new t.Deferred,t(function(){return e(["services/analytics"],function(e){return n.resolve(e.initialize())})}),n.promise()},n.prototype.initializeMapEditor=function(){var n,r=this;return n=new t.Deferred,e(["main/views"],function(e){return t("#map-editor-container").hide(),r.mapEditor=new e.MapEditor({el:"#map-editor-container"}),r.mapEditor.once("initialize",function(){return n.resolve(!0)})}),n.promise()},n.prototype.showMainMap=function(){var e=this;return t.when(this.initialized).done(function(){return t("#map-editor-container").show(),e.mapEditor.getMap().refresh()})},n.prototype.hideMainMap=function(){var e=this;return t.when(this.initialize).done(function(){return t("#map-editor-container").hide(),e.mapEditor.getMap().refresh()})},n}(),{App:n}})}.call(this),function(){define("app",["require","common","i18n","core/app"],function(e){var t,n,r,i;return r=e("common"),i=e("i18n"),t=e("core/app").App,n=new t,n})}.call(this),function(){var e;e=KomooNS.facebookAppId,define("services/facebook",["require","//connect.facebook.net/en_US/all.js#xfbml=1&appId="+e],function(e){return FB})}.call(this),function(){define("core/map/component",["require","jquery"],function(e){var t,n,r;return t=e("jquery"),n=function(){function e(e,n){this.mediator=e,this.el=n,this.map=this.mediator,this.$el=t(document).find(this.el)}return e.prototype.name="Base Component",e.prototype.description="",e.prototype.enabled=!1,e.prototype.setMap=function(e){this.map=e},e.prototype.enable=function(){return this.enabled=!0},e.prototype.disable=function(){return this.enabled=!1},e.prototype.init=function(e){return t.when(e)},e.prototype.destroy=function(){return!0},e}(),r=n,r})}.call(this),define("core/map/utils",["services/googlemaps"],function(e){return window.komoo||(komoo={}),komoo.utils={},komoo.utils.createCookie=function(e,t,n){var r;if(n){var i=new Date;i.setTime(i.getTime()+n*24*60*60*1e3),r="; expires="+i.toGMTString()}else r="";document.cookie=e+"="+t+r+"; path=/"},komoo.utils.readCookie=function(e){var t=e+"=",n=document.cookie.split(";");for(var r=0;r<n.length;r++){var i=n[r];while(i.charAt(0)==" ")i=i.substring(1,i.length);if(i.indexOf(t)===0)return i.substring(t.length,i.length)}return null},komoo.utils.eraseCookie=function(e){createCookie(e,"",-1)},komoo.utils.isPointInside=function(e,t){if(!t)return!1;var n=!1,r=t.getLength();for(var i=-1,s=r-1;++i<r;s=i)(t.getAt(i).lng()<=e.lng()&&e.lng()<t.getAt(s).lng()||t.getAt(s).lng()<=e.lng()&&e.lng()<t.getAt(i).lng())&&e.lat()<(t.getAt(s).lat()-t.getAt(i).lat())*(e.lng()-t.getAt(i).lng())/(t.getAt(s).lng()-t.getAt(i).lng())+t.getAt(i).lat()&&(n=!n);return n},komoo.utils.latLngToPoint=function(t,n,r){t.googleMap&&(t=t.googleMap);var i=r||t.getZoom(),s=t.getProjection().fromLatLngToPoint(n),o=Math.pow(2,i),u=new e.Point(s.x*o,s.y*o);return u},komoo.utils.pointToLatLng=function(t,n,r){t.googleMap&&(t=t.googleMap);var i=r||t.getZoom(),s=Math.pow(2,i),o=new e.Point(n.x/s,n.y/s),u=t.getProjection().fromPointToLatLng(o);return u},komoo.utils}),define("text!templates/map/_supporters.html",[],function(){return'<div id="map-supporters-content" style="">\n  <h3>Apoio</h3>\n  <div class="cea">\n    <a href="http://www.institutocea.org.br/" target="_blank">\n      <img src="/static/img/supporters/cea-map.png" alt="Instituto C&amp;A">\n    </a>\n  </div>\n</div>\n'}),define("text!templates/map/_searchbox.html",[],function(){return'<form class\'search-form\' action="#">\n  <select name="location-type" class="location-type">\n    <option value="address"><%= i18n(\'Address\') %></option>\n    <option value="latLng"><%= i18n(\'Coordinate\') %></option>\n  </select>\n  <div class="address-container input-container">\n    <input type="text" name="address" value="" placeholder="<%= i18n(\'Address\') %>" class="address" />\n  </div>\n  <div class="latLng-container input-container" style="display: none;">\n    <input type="text" name="lat" value="" placeholder="<%= i18n(\'Latitude\') %>"  class="lat" />\n    <input type="text" name="lng" value="" placeholder="<%= i18n(\'Longitude\') %>" class="lng" />\n  </div>\n  <input type="submit" class="btn search" value="<%= i18n(\'Go\') %>" />\n  </form>\n'}),function(){var e=Object.prototype.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("core/map/views",["require","jquery","underscore","backbone","text!templates/map/_supporters.html","text!templates/map/_searchbox.html"],function(e){var n,r,i,s,o;return n=e("jquery"),o=e("underscore"),r=e("backbone"),s=function(n){function r(){r.__super__.constructor.apply(this,arguments)}return t(r,n),r.prototype.template=o.template(e("text!templates/map/_supporters.html")),r.prototype.render=function(){return this.$el.html(this.template({})),this},r}(r.View),i=function(n){function r(){r.__super__.constructor.apply(this,arguments)}return t(r,n),r.prototype.template=o.template(e("text!templates/map/_searchbox.html")),r.prototype.events={"click .search":"onSearchBtnClick","change .location-type":"onTypeChange"},r.prototype.render=function(){return this.$el.html(this.template({})),this},r.prototype.onTypeChange=function(){var e;return e=this.$(".location-type").val(),e==="address"?(this.$(".latLng-container").hide(),this.$(".address-container").show()):(this.$(".address-container").hide(),this.$(".latLng-container").show())},r.prototype.onSearchBtnClick=function(){var e,t;return t=this.$(".location-type").val(),e=t==="address"?this.$(".address").val():[parseFloat(this.$(".lat").val().replace(",",".")),parseFloat(this.$(".lng").val().replace(",","."))],this.search(t,e),!1},r.prototype.search=function(e,t){return e==null&&(e="address"),this.trigger("search",{type:e,position:t}),this},r}(r.View),{SearchBoxView:i,SupportersView:s}})}.call(this),function(){var e=Object.prototype.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("core/map/controls",["require","services/googlemaps","./component","./common","./geometries","./utils","infobox","markerclusterer"],function(e){var n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,J,K,Q,G,Y;return q=e("services/googlemaps"),f=e("./component"),F=e("./common"),I=e("./geometries"),R=e("./utils"),y=e("infobox"),N=e("markerclusterer"),window.komoo==null&&(window.komoo={}),(Y=window.komoo).event==null&&(Y.event=q.event),Q=i18n("Next Step"),X=i18n("Cancel"),V=i18n("Close"),W=i18n("Add shape"),U=i18n("Add line"),z=i18n("Add point"),G=i18n("Sum"),J=i18n("Cut out"),K=i18n("Loading..."),d=F.geometries.types.EMPTY,A=F.geometries.types.POINT,x=F.geometries.types.MULTIPOINT,O=F.geometries.types.POLYGON,M=F.geometries.types.LINESTRING,b=F.geometries.types.LINESTRING,T=F.geometries.types.MULTILINESTRING,S=F.geometries.types.MULTILINESTRING,k={},k[A]=q.drawing.OverlayType.MARKER,k[x]=q.drawing.OverlayType.MARKER,k[b]=q.drawing.OverlayType.POLYLINE,k[S]=q.drawing.OverlayType.POLYLINE,k[O]=q.drawing.OverlayType.POLYGON,p="edit",l="delete",C="new",n="add",u="cutout",L="perimeter_selection",o=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.position=q.ControlPosition.RIGHT_BOTTOM,n.prototype.init=function(){return n.__super__.init.call(this),this.box=$("<div>"),this.id!=null&&this.box.attr("id",this.id),this["class"]!=null&&this.box.addClass(this["class"]),this.map.addControl(this.position,this.box.get(0)),typeof this.handleMapEvents=="function"?this.handleMapEvents():void 0},n}(f),P=function(n){function r(){r.__super__.constructor.apply(this,arguments)}return t(r,n),r.prototype.position=q.ControlPosition.TOP_RIGHT,r.prototype.id="map-searchbox",r.prototype.init=function(){var t=this;return r.__super__.init.call(this),e(["./views"],function(e){return t.view=new e.SearchBoxView,t.box.append(t.view.render().el),t.handleViewEvents()})},r.prototype.handleViewEvents=function(){var e=this;return this.view.on("search",function(t){var n,r;return r=t.type,n=t.position,e.map.publish("goto",n,!0)})},r}(o),B=function(n){function r(){r.__super__.constructor.apply(this,arguments)}return t(r,n),r.prototype.id="map-supporters",r.prototype.init=function(){var t=this;return r.__super__.init.call(this),e(["./views"],function(e){return t.view=new e.SupportersView,t.box.append(t.view.render().el)})},r}(o),w=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.id="map-license",n.prototype.position=q.ControlPosition.BOTTOM_LEFT,n.prototype.init=function(){return n.__super__.init.call(this),this.box.html('Este conteúdo é disponibilizado nos termos da licença <a href="http://creativecommons.org/licenses/by-sa/3.0/deed.pt_BR">Creative Commons - Atribuição - Partilha nos Mesmos Termos 3.0 Não Adaptada</a>; pode estar sujeito a condições adicionais. Para mais detalhes, consulte as Condições de Uso.')},n}(o),h=function(e){function r(){r.__super__.constructor.apply(this,arguments)}return t(r,e),r.prototype.enabled=!0,r.prototype.defaultDrawingManagerOptions={drawingControl:!1,drawingMode:null},r.prototype.componentOriginalStatus={},r.prototype.init=function(e){var t;this.options=e!=null?e:{},(t=this.options).drawingManagerOptions==null&&(t.drawingManagerOptions=this.defaultDrawingManagerOptions);if(this.options.map)return this.setMap(this.options.map)},r.prototype.initManager=function(e){return e==null&&(e=this.defaultDrawingManagerOptions),this.manager=new q.drawing.DrawingManager(e),this.handleManagerEvents()},r.prototype.setMap=function(e){return this.map=e,this.options.drawingManagerOptions.map=this.map.googleMap,this.initManager(this.options.drawingManagerOptions),this.handleMapEvents()},r.prototype.enable=function(){return this.enabled=!0},r.prototype.disable=function(){return this.enabled=!1},r.prototype.setMode=function(e){var t;this.mode=e,this.manager.setDrawingMode((t=this.mode)===n||t===C||this.mode===u&&this.feature.getGeometryType()===O?k[this.feature.getGeometryType()]:null);if(this.mode===u&&this.feature.getGeometryType()!==O)return this.mode=p},r.prototype.handleMapEvents=function(){var e=this;return this.map.subscribe("draw_feature",function(t,n){return e.drawFeature(n)}),this.map.subscribe("edit_feature",function(t){return e.editFeature(t)}),this.map.subscribe("drawing_finished",function(t){return e.feature.setEditable(!1),e.feature.updateIcon(),e.setFeature(null),e.setMode(null)}),this.map.subscribe("finish_drawing",function(){return e.map.publish("drawing_finished",e.feature,!0)}),this.map.subscribe("cancel_drawing",function(){return e.map.publish("drawing_finished",e.feature,!1)}),this.map.subscribe("mode_changed",function(t){return e.setMode(t)}),this.map.subscribe("feature_rightclick",function(e,t){var n,r,i;if(e.vertex==null)return;n=t.getGeometry().getOverlay(),i=typeof n.getPaths=="function"?n.getPaths():void 0,r=i!=null?i.getAt(e.path):void 0,r!=null&&r.removeAt(e.vertex);if((r!=null?r.getLength():void 0)===1)return i.removeAt(e.path)})},r.prototype.handleManagerEvents=function(){var e=this;return komoo.event.addListener(this.manager,"overlaycomplete",function(t){var r,i,s,o,a,f,l,c,h,d,v,m,g;s=(l=t.overlay)!=null?typeof l.getPath=="function"?l.getPath():void 0:void 0;if(s&&((c=e.mode)===n||c===C||c===u)&&((h=t.overlay)!=null?h.getPaths:void 0)){o=e.feature.getGeometry().getPaths(),e.mode===C&&o.clear();if((o!=null?o.length:void 0)>0){a=q.geometry.spherical.computeSignedArea(s),f=q.geometry.spherical.computeSignedArea(o.getAt(0)),r=a/Math.abs(a),i=f/Math.abs(f);if(r===i&&e.mode===u||r!==i&&((d=e.mode)===n||d===C))s=new q.MVCArray(s.getArray().reverse())}o.push(s),e.feature.getGeometry().setPaths(o),t.overlay.setMap(null)}else(v=e.mode)!==n&&v!==C||!t.overlay.getPosition?((m=e.mode)===n||m===C)&&t.overlay.getPath&&e.feature.getGeometry().addPolyline(t.overlay,!0):(e.feature.getGeometry().addMarker(t.overlay),e.feature.updateIcon(100));return e.map.setMode(p),(g=e.feature)!=null?g.setEditable(!0):void 0})},r.prototype.setFeature=function(e){var t=this;this.feature=e,this.featureClickListener!=null&&komoo.event.removeListener(this.featureClickListener);if(this.feature==null)return;return this.feature.setMap(this.map,{geometry:!0}),this.featureClickListener=komoo.event.addListener(this.feature,"click",function(e,n){var r,i,s,o,u,a;if(t.mode===l)return t.feature.getGeometryType()===O?(o=t.feature.getGeometry().getPaths(),o.forEach(function(t,n){if(R.isPointInside(e.latLng,t))return o.removeAt(n)})):n&&t.feature.getGeometryType()===x?(s=t.feature.getGeometry().getMarkers(),r=$.inArray(n,s.getArray()),r>-1&&(i=s.removeAt(r),i.setMap(null))):n&&t.feature.getGeometryType()===S&&(a=t.feature.getGeometry().getPolylines(),r=$.inArray(n,a.getArray()),r>-1&&(u=a.removeAt(r),u.setMap(null))),t.map.setMode(p)})},r.prototype.editFeature=function(e){var t;if(this.enabled===!1)return;this.setFeature(e);if(this.feature.getGeometryType()==="Empty"){this.map.publish("select_new_geometry",this.feature);return}return this.feature.setEditable(!0),t={},t[""+k[this.feature.getGeometryType()]+"Options"]=this.feature.getGeometry().getOverlayOptions({strokeWeight:2.5,zoom:100}),this.manager.setOptions(t),this.map.setMode(p),this.map.publish("drawing_started",this.feature)},r.prototype.drawFeature=function(e){this.feature=e;if(this.enabled===!1)return;return this.editFeature(this.feature),this.map.setMode(C)},r}(f),a=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.id="map-drawing-box",n.prototype["class"]="map-panel",n.prototype.position=q.ControlPosition.TOP_LEFT,n.prototype.init=function(e){var t,r;return e==null&&(e={title:""}),n.__super__.init.call(this),t=(r=e.title)!=null?r:"",this.box.html('<div id="drawing-control">\n  <div class="map-panel-title" id="drawing-control-title">'+t+'</div>\n  <div class="content" id="drawing-control-content"></div>\n  <div class="map-panel-buttons">\n    <div class="map-button" id="drawing-control-cancel">'+V+"</div>\n  </div>\n</div>"),this.box.show(),this.handleButtonEvents()},n.prototype.setTitle=function(e){return e==null&&(e=""),this.box.find("#drawing-control-title").text(e)},n.prototype.handleButtonEvents=function(){var e=this;return $("#drawing-control-cancel",this.box).click(function(){return e.map.publish("close_clicked")})},n}(o),m=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.id="map-drawing-box",n.prototype["class"]="map-panel",n.prototype.position=q.ControlPosition.TOP_LEFT,n.prototype.init=function(){return n.__super__.init.call(this),this.box.hide(),this.box.html('<div id="geometry-selector">\n  <div class="map-panel-title" id="drawing-control-title"></div>\n  <ul class="content" id="drawing-control-content">\n    <li class="polygon btn" data-geometry-type="Polygon">\n      <i class="icon-polygon middle"></i><span class="middle">Adicionar área</span>\n    </li>\n    <li class="linestring btn" data-geometry-type="LineString">\n      <i class="icon-linestring middle"></i><span class="middle">Adicionar linha</span>\n    </li>\n    <li class="point btn" data-geometry-type="Point">\n      <i class="icon-point middle"></i><span class="middle">Adicionar ponto</span>\n    </li>\n  </ul>\n  <div class="map-panel-buttons">\n    <div class="map-button" id="drawing-control-cancel">'+X+"</div>\n  </div>\n</div>"),this.handleBoxEvents()},n.prototype.handleMapEvents=function(){var e=this;return this.map.subscribe("select_new_geometry",function(t){return e.open(t)})},n.prototype.handleBoxEvents=function(){var e=this;return this.box.find("li").each(function(t,n){var r,i;return r=$(n),i=r.attr("data-geometry-type"),r.click(function(){return e.close(),e.map.editFeature(e.feature,i)})})},n.prototype.handleButtonEvents=function(){var e=this;return $("#drawing-control-cancel",this.box).click(function(){return e.map.publish("cancel_drawing")})},n.prototype.showContent=function(){var e,t,n,r,i,s;this.box.find("li").hide(),i=(r=this.feature.getFeatureType())!=null?r.geometryTypes:void 0,s=[];for(t=0,n=i.length;t<n;t++)e=i[t],s.push(this.box.find("li."+e.toLowerCase()).show());return s},n.prototype.open=function(e){return this.feature=e,this.showContent(),$("#drawing-control-title",this.box).html("Selecione o tipo de objeto"),this.handleButtonEvents(),this.box.show()},n.prototype.close=function(){return this.box.hide()},n}(o),c=function(e){function r(){r.__super__.constructor.apply(this,arguments)}return t(r,e),r.prototype.id="map-drawing-box",r.prototype["class"]="map-panel",r.prototype.position=q.ControlPosition.TOP_LEFT,r.prototype.init=function(){return r.__super__.init.call(this),this.box.hide(),this.box.html('<div id="drawing-control">\n  <div class="map-panel-title" id="drawing-control-title"></div>\n  <div class="content" id="drawing-control-content"></div>\n  <div class="map-panel-buttons">\n    <div class="map-button" id="drawing-control-finish">'+Q+'</div>\n    <div class="map-button" id="drawing-control-cancel">'+X+"</div>\n  </div>\n</div>"),this.handleBoxEvents()},r.prototype.handleMapEvents=function(){var e=this;return this.map.subscribe("drawing_started",function(t){return e.open(t)}),this.map.subscribe("drawing_finished",function(t){return e.close()}),this.map.subscribe("mode_changed",function(t){return e.setMode(t)})},r.prototype.handleBoxEvents=function(){var e=this;return $("#drawing-control-finish",this.box).click(function(){if($("#drawing-control-finish",e.box).hasClass("disabled"))return;return e.map.publish("finish_drawing")}),$("#drawing-control-cancel",this.box).click(function(){return e.map.publish("cancel_drawing")})},r.prototype.handleButtonEvents=function(){var e=this;return $("#drawing-control-add",this.box).click(function(){return e.map.setMode(e.mode!==n?n:p)}),$("#drawing-control-cutout",this.box).click(function(){return e.map.setMode(e.mode!==u?u:p)}),$("#drawing-control-delete",this.box).click(function(){return e.map.setMode(e.mode!==l?l:p)})},r.prototype.setMode=function(e){var t;return this.mode=e,this.mode===C?($("#drawing-control-content",this.box).hide(),$("#drawing-control-finish",this.box).addClass("disabled")):($("#drawing-control-content",this.box).show(),$("#drawing-control-finish",this.box).removeClass("disabled")),$(".map-button.active",this.box).removeClass("active"),$("#drawing-control-"+((t=this.mode)!=null?t.toLowerCase():void 0),this.box).addClass("active")},r.prototype.getTitle=function(){var e,t,n,r;if(this.feature.getGeometryType()===O)e="polygon",t=W;else if((n=this.feature.getGeometryType())===b||n===S)e="linestring",t=U;else if((r=this.feature.getGeometryType())===A||r===x)e="point",t=z;return'<i class="icon-'+e+' middle"></i><span class="middle">'+t+"</span>"},r.prototype.getContent=function(){var e,t,n,r;return e=$('<div class="map-button" id="drawing-control-add"><i class="icon-komoo-plus middle"></i><span class="middle">'+G+"</span></div>"),n=$('<div class="map-button" id="drawing-control-cutout"><i class="icon-komoo-minus middle"></i><span class="middle">'+J+"</span></div>"),r=$('<div class="map-button" id="drawing-control-delete"><i class="icon-komoo-trash middle"></i></div>'),t=$("<div>").addClass(this.feature.getGeometryType().toLowerCase()),this.feature.getGeometryType()!==A&&t.append(e),this.feature.getGeometryType()===O&&t.append(n),this.feature.getGeometryType()!==A&&t.append(r),t},r.prototype.open=function(e){return this.feature=e,$("#drawing-control-title",this.box).html(this.getTitle()),$("#drawing-control-content",this.box).html(this.getContent()),this.handleButtonEvents(),this.box.show()},r.prototype.close=function(){return this.box.hide()},r}(o),_=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.enabled=!0,n.prototype.init=function(){var e=this;return n.__super__.init.call(this),this.circle=new q.Circle({visible:!0,radius:100,fillColor:"white",fillOpacity:0,strokeColor:"#ffbda8",zIndex:-1}),this.marker=new q.Marker({icon:"/static/img/marker.png"}),komoo.event.addListener(this.circle,"click",function(t){if(e.map.mode===L)return e.selected(t.latLng)})},n.prototype.select=function(e,t){this.radius=e,this.callback=t;if(!this.enabled)return;return this.origMode=this.map.mode,this.map.disableComponents("infoWindow"),this.map.setMode(L)},n.prototype.selected=function(e){return typeof this.radius=="number"&&this.circle.setRadius(this.radius),typeof this.callback=="function"&&this.callback(e,this.circle),this.circle.setCenter(e),this.circle.setMap(this.map.googleMap),this.marker.setPosition(e),this.marker.setMap(this.map.googleMap),this.map.publish("perimeter_selected",e,this.circle),this.map.setMode(this.origMode),this.map.enableComponents("infoWindow")},n.prototype.handleMapEvents=function(){var e,t,n,r,i,s=this;this.map.subscribe("select_perimeter",function(e,t){return s.select(e,t)}),r=["click","feature_click"],i=[];for(t=0,n=r.length;t<n;t++)e=r[t],i.push(this.map.subscribe(e,function(e){if(s.map.mode===L)return s.selected(e.latLng)}));return i},n.prototype.setMap=function(e){return this.map=e,this.handleMapEvents()},n.prototype.enable=function(){return this.enabled=!0},n.prototype.disable=function(){return this.hide(),this.enabled=!1},n}(f),s=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.defaultWidth="300px",n.prototype.enabled=!0,n.prototype.init=function(e){return this.options=e!=null?e:{},n.__super__.init.call(this),this.width=this.options.width||this.defaultWidth,this.createInfoBox(this.options),this.options.map&&this.setMap(this.options.map),this.customize()},n.prototype.createInfoBox=function(e){return this.setInfoBox(new InfoBox({pixelOffset:new q.Size(0,-20),enableEventPropagation:!0,closeBoxMargin:"10px",disableAutoPan:!0,boxStyle:{cursor:"pointer",background:"url(/static/img/infowindow-arrow.png) no-repeat 0 10px",width:this.width}}))},n.prototype.handleMapEvents=function(){var e=this;return this.map.subscribe("drawing_started",function(t){return e.disable()}),this.map.subscribe("drawing_finished",function(t){return e.enable()})},n.prototype.setInfoBox=function(e){this.infoBox=e},n.prototype.setMap=function(e){return this.map=e,this.handleMapEvents()},n.prototype.enable=function(){return this.enabled=!0},n.prototype.disable=function(){return this.close(!1),this.enabled=!1},n.prototype.open=function(e){var t,n,r,i,s,o,u,a;this.options=e!=null?e:{};if(!this.enabled)return;return this.setContent(this.options.content||(this.options.features?this.createClusterContent(this.options):this.createFeatureContent(this.options))),this.feature=(s=this.options.feature)!=null?s:(o=this.options.features)!=null?o.getAt(0):void 0,i=(u=this.options.position)!=null?u:this.feature.getCenter(),i instanceof Array&&(t=new komoo.geometries.Empty,i=t.getLatLngFromArray(i)),r=R.latLngToPoint(this.map,i),r.x+=5,n=R.pointToLatLng(this.map,r),this.infoBox.setPosition(n),this.infoBox.open((a=this.map.googleMap)!=null?a:this.map)},n.prototype.setContent=function(e){return e==null&&(e={title:"",body:""}),typeof e=="string"&&(e={title:"",url:"",body:e}),this.title.html(e.url?'<a href="'+e.url+"'\">"+e.title+"</a>":e.title),this.body.html(e.body)},n.prototype.close=function(){var e;return this.isMouseover=!1,this.infoBox.close(),((e=this.feature)!=null?e.isHighlighted():void 0)&&this.feature.setHighlight(!1),this.feature=null},n.prototype.customize=function(){var e=this;return q.event.addDomListener(this.infoBox,"domready",function(t){var n;return n=e.infoBox.div_,q.event.addDomListener(n,"click",function(e){return e.cancelBubble=!0,typeof e.stopPropagation=="function"?e.stopPropagation():void 0}),q.event.addDomListener(n,"mouseout",function(t){return e.isMouseover=!1}),komoo.event.trigger(e,"domready")}),this.initDomElements()},n.prototype.initDomElements=function(){var e=this;return this.title=$("<div>"),this.body=$("<div>"),this.content=$("<div>").addClass("map-infowindow-content"),this.content.append(this.title),this.content.append(this.body),this.content.css({background:"white",padding:"10px",margin:"0 0 0 15px"}),this.content.hover(function(t){return e.isMouseover=!0},function(t){return e.isMouseover=!1}),this.infoBox.setContent(this.content.get(0))},n.prototype.createClusterContent=function(e){var t,n,r,i;return e==null&&(e={}),r=e.features||[],i="<strong>"+r.length+" Communities</strong>",t=function(){var e,t,i,s;i=r.slice(0,11),s=[];for(e=0,t=i.length;e<t;e++)n=i[e],s.push("<li>"+n.getProperty("name")+"</li>");return s}(),t="<ul>"+t.join("")+"</ul>",{title:i,url:"",body:t}},n.prototype.createFeatureContent=function(e){var t,n;return e==null&&(e={}),n="",t=e.feature,t&&(n=t.getProperty(!1)?t.getProperty("organization_name")+" - "+t.getProperty("name"):t.getProperty("name")),{title:n,url:"",body:""}},n}(f),r=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.createFeatureContent=function(e){var t,r,i=this;e==null&&(e={}),t=e.feature;if(!t)return;return t[this.contentViewName]?t[this.contentViewName]:t.getProperty("id")==null?n.__super__.createFeatureContent.call(this,e):(r=dutils.urls.resolve(this.contentViewName,{zoom:this.map.getZoom(),app_label:t.featureType.appLabel,model_name:t.featureType.modelName,obj_id:t.getProperty("id")}),$.get(r,function(e){return t[i.contentViewName]=e,i.setContent(e)}),K)},n}(s),g=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.defaultWidth="350px",n.prototype.contentViewName="info_window",n.prototype.open=function(e){var t,r;return(t=this.feature)!=null&&(t.displayTooltip=!0),n.__super__.open.call(this,e),(r=this.feature)!=null?r.displayTooltip=!1:void 0},n.prototype.close=function(e){var t,r;return e==null&&(e=!0),(t=this.feature)!=null&&t.setHighlight(!1),(r=this.feature)!=null&&(r.displayTooltip=!0),e&&this.map.enableComponents("tooltip"),n.__super__.close.call(this)},n.prototype.customize=function(){var e=this;return n.__super__.customize.call(this),q.event.addDomListener(this.infoBox,"domready",function(t){var n,r;return r=e.content.get(0),n=e.infoBox.div_.firstChild,q.event.addDomListener(r,"mousemove",function(t){return e.map.disableComponents("tooltip")}),q.event.addDomListener(r,"mouseout",function(t){n=e.infoBox.div_.firstChild;if(t.toElement!==n)return e.map.enableComponents("tooltip")}),q.event.addDomListener(n,"click",function(t){return e.close()})})},n.prototype.handleMapEvents=function(){var e=this;return n.__super__.handleMapEvents.call(this),this.map.subscribe("feature_click",function(t,n){return setTimeout(function(){return e.open({feature:n,position:t.latLng})},200)}),this.map.subscribe("feature_highlight_changed",function(t,n){if(n.isHighlighted())return e.open({feature:n})})},n}(r),j=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.contentViewName="tooltip",n.prototype.close=function(){return clearTimeout(this.timer),n.__super__.close.call(this)},n.prototype.customize=function(){var e=this;return n.__super__.customize.call(this),q.event.addDomListener(this.infoBox,"domready",function(t){var n,r;return r=e.infoBox.div_,q.event.addDomListener(r,"click",function(t){return t.latLng=e.infoBox.getPosition(),e.map.publish("feature_click",t,e.feature)}),n=r.firstChild,$(n).hide()})},n.prototype.handleMapEvents=function(){var e=this;return n.__super__.handleMapEvents.call(this),this.map.subscribe("feature_mousemove",function(t,n){var r;clearTimeout(e.timer);if(n===e.feature||!n.displayTooltip)return;return r=n.getType()==="Community"?400:10,e.timer=setTimeout(function(){if(!n.displayTooltip)return;return e.open({feature:n,position:t.latLng})},r)}),this.map.subscribe("feature_mouseout",function(t,n){return e.close()}),this.map.subscribe("feature_click",function(t,n){return e.close()}),this.map.subscribe("cluster_mouseover",function(t,n){var r;if((r=t.getAt(0))!=null?!r.displayTooltip:!void 0)return;return e.open({features:t,position:n})}),this.map.subscribe("cluster_mouseout",function(t,n){return e.close()}),this.map.subscribe("cluster_click",function(t,n){return e.close()})},n}(r),v=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.enabled=!0,n.prototype.maxZoom=9,n.prototype.gridSize=20,n.prototype.minSize=1,n.prototype.imagePath="/static/img/cluster/communities",n.prototype.imageSizes=[24,29,35,41,47],n.prototype.init=function(e){var t,n,r,i,s;this.options=e!=null?e:{},(t=this.options).gridSize==null&&(t.gridSize=this.gridSize),(n=this.options).maxZoom==null&&(n.maxZoom=this.maxZoom),(r=this.options).minimumClusterSize==null&&(r.minimumClusterSize=this.minSize),(i=this.options).imagePath==null&&(i.imagePath=this.imagePath),(s=this.options).imageSizes==null&&(s.imageSizes=this.imageSizes),this.featureType=this.options.featureType,this.features=[];if(this.options.map)return this.setMap(this.options.map)},n.prototype.initMarkerClusterer=function(e){var t,n;return e==null&&(e={}),t=((n=this.map)!=null?n.googleMap:void 0)||this.map,this.clusterer=new N(t,[],e)},n.prototype.initEvents=function(e){var t,n=this;e==null&&(e=this.clusterer);if(!e)return;return t=["clusteringbegin","clusteringend"],t.forEach(function(t){return komoo.event.addListener(e,t,function(e){return komoo.event.trigger(n,t,n)})}),t=["click","mouseout","mouseover"],t.forEach(function(t){return komoo.event.addListener(e,t,function(e){var r,i;return r=komoo.collections.makeFeatureCollection({features:function(){var t,n,r,s;r=e.getMarkers(),s=[];for(t=0,n=r.length;t<n;t++)i=r[t],s.push(i.feature);return s}()}),komoo.event.trigger(n,t,r,e.getCenter()),n.map.publish("cluster_"+t,r,e.getCenter())})})},n.prototype.setMap=function(e){return this.map=e,this.initMarkerClusterer(this.options),this.initEvents(),this.addFeatures(this.map.getFeatures()),this.handleMapEvents()},n.prototype.handleMapEvents=function(){var e=this;return this.map.subscribe("feature_created",function(t){if(t.getType()===e.featureType)return e.push(t)})},n.prototype.updateLength=function(){return this.length=this.features.length},n.prototype.clear=function(){return this.features=[],this.clusterer.clearMarkers(),this.updateLength()},n.prototype.getAt=function(e){return this.features[e]},n.prototype.push=function(e){if(e.getMarker())return this.features.push(e),e.getMarker().setVisible(!1),this.clusterer.addMarker(e.getMarker().getOverlay().markers_.getAt(0)),this.updateLength()},n.prototype.pop=function(){var e;return e=this.features.pop(),this.clusterer.removeMarker(e.getMarker()),this.updateLength(),e},n.prototype.forEach=function(e,t){return this.features.forEach(e,t)},n.prototype.repaint=function(){return this.clusterer.repaint()},n.prototype.getAverageCenter=function(){return this.clusterer.getAverageCenter()},n.prototype.addFeatures=function(e){var t=this;return e!=null?e.forEach(function(e){return t.push(e)}):void 0},n}(f),E=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.enabled=!0,n.prototype.init=function(){return this.geocoder=new q.Geocoder,this.marker=new q.Marker({icon:"/static/img/marker.png"})},n.prototype.handleMapEvents=function(){var e=this;return this.map.subscribe("goto",function(t,n){return e.goTo(t,n)}),this.map.subscribe("goto_user_location",function(){return e.goToUserLocation()})},n.prototype.goTo=function(e,t){var n,r,i,s=this;return t==null&&(t=!1),i=function(e){if(e){s.map.googleMap.panTo(e);if(t)return s.marker.setPosition(e)}},typeof e=="string"?(r={address:e,region:this.region},this.geocoder.geocode(r,function(e,t){var n,r;if(t===q.GeocoderStatus.OK)return n=e[0],r=n.geometry.location,i(r)})):(n=e instanceof Array?e.length===2?new q.LatLng(e[0],e[1]):void 0:e,i(n))},n.prototype.goToUserLocation=function(){var e,t,n=this;e=google.loader.ClientLocation,e&&(t=new q.LatLng(e.latitude,e.longitude),this.map.googleMap.setCenter(t),typeof console!="undefined"&&console!==null&&console.log("Getting location from Google..."));if(navigator.geolocation)return navigator.geolocation.getCurrentPosition(function(e){return t=new q.LatLng(e.coords.latitude,e.coords.longitude),n.map.googleMap.setCenter(t),typeof console!="undefined"&&console!==null?console.log("Getting location from navigator.geolocation..."):void 0},function(){return typeof console!="undefined"&&console!==null?console.log("User denied access to navigator.geolocation..."):void 0})},n.prototype.setMap=function(e){return this.map=e,this.marker.setMap(this.map.googleMap),this.handleMapEvents()},n.prototype.enable=function(){return this.enabled=!0},n.prototype.disable=function(){return this.close(!1),this.enabled=!1},n}(f),D=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.handleMapEvents=function(){var e=this;return n.__super__.handleMapEvents.call(this),this.map.subscribe("save_location",function(t,n){return e.saveLocation(t,n)}),this.map.subscribe("goto_saved_location",function(){return e.goToSavedLocation()})},n.prototype.saveLocation=function(e,t){return e==null&&(e=this.map.googleMap.getCenter()),t==null&&(t=this.map.getZoom()),e!=null&&R.createCookie("lastLocation",e.toUrlValue(),90),R.createCookie("lastZoom",t,90)},n.prototype.goToSavedLocation=function(){var e,t;e=R.readCookie("lastLocation"),t=parseInt(R.readCookie("lastZoom"),10);if(e&&t)return typeof console!="undefined"&&console!==null&&console.log("Getting location from cookie..."),this.map.publish("set_location",e),this.map.publish("set_zoom",t)},n}(E),i=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.handleMapEvents=function(){var e=this;return n.__super__.handleMapEvents.call(this),this.map.subscribe("idle",function(){return e.saveLocation()})},n}(D),H=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.enabled=!0,n.prototype.init=function(){return typeof console!="undefined"&&console!==null&&console.log("Initializing StreetView support."),this.streetViewPanel=$("<div>").addClass("map-panel"),this.streetViewPanel.height("100%").width("50%"),this.streetViewPanel.hide(),this.createObject()},n.prototype.setMap=function(e){this.map=e,this.map.googleMap.controls[q.ControlPosition.TOP_LEFT].push(this.streetViewPanel.get(0));if(this.streetView!=null)return this.map.googleMap.setStreetView(this.streetView)},n.prototype.createObject=function(){var e,t,n=this;return e={enableCloseButton:!0,visible:!1},this.streetView=new q.StreetViewPanorama(this.streetViewPanel.get(0),e),(t=this.map)!=null&&t.googleMap.setStreetView(this.streetView),q.event.addListener(this.streetView,"visible_changed",function(){return n.streetView.getVisible()?n.streetViewPanel.show():n.streetViewPanel.hide()})},n}(f),window.komoo.controls={DrawingManager:h,DrawingControl:c,GeometrySelector:m,Balloon:s,AjaxBalloon:r,InfoWindow:g,Tooltip:j,FeatureClusterer:v,CloseBox:a,SupporterBox:B,LicenseBox:w,SearchBox:P,PerimeterSelector:_,Location:E,SaveLocation:D,AutosaveLocation:i,StreetView:H},window.komoo.controls})}.call(this),function(){var e=Object.prototype.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("core/map/maptypes",["require","services/googlemaps","./component"],function(e){var n,r,i,s;return i=e("services/googlemaps"),r=e("./component"),window.komoo==null&&(window.komoo={}),(s=window.komoo).event==null&&(s.event=i.event),n=function(e){function n(){this.mapType=new i.StyledMapType([{featureType:"poi",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"all",stylers:[{lightness:70}]},{featureType:"transit",elementType:"all",stylers:[{lightness:50}]},{featureType:"water",elementType:"all",stylers:[{lightness:50}]},{featureType:"administrative",elementType:"labels",stylers:[{lightness:30}]}],{name:i18n("Clean")})}return t(n,e),n.prototype.id="clean",n.prototype.setMap=function(e){var t;return this.map=e,this.map.googleMap.mapTypes.set(this.id,this.mapType),t=this.map.googleMap.mapTypeControlOptions,t.mapTypeIds.push(this.id),this.map.googleMap.setOptions({mapTypeControlOptions:t}),this.map.googleMap.setMapTypeId(this.id)},n}(r),window.komoo.maptypes={CleanMapType:n},window.komoo.maptypes})}.call(this),function(){var e=Object.prototype.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("core/map/providers",["require","services/googlemaps","./component"],function(e){var n,r,i,s,o;return s=e("services/googlemaps"),n=e("./component"),window.komoo==null&&(window.komoo={}),(o=window.komoo).event==null&&(o.event=s.event),i=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.name="Generic Provider",n.prototype.alt="Generic Data Provider",n.prototype.tileSize=new s.Size(256,256),n.prototype.maxZoom=32,n.prototype.enabled=!0,n.prototype.init=function(e){return this.options=e,this.addrLatLngCache={},this.fetchedTiles={}},n.prototype.setMap=function(e){return this.map=e,this.map.googleMap.overlayMapTypes.insertAt(0,this),typeof this.handleMapEvents=="function"?this.handleMapEvents():void 0},n.prototype.enable=function(){return this.enabled=!0},n.prototype.disable=function(){return this.enabled=!1},n.prototype.getAddrLatLng=function(e,t){var n,r,i,o,u,a,f;return n="x="+e.x+",y="+e.y+",z="+t,this.addrLatLngCache[n]?this.addrLatLngCache[n]:(i=1<<t,a=this.map.googleMap.getProjection(),o=new s.Point((e.x+1)*this.tileSize.width/i,e.y*this.tileSize.height/i),u=new s.Point(e.x*this.tileSize.width/i,(e.y+1)*this.tileSize.height/i),r=a.fromPointToLatLng(o),f=a.fromPointToLatLng(u),this.addrLatLngCache[n]="bounds="+r.toUrlValue()+","+f.toUrlValue()+"&zoom="+t)},n}(n),r=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.name="Feature Provider",n.prototype.alt="Feature Provider",n.prototype.fetchUrl="/get_geojson?",n.prototype.init=function(e){return n.__super__.init.call(this,e),this.keptFeatures=komoo.collections.makeFeatureCollection()},n.prototype.handleMapEvents=function(){var e=this;return this.map.subscribe("idle",function(){var t;if(e.enabled===!1)return;return t=e.map.googleMap.getBounds(),e.keptFeatures.forEach(function(e){if(!t.intersects(e.getBounds()))return e.setMap(null)}),e.keptFeatures.clear()})},n.prototype.releaseTile=function(e){var t,n=this;if(this.enabled===!1)return;if(this.fetchedTiles[e.addr])return t=this.map.getBounds(),this.fetchedTiles[e.addr].features.forEach(function(e){if(e.getBounds){if(!t.intersects(e.getBounds()))return e.setMap(null);if(!t.contains(e.getBounds().getNorthEast()||!t.contains(e.getBounds().getSouthWest())))return n.keptFeatures.push(e),e.setMap(n.map)}else if(e.getPosition&&!t.contains(e.getPosition()))return e.setMap(null)})},n.prototype.getTile=function(e,t,n){var r,i,s=this;return i=n.createElement("DIV"),r=this.getAddrLatLng(e,t),i.addr=r,this.enabled===!1?i:this.fetchedTiles[r]?(this.fetchedTiles[r].features.setMap(this.map),i):($.ajax({url:this.fetchUrl+r,dataType:"json",type:"GET",success:function(e){var t;return t=s.map.loadGeoJSON(JSON.parse(e),!1),s.fetchedTiles[r]={geojson:e,features:t},t.setMap(s.map)},error:function(e,t){var n,r;return typeof console!="undefined"&&console!==null&&console.error(t),r=$("#server-error"),r.parent().length===0&&(r=$("<div>").attr("id","server-error"),$("body").append(r)),n=$("<div>").html(e.responseText),r.append(n)}}),i)},n}(i),window.komoo.providers={GenericProvider:i,FeatureProvider:r,makeFeatureProvider:function(e){return new r(e)}},window.komoo.providers})}.call(this);