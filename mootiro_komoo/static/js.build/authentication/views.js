(function(){var e=Object.prototype.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define(["require","underscore","backbone","./models","./forms","text!templates/authentication/_login.html","text!templates/authentication/_register.html","text!templates/authentication/_social_button.html","text!templates/authentication/_not_verified.html","text!templates/authentication/_verified.html"],function(e){var n,r,i,s,o,u,a,f,l,c,h,p,d,v,m;return m=e("underscore"),n=e("backbone"),c=e("./models"),f=e("./forms"),l=e("text!templates/authentication/_login.html"),p=e("text!templates/authentication/_register.html"),d=e("text!templates/authentication/_social_button.html"),h=e("text!templates/authentication/_not_verified.html"),v=e("text!templates/authentication/_verified.html"),o=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.tagName="li",n.prototype.template=m.template(d),n.prototype.initialize=function(){return m.bindAll(this,"render"),this.className=this.options.provider,this.url=""+this.options.url+"?next="+(this.options.next||""),this.image_url=this.options.image_url,this.msg=this.options.message,this.provider=this.options.provider},n.prototype.render=function(){var e;return e=this.template({provider:this.provider,url:this.url,image_url:this.image_url,msg:this.msg}),this.$el.html(e),this.$el.addClass(this.className),this},n}(n.View),u=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.tagName="ul",n.prototype.id="external_providers",n.prototype.initialize=function(){return m.bindAll(this,"render"),this.buttons=this.options.buttons},n.prototype.render=function(){var e,t=this;return e=this.buttons,this.$el.html(""),m.each(e,function(e){var n;return n=new o(e),t.$el.append(n.render().el)}),this},n}(n.View),r=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.id="login_box",n.prototype.tagName="section",n.prototype.template=m.template(l),n.prototype.initialize=function(){var e,t;return m.bindAll(this,"render","buildButtons","updateUrls"),e=((t=this.options)!=null?t.next:void 0)||"",this.buildButtons(e),this.model=new c.LoginModel({}),this.form=new f.LoginForm({formId:"form_login",model:this.model})},n.prototype.render=function(){var e;return e=this.template({}),this.$el.html(e),this.$el.find(".social_buttons").append(this.socialBtnsView.render().el),this.$el.find(".login_form").append(this.form.render().el),this},n.prototype.buildButtons=function(e){var t,n;return e==null&&(e=""),n={provider:"google",url:dutils.urls.resolve("login_google"),next:e,image_url:"/static/img/login-google.png",message:i18n("Log In with Google")},t={provider:"facebook",url:dutils.urls.resolve("login_facebook"),next:e,image_url:"/static/img/login-facebook.png",message:i18n("Log In with Facebook")},this.socialBtnsView=new u({buttons:[n,t]})},n.prototype.updateUrls=function(e){return e==null&&(e=""),this.model.set({next:e}),this.buildButtons(e),this.render(),this},n}(n.View),i=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(){return m.bindAll(this),this.model=new c.LogoutModel({})},n.prototype.bindLogoutButton=function(){var e=this;return $(".logout-btn").click(function(t){var n;return t.preventDefault(),n=$(t.target).attr("href"),(n!=null?n.charAt(0):void 0)==="#"&&(n=document.location.pathname+n),e.model.doLogout(n),!1})},n}(n.View),s=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.template=m.template(p),n.prototype.className="register",n.prototype.tagName="section",n.prototype.initialize=function(){var e;return m.bindAll(this),e=new c.User({}),this.form=new f.RegisterForm({formId:"form_register",submit_label:i18n("Register"),model:e})},n.prototype.render=function(){var e;return e=this.template({}),this.$el.html(e),this.$el.find(".form-wrapper").append(this.form.render().el),this},n}(n.View),a=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(){return m.bindAll(this),this.verified=this.options.verified,this.verified?(this.template=m.template(v),this.loginModel=new c.LoginModel,this.loginForm=new f.LoginForm({model:this.loginModel})):this.template=m.template(h)},n.prototype.render=function(){var e;return e=this.template({}),this.$el.html(e),this.verified&&this.$el.find(".login-form-box").append(this.loginForm.render().el),this},n}(n.View),{LoginView:r,LogoutView:i,RegisterView:s,VerificationView:a}})}).call(this)