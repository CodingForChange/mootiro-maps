(function(){var e=Object.prototype.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define(["require","underscore","backbone","./models","./forms","urls","text!templates/authentication/_social_button.html","text!templates/authentication/_login.html","text!templates/authentication/_register.html","text!templates/authentication/_verified.html","text!templates/authentication/_not_verified.html"],function(e){var n,r,i,s,o,u,a,f,l,c,h;return h=e("underscore"),n=e("backbone"),c=e("./models"),l=e("./forms"),f=e("urls"),o=function(n){function r(){r.__super__.constructor.apply(this,arguments)}return t(r,n),r.prototype.tagName="li",r.prototype.initialize=function(){return h.bindAll(this,"render"),this.template=h.template(e("text!templates/authentication/_social_button.html")),this.className=this.options.provider,this.url=""+this.options.url+"?next="+(this.options.next||""),this.image_url=this.options.image_url,this.msg=this.options.message,this.provider=this.options.provider},r.prototype.render=function(){var e;return e=this.template({provider:this.provider,url:this.url,image_url:this.image_url,msg:this.msg}),this.$el.html(e),this.$el.addClass(this.className),this},r}(n.View),u=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.tagName="ul",n.prototype.className="external_providers",n.prototype.initialize=function(){return h.bindAll(this,"render"),this.buttons=this.options.buttons},n.prototype.render=function(){var e,t=this;return e=this.buttons,this.$el.html(""),h.each(e,function(e){var n;return n=new o(e),t.$el.append(n.render().el)}),this},n}(n.View),r=function(n){function r(){r.__super__.constructor.apply(this,arguments)}return t(r,n),r.prototype.className="login_box",r.prototype.tagName="section",r.prototype.initialize=function(){var t,n;return h.bindAll(this),this.template=h.template(e("text!templates/authentication/_login.html")),t=((n=this.options)!=null?n.next:void 0)||"",this.buildButtons(t),this.model=new c.LoginModel({}),this.form=new l.LoginForm({formId:"form_login",model:this.model})},r.prototype.render=function(){var e;return e=this.template({}),this.$el.html(e),this.$el.find(".social_buttons").append(this.socialBtnsView.render().el),this.$el.find(".login_form").append(this.form.render().el),this},r.prototype.buildButtons=function(e){var t,n;return e==null&&(e=""),n={provider:"google",url:f.urls.resolve("login_google"),next:e,image_url:"/static/img/login-google.png",message:i18n("Log In with Google")},t={provider:"facebook",url:f.urls.resolve("login_facebook"),next:e,image_url:"/static/img/login-facebook.png",message:i18n("Log In with Facebook")},this.socialBtnsView=new u({buttons:[n,t]})},r.prototype.updateUrls=function(e){return e==null&&(e=""),this.model.set({next:e}),this.buildButtons(e),this.render(),this},r}(n.View),i=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(e){return this.options=e,h.bindAll(this),this.model=new c.LogoutModel({})},n.prototype.logout=function(e){return this.model.doLogout(e)},n.prototype.bindLogoutButton=function(){var e=this;return $(".logout").click(function(t){var n;return t.preventDefault(),n=$(t.target).attr("href"),(n!=null?n.charAt(0):void 0)==="#"&&(n=document.location.pathname+n),e.logout(n),!1})},n}(n.View),s=function(n){function r(){r.__super__.constructor.apply(this,arguments)}return t(r,n),r.prototype.className="register",r.prototype.tagName="section",r.prototype.initialize=function(){var t;return h.bindAll(this),this.template=h.template(e("text!templates/authentication/_register.html")),t=new c.User({}),this.form=new l.RegisterForm({formId:"form_register",submit_label:i18n("Register"),model:t})},r.prototype.render=function(){var e;return e=this.template({}),this.$el.html(e),this.$el.find(".form-wrapper").append(this.form.render().el),this},r}(n.View),a=function(n){function r(){r.__super__.constructor.apply(this,arguments)}return t(r,n),r.prototype.initialize=function(){return h.bindAll(this),this.verified=this.options.verified,this.verified?(this.template=h.template(e("text!templates/authentication/_verified.html")),this.loginModel=new c.LoginModel({}),this.loginForm=new l.LoginForm({model:this.loginModel})):this.template=h.template(e("text!templates/authentication/_not_verified.html"))},r.prototype.render=function(){var e;return e=this.template({}),this.$el.html(e),this.verified&&this.$el.find(".login-form-box").append(this.loginForm.render().el),this},r}(n.View),{LoginView:r,LogoutView:i,RegisterView:s,VerificationView:a}})}).call(this);