(function(){var e=Object.prototype.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define(["require","jquery","underscore","backbone","text!templates/main/_page.html"],function(e){var n,r,i,s,o;return n=e("jquery"),o=e("underscore"),r=e("backbone"),i=function(n){function r(){r.__super__.constructor.apply(this,arguments)}return t(r,n),r.prototype.className="page",r.prototype.template=o.template(e("text!templates/main/_page.html")),r.prototype.initialize=function(){return this.views=[{name:"actionBar",parentSelector:"#action-bar"},{name:"sidebar",parentSelector:"#sidebar"},{name:"mainContent",parentSelector:"#main-content"}],this.setViews(this.options.views)},r.prototype.render=function(){return this.$el.html(this.template({}))},r.prototype.setViews=function(e){var t,n,r,i,s;e==null&&(e=[]),i=this.views,s=[];for(n=0,r=i.length;n<r;n++)t=i[n],t.instance!=null&&this._removeView(t.instance),s.push(t.instance=e[t.name]);return s},r.prototype.open=function(){var e,t,n,r,i,s,o;this.render(),e=function(t){var n,r,i,s;if(!t)return;if(t.subViews){s=t.subViews;for(r=0,i=s.length;r<i;r++)n=s[r],e(n)}return typeof t.onOpen=="function"?t.onOpen():void 0},i=this.views,o=[];for(n=0,r=i.length;n<r;n++)t=i[n],this.$(t.parentSelector).append((s=t.instance)!=null?s.$el:void 0),o.push(e(t.instance));return o},r.prototype.canClose=function(){var e,t,n,r,i,s,o;e=!0,i=this.views;for(n=0,r=i.length;n<r;n++)t=i[n],e=(s=e&&((o=t.instance)!=null?typeof o.canClose==="function"?o.canClose():void 0:void 0))!=null?s:!0;return e},r.prototype._removeView=function(e){var t,n,r,i,s,o,u;if(!e)return;if(e.subViews){if(e.subViews){o=e.subViews;for(n=0,i=o.length;n<i;n++)t=o[n],this._removeView(t)}e.subViews=void 0;if(e.instances){u=e.instances;for(r=0,s=u.length;r<s;r++)t=u[r],this._removeView(t)}e.instances=void 0}return typeof e.onClose=="function"&&e.onClose(),e.unbind(),e.remove(),e.$el.detach(),e.$el=void 0,e.el=void 0,e.model=void 0,e.collection=void 0},r.prototype.close=function(){var e,t,n,r;r=this.views;for(t=0,n=r.length;t<n;t++)e=r[t],this._removeView(e.instance);return this.remove(),this.$el=void 0},r}(r.View),s=function(){function e(){}return e.prototype.Page=i,e.prototype.currentPage=null,e.prototype.canClose=function(){var e,t,r;return e=new n.Deferred,((t=(r=this.currentPage)!=null?typeof r.canClose==="function"?r.canClose():void 0:void 0)!=null?t:!0)?e.resolve():window.confirm("You haven't saved your changes yet. Do you want to leave without finishing?")?e.resolve():e.reject(),e.promise()},e.prototype.open=function(e){if(!e||e===this.currentPage)return;return this.close(this.currentPage),this.currentPage=e,n("#content").append(this.currentPage.$el),this.currentPage.open()},e.prototype.close=function(e){if(!e)return;e.close(),n("#content").html("");if(this.currentPage===e)return this.currentPage=null},e}(),new s})}).call(this);