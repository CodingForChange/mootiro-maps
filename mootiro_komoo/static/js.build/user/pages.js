(function(){var e=Object.prototype.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define(["require","jquery","backbone","core/page_manager","./views"],function(e){var n,r,i,s,o,u;return n=e("jquery"),r=e("backbone"),o=e("core/page_manager"),u=e("./views"),s=function(e){function r(){r.__super__.constructor.apply(this,arguments)}return t(r,e),r.prototype.initialize=function(){var e;return this.mode=(e=this.options.mode)!=null?e:"view",this.id="user::profile::"+this.model.id,r.__super__.initialize.apply(this,arguments)},r.prototype.setMode=function(e){var t,n,r,i,s;if(this.mode===e)return;i=this.views;for(n=0,r=i.length;n<r;n++)t=i[n],(s=t.instance)!=null&&typeof s.setMode=="function"&&s.setMode(e);this.mode=e;if(e===null)return this.model.view()},r.prototype.render=function(){var e,t,i=this;return r.__super__.render.apply(this,arguments),e=new n.Deferred,((t=o.currentPage)!=null?t.id:void 0)===this.id?(o.currentPage.setMode(this.mode),e.resolve(),e.promise()):(window.user=this.model,this.model.fetch().done(function(){var t;return t={model:i.model,mode:i.mode},i.setViews({actionBar:new u.ActionBar(t),sidebar:new u.Sidebar(t),mainContent:new u.Profile(t)}),o.open(i),e.resolve()}).fail(function(t){return e.reject(t)}),e.promise())},r}(o.Page),i=function(e){function n(){n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(){return this.options.mode="edit",n.__super__.initialize.apply(this,arguments)},n}(s),{Profile:s,Edit:i}})}).call(this);