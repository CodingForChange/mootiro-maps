(function(){var e=Object.prototype.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define(["require","jquery","backbone","core/page_manager","./views"],function(e){var n,r,i,s,o,u;return n=e("jquery"),r=e("backbone"),o=e("core/page_manager"),u=e("./views"),s=function(e){function r(e,t){this.model=e,this.mode=t!=null?t:"view",r.__super__.constructor.apply(this,arguments),this.id="user::profile::"+this.model.id}return t(r,e),r.prototype.setMode=function(e){var t,n,r,i,s;this.mode===e&&e==="edit"&&(e=null),i=this.views;for(n=0,r=i.length;n<r;n++)t=i[n],(s=t.instance)!=null&&typeof s.setMode=="function"&&s.setMode(e);this.mode=e;if(e===null)return this.model.goToProfile()},r.prototype.render=function(){var e,t,r=this;return e=new n.Deferred,((t=o.currentPage)!=null?t.id:void 0)===this.id?(o.currentPage.setMode(this.mode),e.resolve(),e.promise()):(window.user=this.model,this.model.fetch().done(function(){var t;return t={model:r.model,mode:r.mode},r.setViews({actionBar:new u.ActionBar(t),sidebar:new u.Sidebar(t),mainContent:new u.Profile(t)}),o.open(r),e.resolve()}).fail(function(t){return e.reject(t)}),e.promise())},r}(o.Page),i=function(e){function n(e,t){t==null&&(t="edit"),n.__super__.constructor.call(this,e,t)}return t(n,e),n}(s),{Profile:s,Edit:i}})}).call(this);