(function(){define(["require","jquery","underscore","backbone","text!templates/user/_profile.html","text!templates/user/_sidebar.html","text!templates/user/_update_item.html","text!templates/user/_updates_block.html","widgets/list"],function(e){var t,n,r,i,s,o,u;return t=e("jquery"),u=e("underscore"),n=e("backbone"),r=n.View.extend({initialize:function(){return u.bindAll(this),this.template=u.template(e("text!templates/user/_profile.html")),this.listenTo(this.model,"change",this.render),this.updatesView=new o({collection:this.model.getUpdates()}),this.subViews=[this.updatesView],this.render()},render:function(){return this.updatesView.$el.detach(),this.$el.html(this.template({user:this.model.toJSON()})),this.$("#user-updates-container").append(this.updatesView.$el),this}}),i=n.View.extend({initialize:function(){return u.bindAll(this),this.template=u.template(e("text!templates/user/_sidebar.html")),this.render()},render:function(){return this.$el.html(this.template({user:this.model.toJSON()})),this}}),s=n.View.extend({tagName:"li",events:{"click .see-on-map":"seeOnMap"},initialize:function(){return u.bindAll(this),this.template=u.template(e("text!templates/user/_update_item.html")),this.listenTo(this.model,"change",this.render),this.render()},render:function(){var e,t;return this.$el.removeClass().addClass([(e=this.model.get("type"))!=null?e.toLowerCase():void 0,(t=this.model.get("action"))!=null?t.toLowerCase():void 0]),this.$el.html(this.template({update:this.model.toJSON()})),this},seeOnMap:function(e){return e!=null&&typeof e.preventDefault=="function"&&e.preventDefault(),n.trigger("map::see-on-map",this.model),this}}),o=n.View.extend({events:{"click a.previous":"previousPage","click a.next":"nextPage","keypress .current-page":"goTo"},initialize:function(){var t;return u.bindAll(this),this.template=u.template(e("text!templates/user/_updates_block.html")),t=e("widgets/list"),this.listView=new t({collection:this.collection,className:"updates list",ItemView:s}),this.subViews=[this.listView],this.listenTo(this.collection,"reset",this.update),this.render()},render:function(){return this.listView.$el.detach(),this.$el.html(this.template(this.collection)),this.$(".list-container").prepend(this.listView.$el),this},update:function(){return this.$(".current-page").val(this.collection.currentPage+1),this.$(".total-pages").text(this.collection.totalPages),this.collection.currentPage===0?this.$(".previous").addClass("disabled"):this.$(".previous").removeClass("disabled"),this.collection.currentPage===this.collection.totalPages-1?this.$(".next").addClass("disabled"):this.$(".next").removeClass("disabled")},previousPage:function(e){return e!=null&&typeof e.preventDefault=="function"&&e.preventDefault(),this.collection.currentPage>this.collection.firstPage&&this.collection.requestPreviousPage(),this},nextPage:function(e){return e!=null&&typeof e.preventDefault=="function"&&e.preventDefault(),this.collection.currentPage<this.collection.totalPages-1&&this.collection.requestNextPage(),this},goTo:function(e){var t;if(e.keyCode!==13)return;t=parseInt(this.$(".current-page").val(),10);if(u.isNaN(t)||t<=0||t>this.collection.totalPages){this.update();return}return this.collection.goTo(t-1)}}),{Profile:r,Updates:o,Sidebar:i}})}).call(this);