(function(){var e=Object.prototype.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define(["require","jquery","underscore","backbone","reForm","main/views","text!templates/user/_user_info.html","text!templates/user/_profile.html","text!templates/user/_sidebar.html","text!templates/user/_update_item.html","text!templates/user/_updates_block.html","widgets/list"],function(e){var n,r,i,s,o,u,a,f,l,c;return n=e("jquery"),c=e("underscore"),i=e("backbone"),o=e("reForm"),r=e("main/views").ActionBar,l=function(n){function r(){r.__super__.constructor.apply(this,arguments)}return t(r,n),r.prototype.initialize=function(){return c.bindAll(this),this.template=c.template(e("text!templates/user/_user_info.html")),this.listenTo(this.model,"change",this.render),this.render()},r.prototype.render=function(){return this.$el.html(this.template({user:this.model.toJSON()}))},r}(i.View),s=function(n){function r(){r.__super__.constructor.apply(this,arguments)}return t(r,n),r.prototype.initialize=function(){return window.model=this.model,c.bindAll(this),this.template=c.template(e("text!templates/user/_profile.html")),this.userInfoView=new l({model:this.model}),this.updatesView=new f({collection:this.model.getUpdates()}),this.subViews=[this.userInfoView,this.updatesView],this.render()},r.prototype.render=function(){return this.userInfoView.$el.detach(),this.updatesView.$el.detach(),this.$el.html(this.template({user:this.model.toJSON()})),this.$("#user-info-container").append(this.userInfoView.$el),this.$("#user-updates-container").append(this.updatesView.$el),this},r}(i.View),u=function(n){function r(){r.__super__.constructor.apply(this,arguments)}return t(r,n),r.prototype.initialize=function(){return c.bindAll(this),this.template=c.template(e("text!templates/user/_sidebar.html")),this.render()},r.prototype.render=function(){return this.$el.html(this.template({user:this.model.toJSON()})),this},r}(i.View),a=function(n){function r(){r.__super__.constructor.apply(this,arguments)}return t(r,n),r.prototype.tagName="li",r.prototype.events={"click .see-on-map":"seeOnMap"},r.prototype.initialize=function(){return c.bindAll(this),this.template=c.template(e("text!templates/user/_update_item.html")),this.listenTo(this.model,"change",this.render),this.render()},r.prototype.render=function(){var e,t;return this.$el.removeClass().addClass([(e=this.model.get("type"))!=null?e.toLowerCase():void 0,(t=this.model.get("action"))!=null?t.toLowerCase():void 0]),this.$el.html(this.template({update:this.model.toJSON()})),this},r.prototype.seeOnMap=function(e){return e!=null&&typeof e.preventDefault=="function"&&e.preventDefault(),i.trigger("map::see-on-map",this.model),this},r}(i.View),f=function(n){function r(){r.__super__.constructor.apply(this,arguments)}return t(r,n),r.prototype.events={"click a.previous":"previousPage","click a.next":"nextPage","keypress .current-page":"goTo"},r.prototype.initialize=function(){var t;return c.bindAll(this),this.template=c.template(e("text!templates/user/_updates_block.html")),t=e("widgets/list"),this.listView=new t({collection:this.collection,className:"updates list",ItemView:a}),this.subViews=[this.listView],this.listenTo(this.collection,"reset",this.update),this.render()},r.prototype.render=function(){return this.listView.$el.detach(),this.$el.html(this.template(this.collection)),this.$(".list-container").prepend(this.listView.$el),this},r.prototype.update=function(){return this.$(".current-page").val(this.collection.currentPage+1),this.$(".total-pages").text(this.collection.totalPages),this.collection.currentPage===0?this.$(".previous").addClass("disabled"):this.$(".previous").removeClass("disabled"),this.collection.currentPage===this.collection.totalPages-1?this.$(".next").addClass("disabled"):this.$(".next").removeClass("disabled")},r.prototype.previousPage=function(e){return e!=null&&typeof e.preventDefault=="function"&&e.preventDefault(),this.collection.currentPage>this.collection.firstPage&&this.collection.requestPreviousPage(),this},r.prototype.nextPage=function(e){return e!=null&&typeof e.preventDefault=="function"&&e.preventDefault(),this.collection.currentPage<this.collection.totalPages-1&&this.collection.requestNextPage(),this},r.prototype.goTo=function(e){var t;if(e.keyCode!==13)return;t=parseInt(this.$(".current-page").val(),10);if(c.isNaN(t)||t<=0||t>this.collection.totalPages){this.update();return}return this.collection.goTo(t-1)},r}(i.View),{Profile:s,Updates:f,ActionBar:r,Sidebar:u}})}).call(this);