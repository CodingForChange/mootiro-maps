(function(){var e=Object.prototype.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define(["require","underscore","backbone","user/pages"],function(e){var n,r,i;return i=e("underscore"),n=e("backbone"),r=function(r){function s(){s.__super__.constructor.apply(this,arguments)}return t(s,r),s.prototype.routes={"user(/)":"user","user/:id(/)":"profile"},s.prototype.initialize=function(){return i.bindAll(this),this.bindExternalEvents()},s.prototype.bindExternalEvents=function(){return n.on("user::profile",this.profile)},s.prototype.user=function(){var e,t,r;if(typeof KomooNS!="undefined"&&KomooNS!==null?!KomooNS.isAuthenticated:!void 0)return r=window.location,r.search&&r.search.indexOf("next")>-1&&(t={},r.search.replace(new RegExp("([^?=&]+)(=([^&]*))?","g"),function(e,n,r,i){return t[n]=i}),e=t.next),n.trigger("auth::loginRequired",e)},s.prototype.profile=function(t){var n;return n=e("user/pages").profile,n.render(t),this.navigate("user/"+t)},s}(n.Router),new r})}).call(this);