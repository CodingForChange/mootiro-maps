(function(){var e=Object.prototype.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t},n=Array.prototype.slice;define(["require","underscore","backbone","./pages"],function(e){var r,i,s,o;return o=e("underscore"),r=e("backbone"),s=e("./pages"),i=function(e){function i(){i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.routes={"users(/)":"user","users/:id(/)":"profile"},i.prototype.initialize=function(){return o.bindAll(this),this.bindExternalEvents()},i.prototype.bindExternalEvents=function(){return r.on("user::profile",this.profile)},i.prototype.goTo=function(){var e,t;return t=arguments[0],e=2<=arguments.length?n.call(arguments,1):[],t.render(e).fail(function(e){return r.trigger("main::error",e.status,e.statusText)})},i.prototype.user=function(){var e,t,n;if(typeof KomooNS!="undefined"&&KomooNS!==null?!KomooNS.isAuthenticated:!void 0)return n=window.location,n.search&&n.search.indexOf("next")>-1&&(t={},n.search.replace(new RegExp("([^?=&]+)(=([^&]*))?","g"),function(e,n,r,i){return t[n]=i}),e=t.next),r.trigger("auth::loginRequired",e)},i.prototype.profile=function(e){return this.goTo(s.profile,e),this.navigate("users/"+e)},i}(r.Router),new i})}).call(this);