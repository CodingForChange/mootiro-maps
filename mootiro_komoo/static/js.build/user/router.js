(function(){var e=Object.prototype.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define(["require","underscore","backbone","./pages","page_manager"],function(e){var n,r,i,s;return s=e("underscore"),n=e("backbone"),i=e("./pages"),window.pageManager=e("page_manager"),r=function(e){function r(){r.__super__.constructor.apply(this,arguments)}return t(r,e),r.prototype.routes={"users(/)":"user","users/:id(/)":"profile","users/:id/edit(/)":"edit"},r.prototype.initialize=function(){return s.bindAll(this),this.bindExternalEvents()},r.prototype.bindExternalEvents=function(){return n.on("user::profile",this.profile),n.on("user::edit",this.edit)},r.prototype.goTo=function(e){return e.render().fail(function(e){return n.trigger("main::error",e.status,e.statusText)})},r.prototype.user=function(){var e,t,r;if(typeof KomooNS!="undefined"&&KomooNS!==null?!KomooNS.isAuthenticated:!void 0)return r=window.location,r.search&&r.search.indexOf("next")>-1&&(t={},r.search.replace(new RegExp("([^?=&]+)(=([^&]*))?","g"),function(e,n,r,i){return t[n]=i}),e=t.next),n.trigger("auth::loginRequired",e)},r.prototype.profile=function(e){return this.navigate("users/"+e),this.goTo(new i.Profile(e))},r.prototype.edit=function(e){return this.navigate("users/"+e+"/edit"),this.goTo(new i.Edit(e))},r}(n.Router),new r})}).call(this);