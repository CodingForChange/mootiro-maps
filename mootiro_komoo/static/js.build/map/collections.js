var __hasProp=Object.prototype.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define(["googlemaps"],function(e){var t,n,r,i,s;return window.komoo==null&&(window.komoo={}),(s=window.komoo).event==null&&(s.event=e.event),r=function(){function e(e){this.options=e!=null?e:{},this.elements=[],this.length=0}return e.prototype.updateLength=function(){return this.length=this.elements.length},e.prototype.clear=function(){return this.elements=[],this.updateLength()},e.prototype.getAt=function(e){return this.elements[e]},e.prototype.push=function(e){return this.elements.push(e),this.updateLength()},e.prototype.pop=function(){var e;return e=this.elements.pop(),this.updateLength(),e},e.prototype.forEach=function(e,t){return this.elements.forEach(e,t)},e.prototype.getArray=function(){return this.elements},e.prototype.slice=function(e,t){return this.elements.slice(e,t)},e}(),t=function(t){function n(e){var t,r=this;e==null&&(e={}),n.__super__.constructor.call(this,e),e.map&&this.setMap(e.map),(t=e.features)!=null&&t.forEach(function(e){return r.push(e)})}return __extends(n,t),n.prototype.push=function(e){if(e==null)return;return n.__super__.push.call(this,e),e.setMap(this.map)},n.prototype.getBounds=function(){var t,n,r,i=this;return t=this.getAt(0),t&&t.getGeometryType()!=="Empty"&&(n=t.getGeometry(),r=n.getLatLngFromArray(n.getCenter()),this.bounds=new e.LatLngBounds(r,r),this.forEach(function(e){var t;return(t=i.bounds)!=null?t.union(e.getBounds()):void 0})),this.bounds},n.prototype.setMap=function(e,t){var n,r=this;return this.map=e,n=null,this.forEach(function(e){return t!=null&&(n={geometry:t!=null?t.geometry:void 0,point:t!=null?t.icon:void 0,icon:t!=null?t.icon:void 0}),e.getType()==="Community"&&n!=null&&(n.point=!1),e!=null?e.setMap(r.map,n):void 0}),this.handleMapEvents()},n.prototype.show=function(){return this.setMap(this.map,{geometry:!0}),this.setVisible(!0)},n.prototype.hide=function(){return this.setVisible(!1)},n.prototype.getGeoJson=function(e){var t;return e.geometryCollection==null&&(e.geometryCollection=!1),e.geometryCollection?(t={type:"GeometryCollection",geometries:[]},this.forEach(function(e){return t.geometries.push(e.getGeometryGeoJson())})):(t={type:"FeatureCollection",features:[]},this.forEach(function(e){return t.features.push(e.getGeoJson())})),t},n.prototype.removeAllFromMap=function(){return this.forEach(function(e){return e.removeFromMap()})},n.prototype.setVisible=function(e){return this.forEach(function(t){return t.setVisible(e)})},n.prototype.updateFeaturesVisibility=function(){return this.forEach(function(e){return e.seMap(e.getMap())})},n.prototype.handleMapEvents=function(){var e=this;return komoo.event.addListener(this.map,"zoom_changed",function(){})},n}(r),n=function(e){function n(e){e==null&&(e={}),n.__super__.constructor.call(this,e),this.featuresByType={}}return __extends(n,e),n.prototype.push=function(e){var r,i,s,o,u,a,f,l=this;return n.__super__.push.call(this,e),r=e.getType(),(i=this.featuresByType)[r]==null&&(i[r]={}),(s=this.featuresByType[r])["categories"]==null&&(s.categories={}),(o=this.featuresByType[r]["categories"])["all"]==null&&(o.all=new t({map:this.map})),(u=this.featuresByType[r]["categories"])["uncategorized"]==null&&(u.uncategorized=new t({map:this.map})),(f=e.getCategories())!=null&&f.forEach(function(n){var i,s;return(i=l.featuresByType[r]["categories"])[s=n.name]==null&&(i[s]=new t({map:l.map})),l.featuresByType[r].categories[n.name].push(e)}),(e.getCategories()==null||e.getCategories().length===0)&&this.featuresByType[r].categories.uncategorized.push(e),this.featuresByType[r].categories.all.push(e),(a=this.featuresByType[r])["ids"]==null&&(a.ids={}),this.featuresByType[r].ids[e.getProperty("id")]=e},n.prototype.pop=function(){return n.__super__.pop.call(this)},n.prototype.clear=function(){return this.featuresByType={},n.__super__.clear.call(this)},n.prototype.getByType=function(e,n,r){var i,s=this;return r==null&&(r=!1),this.featuresByType[e]?n?n.length===0?this.featuresByType[e].categories.uncategorized:(i=new t({map:this.map}),n.forEach(function(t){if(s.featuresByType[e].categories[t])return s.featuresByType[e].categories[t].forEach(function(e){if(!r||!e.getCategories()||e.getCategories().length===1)return i.push(e)})}),i):this.featuresByType[e].categories.all:!1},n.prototype.getById=function(e,t){var n;return(n=this.featuresByType[e])!=null?n.ids[t]:void 0},n.prototype.highlightFeature=function(e,t){var n,r;n=typeof e=="string"?this.getById(e,t):e;if(n.isHighlighted())return;return(r=this.highlighted)!=null&&r.setHighlight(!1),n.highlight(),this.highlighted=n},n}(t),i=function(e){function t(){t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t}(t),window.komoo.collections={GenericCollection:r,FeatureCollection:t,FeatureCollectionPlus:n,makeFeatureCollection:function(e){return e==null&&(e={}),new t(e)},makeFeatureCollectionPlus:function(e){return e==null&&(e={}),new n(e)}},window.komoo.collections})